import{l as Ye,j as e,d as se,o as ye,u as Bs,r as o,B as h,k as ke,n as be,a0 as _e,A as ts,a1 as Rs,E as ls,t as Je,C as U,e as X,f as fe,h as Ne,g as Y,$ as J,c as Oe,U as fs,R as rs,X as ys,a2 as zs,b as gs,a3 as qs,a4 as $s,F as We,S as Ns,K as bs,a5 as Us,a6 as Gs,a7 as Ys,W as Be,a as T,i as Ks,a8 as Qs}from"./index-BvW6vA_w.js";import{T as cs,a as ds,b as ae,c as te}from"./tabs-CNqDDOx9.js";import{T as Xs,a as Zs,b as Xe,c as ge,d as ea,e as je}from"./table-RcngSmQx.js";import{S as pe}from"./skeleton-Bdw8EXgx.js";import{I as S}from"./input-B90b-HjG.js";import{P as sa}from"./progress-BsSVyHMm.js";import{S as oe,a as ce,b as de,c as me,d as B}from"./select-CgTQIsYR.js";import{D as le,a as re,b as ie,c as ne,f as vs,d as he}from"./dialog-Dz39hnJR.js";import{L as aa,a as ta,b as la,c as ra}from"./ListView-zFogRcv4.js";import{E as is}from"./EmployeeDropdown-DgM-kTJZ.js";import{C as Ee}from"./date-picker-BYk77_ec.js";import{R as xs}from"./ReportViewer-_4XuxDPc.js";import{o as Ds,n as ns,s as L,l as Re,d as Ae,u as ws,t as ks,a as ia}from"./types-BaGLVKrj.js";import{a as Se}from"./api-YnBVhvg1.js";import{L as E}from"./label-SlGcAB4q.js";import{P as ze,b as qe,c as $e,C as Ss}from"./popover-C9ru1Mgl.js";import{L as os}from"./loader-circle-BhqU31H3.js";import{p as Ue}from"./parse-CAu1uuSQ.js";import{A as Ze,a as ps,b as es}from"./alert-Bp7wk0IP.js";import{StructurePage as na}from"./StructurePage-DhhmWMij.js";import{U as us}from"./user-check-DhdqCyZS.js";import{L as oa}from"./layout-grid-gyTo-FUk.js";import{P as Le}from"./plus-c3UHNGiE.js";import{E as ca}from"./eye-cfsxeHQv.js";import{S as Ge}from"./square-pen-BGu5ARYy.js";import{M as ss,P as js}from"./phone-Dt7mdaOg.js";import{T as He}from"./trash-2-Cibh5KAu.js";import{F as da}from"./filter-NMmCgUEe.js";import{S as ma}from"./star-DYvdy6Zj.js";import{C as ha}from"./circle-check-big-Dz5mM00v.js";import"./index-LHsGcG95.js";import"./checkbox-BqyLDdHE.js";import"./use-mobile-Bu2nE1ik.js";import"./pagination-BYSNEtl3.js";import"./chevron-left-Cr-a-3Sv.js";import"./ellipsis-CKLx061c.js";import"./download-DqWMZ82E.js";import"./getDaysInMonth-2as7pjyD.js";import"./useMutation-EM1F2Qwl.js";import"./ScrollableTabs-EDBJq-7p.js";import"./textarea-NB_NAYSZ.js";import"./form-Bv2ke4Ok.js";import"./switch-FBPFO6q4.js";import"./list-HpFRL3en.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Ye("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=Ye("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=Ye("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=Ye("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),ja=()=>{const s={type:"report_employee_directory",title:"Employee Directory",description:"Complete list of active employees with their job titles and departments.",columns:[{key:"EmployeeID",label:"ID"},{key:"EmployeeName",label:"Name"},{key:"Email",label:"Email"},{key:"JobName",label:"Job Title"},{key:"Department",label:"Department"},{key:"Branch",label:"Branch",format:u=>u||"-"},{key:"HireDate",label:"Hire Date",format:u=>u?new Date(u).toLocaleDateString():"-"},{key:"EmploymentStatus",label:"Status",format:u=>e.jsx(se,{variant:u==="Active"?"default":"secondary",children:u})}]},a={type:"report_employee_hiring",title:"Hiring Report",description:"Employees hired within a specific date range.",columns:[{key:"EmployeeID",label:"ID"},{key:"EmployeeName",label:"Name"},{key:"JobName",label:"Job Title"},{key:"Department",label:"Department"},{key:"HireDate",label:"Hire Date",format:u=>u?new Date(u).toLocaleDateString():"-"},{key:"EmploymentStatus",label:"Status"}],filters:[{key:"start_date",label:"Start Date",type:"date",defaultValue:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]},{key:"end_date",label:"End Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]}]};return e.jsx("div",{className:"h-[calc(100vh-220px)] flex flex-col gap-2 overflow-hidden pt-2",children:e.jsxs(cs,{defaultValue:"directory",className:"flex flex-col flex-1 min-h-0",children:[e.jsxs(ds,{className:"flex-shrink-0",children:[e.jsx(ae,{value:"directory",children:"Employee Directory"}),e.jsx(ae,{value:"hiring",children:"Hiring History"})]}),e.jsx(te,{value:"directory",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(xs,{reportType:s.type,title:s.title,description:s.description,columns:s.columns,disableAutoFetch:!1})}),e.jsx(te,{value:"hiring",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(xs,{reportType:a.type,title:a.title,description:a.description,columns:a.columns,filterFields:a.filters,disableAutoFetch:!0})})]})})},fa=Ds({EmployeeID:ns().int().positive("Employee ID must be a positive integer"),FirstName:L().min(1,"First Name is required"),LastName:L().min(1,"Last Name is required"),Email:L().email("Invalid email").nullish().or(Re("")),Phone:L().min(10,"Phone must be 10+ digits").nullish().or(Re("")),DateOfBirth:Ae({required_error:"Date of Birth is required"}),Gender:L().min(1,"Gender is required"),NationalID:L().nullish(),Address:L().nullish(),City:L().nullish(),Country:L().nullish(),PostalCode:L().nullish(),HireDate:Ae({required_error:"Hire Date is required"}),EmploymentStatus:L().nullish(),HrDepartmentID:L().min(1,"Department is required"),JobID:L().min(1,"Job Title is required")});function ya({form:s}){const{t:a}=ye(),u=(r,g)=>{if(g.length===10){const x=Ue(g,"dd/MM/yyyy",new Date);_e(x)&&s.setValue(r,x,{shouldValidate:!0})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:a("employees.form.sections.personal.title")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Employee ID"}),e.jsx(S,{type:"number",...s.register("EmployeeID",{valueAsNumber:!0}),placeholder:"Enter Employee ID"}),s.formState.errors.EmployeeID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.EmployeeID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.firstName")}),e.jsx(S,{...s.register("FirstName")}),s.formState.errors.FirstName&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.FirstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.lastName")}),e.jsx(S,{...s.register("LastName")}),s.formState.errors.LastName&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.LastName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.email")}),e.jsx(S,{type:"email",...s.register("Email")}),s.formState.errors.Email&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.Email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.phone")}),e.jsx(S,{...s.register("Phone")}),s.formState.errors.Phone&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.Phone.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.dob")}),e.jsxs(ze,{children:[e.jsx(qe,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(ke,{className:"me-2 h-4 w-4"}),s.watch("DateOfBirth")?be(s.watch("DateOfBirth"),"PPP"):a("employees.form.pickDate")]})}),e.jsxs($e,{className:"w-auto p-0",children:[e.jsx(Ss,{mode:"single",selected:s.watch("DateOfBirth"),onSelect:r=>r&&s.setValue("DateOfBirth",r)}),e.jsx("div",{className:"p-3 border-t",children:e.jsx(S,{value:s.watch("DateOfBirth")?be(s.watch("DateOfBirth"),"dd/MM/yyyy"):"",onChange:r=>u("DateOfBirth",r.target.value),placeholder:"DD/MM/YYYY"})})]})]}),s.formState.errors.DateOfBirth&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.DateOfBirth.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.gender.label")}),e.jsxs(oe,{onValueChange:r=>s.setValue("Gender",r),value:s.watch("Gender"),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:a("employees.form.gender.placeholder")})}),e.jsxs(me,{children:[e.jsx(B,{value:"M",children:a("employees.form.gender.male")}),e.jsx(B,{value:"F",children:a("employees.form.gender.female")})]})]}),s.formState.errors.Gender&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.Gender.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.nationalId")}),e.jsx(S,{...s.register("NationalID")}),s.formState.errors.NationalID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.NationalID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.address")}),e.jsx(S,{...s.register("Address")})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.city")}),e.jsx(S,{...s.register("City")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.country")}),e.jsx(S,{...s.register("Country")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.form.postalCode")}),e.jsx(S,{...s.register("PostalCode")})]})]})]})}function ga({form:s}){const{t:a}=ye(),[u,r]=o.useState({departments:[],jobs:[],employmentStatuses:[{id:"Active",name:a("common.active")},{id:"Inactive",name:a("common.inactive")},{id:"On Leave",name:a("employees.statusTypes.On Leave")},{id:"Terminated",name:a("employees.statusTypes.Terminated")}]}),[g,x]=o.useState(!0);o.useEffect(()=>{(async()=>{try{x(!0);const[y,p]=await Promise.all([Se.departments.list({page:0,pageSize:100}),Se.job.list({page:0,pageSize:100})]);r(A=>({...A,departments:y.data||[],jobs:p.data||[]}))}catch(y){console.error("Error fetching job data:",y)}finally{x(!1)}})()},[]);const j=u.jobs.filter(m=>!s.watch("HrDepartmentID")||String(m.HrDepartmentID)===String(s.watch("HrDepartmentID")));o.useEffect(()=>{const m=s.getValues("JobID");m&&j.length>0&&(j.some(p=>String(p.JobID)===String(m))||s.setValue("JobID",""))},[s.watch("HrDepartmentID"),u.jobs]);const f=m=>{if(m.length===10){const y=Ue(m,"dd/MM/yyyy",new Date);_e(y)&&s.setValue("HireDate",y,{shouldValidate:!0})}};return g?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:a("employees.form.sections.job.title")}),e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(os,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:a("employees.dashboard.directory.loadingJobData")})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:a("employees.form.sections.job.title")}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.department")}),e.jsxs(oe,{value:s.watch("HrDepartmentID"),onValueChange:m=>s.setValue("HrDepartmentID",m),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:a("employees.form.departmentPlaceholder")})}),e.jsx(me,{children:u.departments.map(m=>e.jsx(B,{value:String(m.HrDepartmentID),children:m.HrDepartmentName},m.HrDepartmentID))})]}),s.formState.errors.HrDepartmentID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.HrDepartmentID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.jobTitle")}),e.jsxs(oe,{value:s.watch("JobID"),onValueChange:m=>s.setValue("JobID",m),disabled:!s.watch("HrDepartmentID"),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:s.watch("HrDepartmentID")?a("employees.form.jobPlaceholder"):a("employees.dashboard.directory.selectDepartmentFirst")})}),e.jsx(me,{children:j.map(m=>e.jsx(B,{value:String(m.JobID),children:m.JobName},m.JobID))})]}),s.formState.errors.JobID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.JobID.message})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.status")}),e.jsxs(oe,{value:s.watch("EmploymentStatus"),onValueChange:m=>s.setValue("EmploymentStatus",m),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:a("employees.form.statusPlaceholder")})}),e.jsx(me,{children:u.employmentStatuses.map(m=>e.jsx(B,{value:m.id,children:m.name},m.id))})]}),s.formState.errors.EmploymentStatus&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.EmploymentStatus.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:a("employees.hireDate")}),e.jsxs(ze,{children:[e.jsx(qe,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(ke,{className:"me-2 h-4 w-4"}),s.watch("HireDate")?be(s.watch("HireDate"),"PPP"):a("employees.form.pickDate")]})}),e.jsxs($e,{className:"w-auto p-0",children:[e.jsx(Ss,{mode:"single",selected:s.watch("HireDate"),onSelect:m=>m&&s.setValue("HireDate",m)}),e.jsx("div",{className:"p-3 border-t",children:e.jsx(S,{value:s.watch("HireDate")?be(s.watch("HireDate"),"dd/MM/yyyy"):"",onChange:m=>f(m.target.value),placeholder:"DD/MM/YYYY"})})]})]}),s.formState.errors.HireDate&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.HireDate.message})]})]})]})}function Na({employee:s,open:a,onOpenChange:u,onSuccess:r}){const{t:g}=ye(),{toast:x}=Bs(),[j,f]=o.useState(null),[m,y]=o.useState(!1),p=ws({resolver:ks(fa),defaultValues:{EmployeeID:(s==null?void 0:s.EmployeeID)||void 0,FirstName:(s==null?void 0:s.FirstName)||"",LastName:(s==null?void 0:s.LastName)||"",Email:(s==null?void 0:s.Email)||"",Phone:(s==null?void 0:s.Phone)||(s==null?void 0:s.PhoneNumber)||"",DateOfBirth:s!=null&&s.DateOfBirth?new Date(s.DateOfBirth):void 0,Gender:(s==null?void 0:s.Gender)==="M"||(s==null?void 0:s.Gender)==="F"?s.Gender:"",NationalID:(s==null?void 0:s.NationalID)||"",HrDepartmentID:"",JobID:"",HireDate:new Date,EmploymentStatus:"",Address:"",City:"",Country:"",PostalCode:""}});o.useEffect(()=>{a&&(s!=null&&s.EmployeeID)&&A(s.EmployeeID)},[a,s==null?void 0:s.EmployeeID]);const A=async n=>{try{y(!0);const v=await Se.list("employees",{select_fields:["EmployeeID","FirstName","LastName","Email","Phone","PhoneNumber","DateOfBirth","Gender","NationalID","Address","City","Country","PostalCode","HireDate","EmploymentStatus","TerminationDate","CreatedDate","UpdatedDate","departments_HrDepartmentName","job_JobName","HrDepartmentID","JobID"].join(","),sort:"ASC",pageSize:140,exact_filters:JSON.stringify({EmployeeID:n})});v.data&&v.data.length>0&&f(v.data[0])}catch(v){console.error("Error fetching employee data:",v),x({title:g("common.error"),description:g("employees.form.errors.loadEmployeeFailed"),variant:"destructive"})}finally{y(!1)}};o.useEffect(()=>{var n,v;if(j){const C={...j,EmployeeID:j.EmployeeID||void 0,HrDepartmentID:((n=j.HrDepartmentID)==null?void 0:n.toString())||"",JobID:((v=j.JobID)==null?void 0:v.toString())||"",DateOfBirth:j.DateOfBirth?new Date(j.DateOfBirth):null,HireDate:j.HireDate?new Date(j.HireDate):null,Email:j.Email||"",Phone:j.Phone||j.PhoneNumber||"",Address:j.Address||"",City:j.City||"",Country:j.Country||"",PostalCode:j.PostalCode||"",EmploymentStatus:j.EmploymentStatus||""};p.reset(C)}},[j,p]);const M=async n=>{if(s!=null&&s.EmployeeID)try{const v=V=>V?be(V,"yyyy-MM-dd"):null,C={...n,HrDepartmentID:n.HrDepartmentID?Number(n.HrDepartmentID):null,JobID:n.JobID?Number(n.JobID):null,DateOfBirth:v(n.DateOfBirth),HireDate:v(n.HireDate),Email:n.Email||null,Phone:n.Phone||null,Address:n.Address||null,City:n.City||null,Country:n.Country||null,PostalCode:n.PostalCode||null,EmploymentStatus:n.EmploymentStatus||null};await Se.employees.update(s.EmployeeID,C),x({title:g("common.success"),description:g("employees.form.errors.updated")}),r(),u(!1)}catch(v){console.error("Error updating employee:",v),x({title:g("common.error"),description:g("employees.form.errors.updateEmployeeFailed"),variant:"destructive"})}};return e.jsx(le,{open:a,onOpenChange:u,children:e.jsxs(re,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(ie,{children:e.jsx(ne,{children:g("employees.edit")})}),m?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(os,{className:"h-6 w-6 animate-spin text-muted-foreground mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:g("employees.dashboard.directory.loadingEmployeeData")})]}):e.jsxs("form",{onSubmit:p.handleSubmit(M),className:"space-y-6",children:[Object.keys(p.formState.errors).length>0&&e.jsxs("div",{className:"p-4 mb-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-red-800 mb-1",children:g("employees.form.validationErrors")}),e.jsx("ul",{className:"list-disc list-inside text-xs text-red-700",children:Object.entries(p.formState.errors).map(([n,v])=>e.jsxs("li",{children:[n,": ",v.message]},n))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ya,{form:p}),e.jsx("div",{className:"border-t border-gray-200 my-6"}),e.jsx(ga,{form:p})]}),e.jsxs(vs,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>u(!1),children:g("common.cancel")}),e.jsx(h,{type:"submit",disabled:p.formState.isSubmitting,children:p.formState.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"me-2 h-4 w-4 animate-spin"}),g("common.saving")]}):g("common.save")})]})]})]})})}const ba=Ds({EmployeeID:ns().int().positive("Employee ID must be a positive integer"),FirstName:L().min(1,"First Name is required"),LastName:L().min(1,"Last Name is required"),Email:L().email("Invalid email address").min(1,"Email is required"),Phone:L().min(10,"Phone number must be at least 10 digits").nullish().or(Re("")),DateOfBirth:Ae({required_error:"Date of Birth is required"}),Gender:L().min(1,"Gender is required"),NationalID:L().nullish(),Address:L().nullish(),City:L().nullish(),Country:L().nullish(),PostalCode:L().nullish(),HireDate:Ae({required_error:"Hire Date is required"}),ReportsTo:ia([ns().int().positive().nullish(),Re("")]).transform(s=>s===""?void 0:s),EmploymentStatus:L().nullish(),TerminationDate:Ae().nullish(),HrDepartmentID:L().min(1,"Department is required"),JobID:L().min(1,"Job Title is required")}),Ve=({title:s,description:a,children:u})=>e.jsxs(U,{className:"border border-border/60 shadow-sm rounded-2xl",children:[e.jsxs(X,{className:"space-y-1 pb-6",children:[e.jsx(fe,{className:"text-lg font-semibold",children:s}),a&&e.jsx(Ne,{className:"text-sm text-muted-foreground",children:a})]}),e.jsx(Y,{className:"space-y-6 pt-0",children:u})]}),va=({open:s,onOpenChange:a,onSuccess:u})=>{const{t:r}=ye(),[g,x]=o.useState(""),[j,f]=o.useState(""),[m,y]=o.useState(!1),[p,A]=o.useState(!1),[M,n]=o.useState(null),[v,C]=o.useState(!1),[V,z]=o.useState(null),[N,F]=o.useState({departments:[],jobs:[],employmentStatuses:[{id:"Active",name:r("common.active")},{id:"On Leave",name:r("employees.statusTypes.On Leave")},{id:"Terminated",name:r("employees.statusTypes.Terminated")},{id:"Retired",name:r("employees.statusTypes.Retired")}]}),[Z,q]=o.useState(!0);o.useEffect(()=>{s&&(async()=>{try{q(!0);const[b,R]=await Promise.all([Se.departments.list({page:0,pageSize:100,sort:"asc"}),Se.job.list({page:0,pageSize:100,sort:"asc"})]);F(xe=>({...xe,departments:b.data||[],jobs:R.data||[]}))}catch(b){console.error("Error fetching job data:",b),z(r("employees.form.errors.loadJobDataFailed"))}finally{q(!1)}})()},[s]);const i=ws({resolver:ks(ba),defaultValues:{EmployeeID:void 0,FirstName:"",LastName:"",Email:"",Phone:"",Gender:"",NationalID:"",DateOfBirth:void 0,HireDate:new Date,ReportsTo:"",Address:"",City:"",Country:"",PostalCode:"",HrDepartmentID:"",JobID:"",EmploymentStatus:"Active"}});o.useEffect(()=>{s&&(i.reset(),x(""),f(""),n(null),z(null))},[s,i]),o.useEffect(()=>{const d=i.getValues("JobID");if(d){const b=i.watch("HrDepartmentID"),R=N.jobs.find(xe=>String(xe.JobID)===d);R&&b&&String(R.HrDepartmentID)!==b&&i.setValue("JobID","")}},[i.watch("HrDepartmentID"),N.jobs]),o.useEffect(()=>{n(null)},[i.watch()]),o.useEffect(()=>{const d=i.watch("DateOfBirth"),b=i.watch("HireDate");d&&x(be(d,"dd/MM/yyyy")),b&&f(be(b,"dd/MM/yyyy"))},[i.watch("DateOfBirth"),i.watch("HireDate")]);const ee=d=>{const b=d.target.value;if(x(b),b.length===10){const R=Ue(b,"dd/MM/yyyy",new Date);_e(R)&&i.setValue("DateOfBirth",R,{shouldValidate:!0})}},ve=d=>{const b=d.target.value;if(f(b),b.length===10){const R=Ue(b,"dd/MM/yyyy",new Date);_e(R)&&i.setValue("HireDate",R,{shouldValidate:!0})}},K=d=>d?`ID${d.replace(/^ID/i,"").trim()}`:"",l=d=>d.includes("Email")?r("employees.form.duplicateError.email"):d.includes("NationalID")?r("employees.form.duplicateError.nationalId"):d.includes("Phone")?r("employees.form.duplicateError.phone"):r("employees.form.duplicateError.generic"),k=async d=>{try{C(!0),n(null),z(null);const b=Ce=>Ce?be(Ce,"yyyy-MM-dd"):null,R={FirstName:d.FirstName,LastName:d.LastName,Email:d.Email||null,Phone:d.Phone||null,DateOfBirth:b(d.DateOfBirth),Gender:d.Gender,NationalID:K(d.NationalID),Address:d.Address||null,City:d.City||null,Country:d.Country||null,PostalCode:d.PostalCode||null,HireDate:b(d.HireDate),ReportsTo:d.ReportsTo||null,EmploymentStatus:d.EmploymentStatus||"Active",TerminationDate:d.TerminationDate?b(d.TerminationDate):null,HrDepartmentID:d.HrDepartmentID,JobID:d.JobID,Status:"Active",CreatedBy:1,CreatedAt:new Date().toISOString()};console.log("Creating employee with data:",R);const xe=await Se.create("employees",R);console.log("Employee created successfully:",xe),J.success(r("employees.form.errors.success")),a(!1),u==null||u(),i.reset()}catch(b){console.error("Error creating employee:",b),z(b.message||r("employees.form.errors.createEmployeeFailed")),b.message&&b.message.includes("Value has to be unique")?n(l(b.message)):J.error(r("employees.form.errors.genericError"))}finally{C(!1)}},H=i.watch("FirstName"),W=i.watch("LastName");i.watch("EmploymentStatus");const Q=[H,W].filter(Boolean).join(" ")||"New Employee",De=`${(H==null?void 0:H[0])??""}${(W==null?void 0:W[0])??""}`.trim()||"NE";return e.jsx(le,{open:s,onOpenChange:a,children:e.jsxs(re,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsxs(ne,{className:"flex items-center gap-3",children:[e.jsxs(ts,{className:"h-12 w-12 border-2 border-white/60 shadow-lg",children:[e.jsx(Rs,{src:"",alt:Q}),e.jsx(ls,{className:"bg-primary/10 text-lg font-semibold text-primary",children:De})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-semibold",children:Q}),e.jsx("div",{className:"text-sm text-muted-foreground",children:r("employees.form.description")})]})]}),e.jsx(he,{children:r("employees.form.dialogDescription")})]}),Z?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading form data..."})]})}):V?e.jsxs(Ze,{variant:"destructive",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx(ps,{children:r("common.error")}),e.jsx(es,{children:V})]}):e.jsxs("form",{onSubmit:i.handleSubmit(k),className:"space-y-6",children:[Object.keys(i.formState.errors).length>0&&e.jsxs(Ze,{variant:"destructive",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx(ps,{children:r("employees.form.validationErrors")}),e.jsx(es,{children:e.jsx("ul",{className:"list-disc list-inside text-sm",children:Object.entries(i.formState.errors).map(([d,b])=>e.jsxs("li",{children:[d,": ",b.message]},d))})})]}),M&&e.jsxs(Ze,{variant:"destructive",children:[e.jsx(Je,{className:"h-4 w-4"}),e.jsx(es,{children:M})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ve,{title:r("employees.form.sections.personal.title"),description:r("employees.form.sections.personal.description"),children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"EmployeeID",children:"Employee ID"}),e.jsx(S,{id:"EmployeeID",type:"number",...i.register("EmployeeID",{valueAsNumber:!0}),placeholder:"Enter Employee ID"}),i.formState.errors.EmployeeID&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.EmployeeID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"NationalID",children:r("employees.form.nationalId")}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 start-0 flex items-center ps-3 text-xs font-semibold uppercase text-muted-foreground",children:"ID"}),e.jsx(S,{id:"NationalID",...i.register("NationalID"),placeholder:"123456789",className:"ps-10"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Saved as ",i.watch("NationalID")?K(i.watch("NationalID")):"ID0000"]}),i.formState.errors.NationalID&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.NationalID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"FirstName",children:r("employees.firstName")}),e.jsx(S,{id:"FirstName",...i.register("FirstName")}),i.formState.errors.FirstName&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.FirstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"LastName",children:r("employees.lastName")}),e.jsx(S,{id:"LastName",...i.register("LastName")}),i.formState.errors.LastName&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.LastName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:r("employees.form.gender.label")}),e.jsxs(oe,{onValueChange:d=>{i.setValue("Gender",d,{shouldValidate:!0})},value:i.watch("Gender"),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:r("employees.form.gender.placeholder")})}),e.jsxs(me,{children:[e.jsx(B,{value:"M",children:r("employees.form.gender.male")}),e.jsx(B,{value:"F",children:r("employees.form.gender.female")})]})]}),i.formState.errors.Gender&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.Gender.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:r("employees.form.dob")}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-[minmax(0,1fr)_auto]",children:[e.jsx(S,{type:"text",placeholder:"DD/MM/YYYY",value:g,onChange:ee}),e.jsxs(ze,{open:m,onOpenChange:y,children:[e.jsx(qe,{asChild:!0,children:e.jsx(h,{variant:"outline",type:"button",className:"h-10 w-full sm:w-11",children:e.jsx(ke,{className:"h-4 w-4"})})}),e.jsx($e,{className:"w-auto p-0",align:"end",children:e.jsx(ke,{mode:"single",selected:i.watch("DateOfBirth"),onSelect:d=>{d&&(i.setValue("DateOfBirth",d),y(!1))},initialFocus:!0,className:"rounded-md border p-2"})})]})]}),i.formState.errors.DateOfBirth&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.DateOfBirth.message})]})]})}),e.jsx(Ve,{title:r("employees.form.sections.contact.title"),description:r("employees.form.sections.contact.description"),children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"Email",children:r("employees.email")}),e.jsx(S,{id:"Email",type:"email",...i.register("Email")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r("employees.form.uniqueEmail")}),i.formState.errors.Email&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.Email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"Phone",children:[r("employees.phone")," (",r("common.optional"),")"]}),e.jsx(S,{id:"Phone",...i.register("Phone")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:r("employees.form.uniquePhone")}),i.formState.errors.Phone&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.Phone.message})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"Address",children:[r("employees.form.address")," (",r("common.optional"),")"]}),e.jsx(S,{id:"Address",...i.register("Address")}),i.formState.errors.Address&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.Address.message})]}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"City",children:[r("employees.form.city")," (",r("common.optional"),")"]}),e.jsx(S,{id:"City",...i.register("City")}),i.formState.errors.City&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.City.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"Country",children:[r("employees.form.country")," (",r("common.optional"),")"]}),e.jsx(S,{id:"Country",...i.register("Country")}),i.formState.errors.Country&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.Country.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"PostalCode",children:[r("employees.form.postalCode")," (",r("common.optional"),")"]}),e.jsx(S,{id:"PostalCode",...i.register("PostalCode")}),i.formState.errors.PostalCode&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.PostalCode.message})]})]})]})]})}),e.jsx(Ve,{title:r("employees.form.sections.employment.title"),description:r("employees.form.sections.employment.description"),children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:r("employees.hireDate")}),e.jsxs("div",{className:"grid gap-2 sm:grid-cols-[minmax(0,1fr)_auto]",children:[e.jsx(S,{type:"text",placeholder:"DD/MM/YYYY",value:j,onChange:ve}),e.jsxs(ze,{open:p,onOpenChange:A,children:[e.jsx(qe,{asChild:!0,children:e.jsx(h,{variant:"outline",type:"button",className:"h-10 w-full sm:w-11",children:e.jsx(ke,{className:"h-4 w-4"})})}),e.jsx($e,{className:"w-auto p-0",align:"end",children:e.jsx(ke,{mode:"single",selected:i.watch("HireDate"),onSelect:d=>{d&&(i.setValue("HireDate",d),A(!1))},initialFocus:!0,className:"rounded-md border p-2"})})]})]}),i.formState.errors.HireDate&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.HireDate.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:r("employees.status")}),e.jsxs(oe,{value:i.watch("EmploymentStatus"),onValueChange:d=>i.setValue("EmploymentStatus",d),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:r("employees.form.statusPlaceholder")})}),e.jsx(me,{children:N.employmentStatuses.map(d=>e.jsx(B,{value:d.id,children:d.name},d.id))})]}),i.formState.errors.EmploymentStatus&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.EmploymentStatus.message})]})]})}),e.jsx(Ve,{title:r("employees.form.sections.job.title"),description:r("employees.form.sections.job.description"),children:e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"HrDepartmentID",children:r("employees.department")}),e.jsxs(oe,{onValueChange:d=>i.setValue("HrDepartmentID",d),value:i.watch("HrDepartmentID"),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:r("employees.form.departmentPlaceholder")})}),e.jsx(me,{children:N.departments.map(d=>e.jsx(B,{value:String(d.HrDepartmentID),children:d.HrDepartmentName},d.HrDepartmentID))})]}),i.formState.errors.HrDepartmentID&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.HrDepartmentID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"JobID",children:r("employees.jobTitle")}),e.jsxs(oe,{onValueChange:d=>i.setValue("JobID",d),value:i.watch("JobID"),disabled:!i.watch("HrDepartmentID"),children:[e.jsx(ce,{children:e.jsx(de,{placeholder:i.watch("HrDepartmentID")?r("employees.form.jobPlaceholder"):r("employees.dashboard.directory.selectDepartmentFirst")})}),e.jsx(me,{children:N.jobs.filter(d=>!i.watch("HrDepartmentID")||String(d.HrDepartmentID)===i.watch("HrDepartmentID")).map(d=>e.jsx(B,{value:String(d.JobID),children:d.JobName},d.JobID))})]}),i.formState.errors.JobID&&e.jsx("p",{className:"text-sm text-destructive",children:i.formState.errors.JobID.message})]})]})})]}),e.jsxs(vs,{children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>a(!1),disabled:v,children:r("common.cancel")}),e.jsx(h,{type:"submit",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"-ms-1 me-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r("common.saving")]}):r("employees.form.create")})]})]})]})})};function Da(){const{t:s}=ye(),[a,u]=o.useState({totalEmployees:0,activeEmployees:0,onLeave:0,departments:0,newHiresThisMonth:0,terminatedThisMonth:0}),{data:r,isLoading:g}=Oe({queryKey:["employees"],queryFn:async()=>{try{const f=await T.employees.list({select_fields:"EmployeeID,FirstName,LastName,Email,EmploymentStatus,HireDate,TerminationDate,HrDepartmentID",sort:"asc",pageSize:1e3});return(f==null?void 0:f.data)||[]}catch(f){return console.error("Error fetching employees:",f),[]}},retry:1,staleTime:5*60*1e3}),{data:x}=Oe({queryKey:["departments"],queryFn:async()=>{try{const f=await T.departments.list({});return(f==null?void 0:f.data)||[]}catch(f){return console.error("Error fetching departments:",f),[]}},retry:1,staleTime:5*60*1e3});if(o.useEffect(()=>{if(r&&x){const f=new Date,m=f.getMonth(),y=f.getFullYear(),p=r.filter(M=>{if(!M.HireDate)return!1;const n=new Date(M.HireDate);return n.getMonth()===m&&n.getFullYear()===y}).length,A=r.filter(M=>{if(!M.TerminationDate)return!1;const n=new Date(M.TerminationDate);return n.getMonth()===m&&n.getFullYear()===y}).length;u({totalEmployees:r.length,activeEmployees:r.filter(M=>M.EmploymentStatus==="Active").length,onLeave:r.filter(M=>M.EmploymentStatus==="On Leave").length,departments:x.length,newHiresThisMonth:p,terminatedThisMonth:A})}},[r,x]),g)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((f,m)=>e.jsxs(U,{className:"bg-muted/10",children:[e.jsxs(X,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(pe,{className:"h-4 w-24"}),e.jsx(pe,{className:"h-6 w-6 rounded-full"})]}),e.jsxs(Y,{children:[e.jsx(pe,{className:"h-8 w-16 mb-2"}),e.jsx(pe,{className:"h-4 w-32"})]})]},m))})});const j=[{title:s("employees.dashboard.totalEmployees"),value:a.totalEmployees,icon:e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"}),description:s("employees.dashboard.allDepartments")},{title:s("employees.dashboard.activeEmployees"),value:a.activeEmployees,icon:e.jsx(us,{className:"h-4 w-4 text-green-500"}),description:s("employees.dashboard.currentlyWorking")},{title:s("employees.dashboard.onLeave"),value:a.onLeave,icon:e.jsx(rs,{className:"h-4 w-4 text-amber-500"}),description:s("employees.dashboard.currentlyOnLeave")},{title:s("employees.dashboard.departments"),value:a.departments,icon:e.jsx(ys,{className:"h-4 w-4 text-blue-500"}),description:s("employees.dashboard.activeDepartments")},{title:s("employees.dashboard.newHires"),value:a.newHiresThisMonth,icon:e.jsx(us,{className:"h-4 w-4 text-emerald-500"}),description:s("employees.dashboard.thisMonth")},{title:s("employees.dashboard.terminations"),value:a.terminatedThisMonth,icon:e.jsx(zs,{className:"h-4 w-4 text-red-500"}),description:s("employees.dashboard.thisMonth")}];return e.jsx("div",{className:"h-full overflow-y-auto p-4",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:j.map((f,m)=>e.jsxs(U,{children:[e.jsxs(X,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(fe,{className:"text-sm font-medium",children:f.title}),e.jsx("div",{className:"h-4 w-4",children:f.icon})]}),e.jsxs(Y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.description})]})]},m))})})}function wa(){const{t:s}=ye(),[a,u]=o.useState(null),[r,g]=o.useState(!1),[x,j]=o.useState(!1),[f,m]=o.useState(!1),[y,p]=o.useState(!1),[A,M]=o.useState([]),[n,v]=o.useState(0),[C,V]=o.useState(!0),[z,N]=o.useState(!1),[F,Z]=o.useState(null),[q,i]=o.useState(""),[ee,ve]=o.useState("all"),[K,l]=o.useState("all"),[k,H]=o.useState(1),W=10,Q=gs(),De=Math.ceil(n/W);console.log("Pagination Debug:",{currentPage:k,totalPages:De,totalCount:n,pageSize:W});const d=c=>{u(c),g(!0)},b=c=>{u(c),j(!0)},R=c=>{u(c),m(!0)},xe=async()=>{if(a)try{await T.employees.delete(a.EmployeeID),await ue(),m(!1),u(null)}catch(c){console.error("Error deleting employee:",c),Z("Failed to delete employee. Please try again.")}},Ce=async()=>{await ue(k)},Ke=async()=>{await ue(1),H(1)},ue=async(c=1)=>{try{console.log("Fetching employees for page:",c,"pageSize:",W),c===1?V(!0):N(!0);const D=["EmployeeID","FirstName","LastName","Email","Phone","DateOfBirth","Gender","NationalID","Address","City","Country","PostalCode","HireDate","EmploymentStatus","TerminationDate","CreatedDate","UpdatedDate","departments_HrDepartmentName","job_JobName","full_name","employee_display","status_display","gender_display","age","years_of_service","dob_formatted","hire_date_formatted","phone_display","email_display","job_JobNameEn","departments_HrDepartmentNameEn"],_={};ee!=="all"&&(_.departments_HrDepartmentName=ee),K!=="all"&&(_.EmploymentStatus=K),q&&(_.search=q);const we={select_fields:D,page:c-1,pageSize:W,sort:"desc",field:"FirstName",..._};console.log("API call params:",we);const $=await T.employees.list(we),Te=($==null?void 0:$.data)||[],Me=($==null?void 0:$.total)??($==null?void 0:$.totalRows)??($==null?void 0:$.totalCount)??0;console.log("API response:",{employeesCount:Te.length,total:Me,page:c}),Array.isArray(Te)?(console.log("Setting employees:",Te.length,"employees"),M(Te),v(Me)):(console.log("Unexpected response format:",$),Z("Unexpected response format from server"))}catch(D){const _=D instanceof Error?D.message:"Failed to fetch employees";Z(_)}finally{V(!1),N(!1)}};o.useEffect(()=>{ue(1)},[]),o.useEffect(()=>{H(1),ue(1)},[q,ee,K]),o.useEffect(()=>{ue(k)},[k]);const Qe=["all","IT","HR","Finance","Operations","Sales","Marketing"],Fe=["all","Active","On Leave","Terminated"],Ie=c=>c?new Date(c).toLocaleDateString(s("common.locale",{defaultValue:"en-US"}),{year:"numeric",month:"short",day:"numeric"}):"N/A",I=c=>c.split(" ").map(D=>D[0]).join("").toUpperCase();return C?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:s("employees.dashboard.directory.loadingTitle")}),e.jsx("p",{className:"text-muted-foreground",children:s("employees.dashboard.directory.loadingSubtitle")})]})}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((c,D)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(pe,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(pe,{className:"h-4 w-[250px]"}),e.jsx(pe,{className:"h-4 w-[200px]"})]})]},D))})]}):F?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:F}),e.jsx(h,{onClick:()=>ue(1),children:s("common.retry")})]})}):e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 flex-shrink-0 p-4 pb-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:s("employees.dashboard.directory.title")}),e.jsxs("p",{className:"text-muted-foreground",children:[n," ",s("common.total")]})]}),e.jsxs(h,{onClick:()=>p(!0),children:[e.jsx(Le,{className:"me-2 h-4 w-4"}),s("employees.add")]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-shrink-0 px-4 pb-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ns,{className:"absolute start-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(S,{placeholder:s("employees.dashboard.directory.searchPlaceholder"),className:"ps-10",value:q,onChange:c=>i(c.target.value)})]}),e.jsxs(oe,{value:ee,onValueChange:ve,children:[e.jsx(ce,{className:"w-full md:w-[200px]",children:e.jsx(de,{placeholder:s("employees.department")})}),e.jsx(me,{children:Qe.map(c=>e.jsx(B,{value:c,children:c==="all"?s("employees.dashboard.directory.allDepartments"):s(`employees.dashboard.directory.departmentsList.${c}`,c)},c))})]}),e.jsxs(oe,{value:K,onValueChange:l,children:[e.jsx(ce,{className:"w-full md:w-[150px]",children:e.jsx(de,{placeholder:s("employees.status")})}),e.jsx(me,{children:Fe.map(c=>e.jsx(B,{value:c,children:c==="all"?s("employees.dashboard.directory.allStatus"):s(`employees.dashboard.statusTypes.${c}`,c)},c))})]})]}),e.jsx("div",{className:"flex-1 px-4 pb-2 overflow-hidden min-h-0",children:e.jsx(aa,{data:A,keyExtractor:c=>c.EmployeeID,className:"h-full",currentPage:k,totalPages:De,totalCount:n,pageSize:W,onPageChange:c=>{console.log("ListView onPageChange called with page:",c),H(c)},isLoading:z,columns:[{key:"employee",header:s("employees.dashboard.directory.table.employee"),render:c=>e.jsx(ta,{title:`${c.FirstName} ${c.LastName}`,subtitle:c.Email,icon:e.jsx(ts,{className:"h-8 w-8 me-2",children:e.jsx(ls,{className:"text-xs",children:I(`${c.FirstName} ${c.LastName}`)})})})},{key:"department",header:s("employees.dashboard.directory.table.department"),render:c=>c.departments_HrDepartmentName||"N/A"},{key:"jobTitle",header:s("employees.dashboard.directory.table.jobTitle"),render:c=>c.job_JobName||"N/A"},{key:"status",header:s("employees.dashboard.directory.table.status"),render:c=>e.jsx(la,{variant:c.EmploymentStatus==="Active"?"default":c.EmploymentStatus==="On Leave"?"outline":c.EmploymentStatus==="Terminated"?"destructive":"outline",children:s(`employees.dashboard.statusTypes.${c.EmploymentStatus}`,c.EmploymentStatus)})},{key:"hireDate",header:s("employees.dashboard.directory.table.hireDate"),render:c=>e.jsx(ra,{date:c.HireDate})}],actions:[{label:s("employees.dashboard.directory.viewDetails"),icon:e.jsx(ca,{className:"h-4 w-4"}),onClick:d,ariaLabel:s("employees.dashboard.directory.viewDetails")},{label:s("employees.edit"),icon:e.jsx(Ge,{className:"h-4 w-4"}),onClick:b,ariaLabel:s("employees.edit")},{label:s("employees.dashboard.directory.sendEmail"),icon:e.jsx(ss,{className:"h-4 w-4"}),onClick:c=>{window.open(`mailto:${c.Email}`,"_blank")},ariaLabel:s("employees.dashboard.directory.sendEmail")},{label:s("employees.dashboard.directory.callEmployee"),icon:e.jsx(js,{className:"h-4 w-4"}),onClick:c=>{window.open(`tel:${c.Phone}`,"_blank")},ariaLabel:s("employees.dashboard.directory.callEmployee")},{label:s("employees.dashboard.directory.deleteEmployee"),icon:e.jsx(He,{className:"h-4 w-4"}),onClick:R,variant:"destructive",ariaLabel:s("employees.dashboard.directory.deleteEmployee")}],emptyState:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(bs,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:s("employees.dashboard.directory.noEmployees")}),e.jsx("p",{className:"text-muted-foreground",children:s("employees.dashboard.directory.noEmployeesDesc")})]}),enableBulkSelect:!0,bulkActions:[{label:s("employees.dashboard.directory.sendEmail"),icon:e.jsx(ss,{className:"h-4 w-4"}),onClick:c=>{const D=c.map(_=>_.Email).filter(Boolean).join(",");D&&window.open(`mailto:${D}`,"_blank")}},{label:s("employees.dashboard.directory.exportSelected"),icon:e.jsx(We,{className:"h-4 w-4"}),onClick:c=>{console.log("Export selected employees:",c)}}]})}),a&&e.jsx(Na,{employee:a,open:x,onOpenChange:j,onSuccess:Ce}),e.jsx(le,{open:r,onOpenChange:g,children:e.jsxs(re,{className:"max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsx(ie,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(ne,{className:"text-2xl",children:s("employees.dashboard.directory.profile")}),e.jsxs(he,{children:[s("employees.dashboard.directory.profileDesc")," ",a==null?void 0:a.FirstName," ",a==null?void 0:a.LastName]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Q(`/employee_documents/${a==null?void 0:a.EmployeeID}`),children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),s("employees.dashboard.directory.viewDocuments")]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>Q(`/contracts/${a!=null&&a.EmployeeID?a.EmployeeID+1e3:""}`),children:[e.jsx(We,{className:"me-2 h-4 w-4"}),s("employees.dashboard.directory.viewContract")]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>{g(!1),a&&b(a)},children:[e.jsx(Ge,{className:"me-2 h-4 w-4"}),s("employees.dashboard.directory.editProfile")]})]})]})}),a&&e.jsxs("div",{className:"flex-1 overflow-y-auto pr-2",children:[e.jsxs(U,{children:[e.jsx(X,{className:"bg-gray-50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:s("employees.dashboard.directory.personalInfo")})}),e.jsx(Y,{className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.fullName")}),e.jsxs("p",{className:"text-base",children:[a.FirstName," ",a.LastName]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.employeeId")}),e.jsx("p",{className:"text-base",children:a.EmployeeCode})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.nationalId")}),e.jsx("p",{className:"text-base",children:a.NationalID||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.email")}),e.jsx("p",{className:"text-base",children:a.Email||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.phone")}),e.jsx("p",{className:"text-base",children:a.Phone||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.dateOfBirth")}),e.jsx("p",{className:"text-base",children:a.dob_formatted||(a.DateOfBirth?new Date(a.DateOfBirth).toLocaleDateString():"N/A")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.gender")}),e.jsx("p",{className:"text-base",children:a.gender_display||a.Gender||"N/A"})]})]})})]}),e.jsxs(U,{children:[e.jsx(X,{className:"bg-gray-50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:s("employees.dashboard.directory.employmentDetails")})}),e.jsxs(Y,{className:"px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.department")}),e.jsx("p",{className:"text-base",children:a.departments_HrDepartmentName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.jobTitle")}),e.jsx("p",{className:"text-base",children:a.job_JobName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.jobLevel")}),e.jsx("p",{className:"text-base",children:a.joblevel_JobLevelName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.employmentType")}),e.jsx("p",{className:"text-base",children:a.jobtype_JobTypeName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.hireDate")}),e.jsx("p",{className:"text-base",children:a.hire_date_formatted||(a.HireDate?new Date(a.HireDate).toLocaleDateString():"N/A")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.status")}),e.jsx(se,{variant:a.EmploymentStatus==="Active"?"default":a.EmploymentStatus==="On Leave"?"secondary":a.EmploymentStatus==="Terminated"?"destructive":"outline",children:a.status_display||a.EmploymentStatus})]})]}),a.TerminationDate&&e.jsx("div",{className:"mt-4 bg-red-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(ke,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("employees.terminationDate")}),e.jsx("p",{children:Ie(a.TerminationDate)})]})]})})]})]}),e.jsxs(U,{children:[e.jsx(X,{className:"bg-gray-50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:s("employees.dashboard.directory.contactInfo")})}),e.jsx(Y,{className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.address")}),e.jsxs("div",{children:[e.jsx("p",{children:a.Address||"No address provided"}),a.City&&a.Country&&e.jsxs("p",{children:[a.City,", ",a.Country," ",a.PostalCode]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s("employees.dashboard.directory.labels.contact")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{children:a.Email||s("common.unknown")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(js,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{children:a.Phone||s("common.unknown")})]})]})]})]})})]})]})]})}),e.jsx(le,{open:f,onOpenChange:m,children:e.jsxs(re,{children:[e.jsxs(ie,{children:[e.jsxs(ne,{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-5 w-5 text-destructive"}),s("employees.dashboard.directory.deleteConfirmTitle")]}),e.jsx(he,{children:s("employees.dashboard.directory.deleteConfirmDesc")})]}),a&&e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ts,{className:"h-10 w-10",children:e.jsx(ls,{children:I(`${a.FirstName} ${a.LastName}`)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:`${a.FirstName} ${a.LastName}`}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",a.EmployeeID]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Department:"})," ",a.departments_HrDepartmentName||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Job Title:"})," ",a.job_JobName||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",a.status_display||a.EmploymentStatus]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Hire Date:"})," ",Ie(a.HireDate)]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-destructive font-medium",children:[" ",s("employees.dashboard.directory.deleteWarning")]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>m(!1),children:s("common.cancel")}),e.jsx(h,{variant:"destructive",onClick:xe,disabled:C,children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white me-2"}),s("employees.dashboard.directory.deleting")]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"me-2 h-4 w-4"}),s("employees.dashboard.directory.deleteEmployee")]})})]})]})}),e.jsx(va,{open:y,onOpenChange:p,onSuccess:Ke})]})}function ka(){const{t:s}=ye(),a=Us(),[u,r]=o.useState(""),[g,x]=o.useState("all"),[j,f]=o.useState(null),[m,y]=o.useState(!1),[p,A]=o.useState({skillName:"",skillType:"technical",level:"beginner",experience:0,employeeId:"",department:"",jobTitle:""}),{data:M=[],isLoading:n,error:v}=Oe({queryKey:["skills"],queryFn:async()=>{const l=await T.skills.list({pageSize:1e3});return(l==null?void 0:l.data)||[]}}),C=M.map(l=>{var k,H,W,Q;return{id:((k=l.SkillID)==null?void 0:k.toString())||"",skillName:l.SkillName||"",skillType:((H=l.SkillType)==null?void 0:H.toLowerCase())||"technical",level:((W=l.SkillLevel)==null?void 0:W.toLowerCase())||"beginner",experience:parseInt(l.SkillExperience)||0,lastUsed:l.lastUsed||"",verified:!!l.SVerified,verifiedBy:l.verifiedBy||"",verificationDate:l.verificationDate||"",employeeId:((Q=l.SEmployeeID)==null?void 0:Q.toString())||"",employeeName:l.employee_name||"",department:l.department||"",jobTitle:l.jobTitle||""}}),V=[{id:"frontend",name:"Frontend Development",description:"Web frontend technologies and frameworks",skills:C.filter(l=>["React","Vue","Angular","JavaScript","TypeScript","CSS","HTML"].includes(l.skillName))},{id:"backend",name:"Backend Development",description:"Server-side technologies and databases",skills:C.filter(l=>["Node.js","Python","Java","C#","SQL","MongoDB","PostgreSQL"].includes(l.skillName))},{id:"cloud",name:"Cloud & DevOps",description:"Cloud platforms and DevOps tools",skills:C.filter(l=>l.skillName.includes("AWS")||l.skillName.includes("Azure")||l.skillName.includes("GCP")||l.skillName.includes("Docker")||l.skillName.includes("Kubernetes"))},{id:"languages",name:"Languages",description:"Spoken and written languages",skills:C.filter(l=>l.skillType==="language")},{id:"certifications",name:"Certifications",description:"Professional certifications and qualifications",skills:C.filter(l=>l.skillType==="certification")}],N=[...C.filter(l=>{const k=l.skillName.toLowerCase().includes(u.toLowerCase())||l.employeeName.toLowerCase().includes(u.toLowerCase())||l.department.toLowerCase().includes(u.toLowerCase()),H=g==="all"||l.skillType===g;return k&&H})].sort((l,k)=>{if(!j)return 0;const H=l[j.key],W=k[j.key];return H<W?j.direction==="asc"?-1:1:H>W?j.direction==="asc"?1:-1:0}),F=l=>{let k="asc";j&&j.key===l&&j.direction==="asc"&&(k="desc"),f({key:l,direction:k})},Z=l=>{switch(l){case"beginner":return 25;case"intermediate":return 50;case"advanced":return 75;case"expert":return 100;default:return 0}},q=l=>{const H={technical:{color:"bg-blue-100 text-blue-800",label:"Technical"},soft:{color:"bg-green-100 text-green-800",label:"Soft Skill"},language:{color:"bg-purple-100 text-purple-800",label:"Language"},certification:{color:"bg-orange-100 text-orange-800",label:"Certification"}}[l]||{color:"bg-gray-100 text-gray-800",label:"Other"};return e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${H.color}`,children:H.label})},i=()=>{y(!0)},ee=async l=>{if(A({...p,employeeId:l}),l)try{const k=await T.employees.list({exact_filters:{EmployeeID:parseInt(l)},select_fields:"departments_HrDepartmentName,job_JobName"});if(k.data&&k.data.length>0){const H=k.data[0];A(W=>({...W,employeeId:l,department:H.departments_HrDepartmentName||"",jobTitle:H.job_JobName||""}))}}catch(k){console.error("Error fetching employee details:",k)}},ve=async()=>{try{await T.skills.create({SkillName:p.skillName,SkillType:p.skillType,SkillLevel:p.level,SkillExperience:p.experience.toString(),SEmployeeID:p.employeeId,department:p.department,jobTitle:p.jobTitle}),A({skillName:"",skillType:"technical",level:"beginner",experience:0,employeeId:"",department:"",jobTitle:""}),y(!1),J.success("Skill added successfully"),a.invalidateQueries({queryKey:["skills"]})}catch(l){console.error("Error adding skill:",l),J.error("Failed to add skill")}},K=()=>{A({skillName:"",skillType:"technical",level:"beginner",experience:0,employeeId:"",department:"",jobTitle:""}),y(!1)};return e.jsxs("div",{className:"h-full flex flex-col min-h-0 overflow-hidden p-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 flex-shrink-0 mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:s("employees.dashboard.skills.title")}),e.jsx("p",{className:"text-muted-foreground",children:s("employees.dashboard.skills.subtitle")})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:min-w-[300px]",children:[e.jsx(Ns,{className:"absolute start-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(S,{placeholder:s("employees.dashboard.skills.searchPlaceholder"),className:"ps-10 w-full",value:u,onChange:l=>r(l.target.value)})]}),e.jsxs(h,{variant:"outline",children:[e.jsx(da,{className:"h-4 w-4 me-2"}),s("employees.dashboard.skills.filter")]}),e.jsxs(h,{onClick:i,children:[e.jsx(Le,{className:"h-4 w-4 me-2"}),s("employees.dashboard.skills.addSkill")]})]})]}),e.jsxs(cs,{dir:s("common.dir",{defaultValue:"ltr"}),defaultValue:"matrix",className:"flex flex-col flex-1 min-h-0 overflow-hidden",children:[e.jsxs(ds,{className:"flex-shrink-0",children:[e.jsx(ae,{value:"matrix",children:s("employees.dashboard.skills.tabs.matrix")}),e.jsx(ae,{value:"employees",children:s("employees.dashboard.skills.tabs.employees")}),e.jsx(ae,{value:"categories",children:s("employees.dashboard.skills.tabs.categories")}),e.jsx(ae,{value:"gaps",children:s("employees.dashboard.skills.tabs.gaps")})]}),e.jsxs(te,{value:"matrix",className:"flex flex-col flex-1 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-4 overflow-x-auto pb-2 flex-shrink-0",children:[e.jsx(h,{variant:g==="all"?"default":"outline",onClick:()=>x("all"),children:s("employees.dashboard.skills.filters.all")}),e.jsx(h,{variant:g==="technical"?"default":"outline",onClick:()=>x("technical"),children:s("employees.dashboard.skills.filters.technical")}),e.jsx(h,{variant:g==="soft"?"default":"outline",onClick:()=>x("soft"),children:s("employees.dashboard.skills.filters.soft")}),e.jsx(h,{variant:g==="language"?"default":"outline",onClick:()=>x("language"),children:s("employees.dashboard.skills.filters.language")}),e.jsx(h,{variant:g==="certification"?"default":"outline",onClick:()=>x("certification"),children:s("employees.dashboard.skills.filters.certification")})]}),e.jsx(U,{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(Xs,{children:[e.jsx(Zs,{children:e.jsxs(Xe,{children:[e.jsx(ge,{className:"cursor-pointer",onClick:()=>F("skillName"),children:e.jsxs("div",{className:"flex items-center",children:[s("employees.dashboard.skills.table.skill"),e.jsx(as,{className:"ml-2 h-4 w-4"})]})}),e.jsx(ge,{children:s("employees.dashboard.skills.table.type")}),e.jsx(ge,{className:"cursor-pointer",onClick:()=>F("level"),children:e.jsxs("div",{className:"flex items-center",children:[s("employees.dashboard.skills.table.level"),e.jsx(as,{className:"ms-2 h-4 w-4"})]})}),e.jsx(ge,{children:s("employees.dashboard.skills.table.experience")}),e.jsx(ge,{className:"cursor-pointer",onClick:()=>F("employeeName"),children:e.jsxs("div",{className:"flex items-center",children:[s("employees.dashboard.skills.table.employee"),e.jsx(as,{className:"ms-2 h-4 w-4"})]})}),e.jsx(ge,{children:s("employees.dashboard.skills.table.department")}),e.jsx(ge,{children:s("employees.dashboard.skills.table.verification")}),e.jsx(ge,{className:"text-end",children:s("employees.dashboard.skills.table.actions")})]})}),e.jsx(ea,{children:N.length>0?N.map(l=>e.jsxs(Xe,{children:[e.jsx(je,{className:"font-medium",children:l.skillName}),e.jsx(je,{children:q(l.skillType)}),e.jsx(je,{children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"w-24 mr-2",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:l.level}),e.jsxs("span",{children:[Z(l.level),"%"]})]}),e.jsx(sa,{value:Z(l.level),className:"h-2"})]})})}),e.jsxs(je,{children:[l.experience," months"]}),e.jsx(je,{children:l.employeeName}),e.jsx(je,{children:l.department}),e.jsx(je,{children:l.verified?e.jsxs(se,{variant:"default",className:"gap-1 bg-green-100 text-green-800 hover:bg-green-100",children:[e.jsx(Gs,{className:"h-3 w-3"}),s("employees.dashboard.skills.status.verified")]}):e.jsxs(se,{variant:"outline",className:"gap-1",children:[e.jsx(Ys,{className:"h-3 w-3"}),s("employees.dashboard.skills.status.notVerified")]})}),e.jsx(je,{className:"text-end",children:e.jsxs(h,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:s("common.view")}),e.jsx(Be,{className:"h-4 w-4 rtl:rotate-180"})]})})]},l.id)):e.jsx(Xe,{children:e.jsx(je,{colSpan:8,className:"h-24 text-center",children:s("employees.dashboard.skills.table.noSkills")})})})]})})})]}),e.jsx(te,{value:"categories",className:"flex-1 min-h-0 overflow-auto",children:e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:V.map(l=>e.jsxs(U,{className:"h-full",children:[e.jsxs(X,{children:[e.jsx(fe,{className:"text-lg",children:l.name}),e.jsx(Ne,{children:l.description})]}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-4",children:l.skills.length>0?l.skills.map(k=>e.jsx("div",{className:"border rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:k.skillName}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`h-2 w-2 rounded-full mr-2 ${k.level==="beginner"?"bg-blue-500":k.level==="intermediate"?"bg-green-500":k.level==="advanced"?"bg-yellow-500":"bg-purple-500"}`}),e.jsxs("span",{className:"text-xs text-muted-foreground capitalize",children:[k.level,"  ",k.experience," months"]})]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:k.employeeName})]})},k.id)):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No skills in this category"})})})]},l.id))})}),e.jsx(te,{value:"employees",className:"flex-1 min-h-0 overflow-auto",children:e.jsxs(U,{className:"h-full",children:[e.jsxs(X,{children:[e.jsx(fe,{children:"Skills by Employee"}),e.jsx(Ne,{children:"View skills organized by employee"})]}),e.jsx(Y,{children:e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Employee skills view will be displayed here"})})]})}),e.jsx(te,{value:"gaps",className:"flex-1 min-h-0 overflow-auto",children:e.jsxs(U,{children:[e.jsx(X,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(fe,{children:s("employees.dashboard.skills.gaps.title")}),e.jsx(Ne,{children:s("employees.dashboard.skills.gaps.subtitle")})]}),e.jsxs(h,{variant:"outline",children:[e.jsx(ma,{className:"h-4 w-4 me-2"}),s("employees.dashboard.skills.gaps.viewCritical")]})]})}),e.jsx(Y,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(U,{children:[e.jsxs(X,{className:"pb-2",children:[e.jsx(fe,{className:"text-lg",children:s("employees.dashboard.skills.gaps.highDemand")}),e.jsx(Ne,{children:s("employees.dashboard.skills.gaps.highDemandDesc")})]}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-3",children:["Machine Learning","Cloud Architecture","Cybersecurity","Data Science","DevOps"].map(l=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{children:l}),e.jsx(se,{variant:"destructive",children:"12 open roles"})]},l))})})]}),e.jsxs(U,{children:[e.jsxs(X,{className:"pb-2",children:[e.jsx(fe,{className:"text-lg",children:s("employees.dashboard.skills.gaps.skillGaps")}),e.jsx(Ne,{children:s("employees.dashboard.skills.gaps.skillGapsDesc")})]}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-3",children:["AI/ML Engineering","Blockchain","Quantum Computing","Edge Computing","IoT Security"].map(l=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{children:l}),e.jsx(se,{variant:"outline",className:"text-amber-600 border-amber-200 bg-amber-50",children:"Emerging need"})]},l))})})]}),e.jsxs(U,{children:[e.jsxs(X,{className:"pb-2",children:[e.jsx(fe,{className:"text-lg",children:s("employees.dashboard.skills.gaps.training")}),e.jsx(Ne,{children:s("employees.dashboard.skills.gaps.trainingDesc")})]}),e.jsx(Y,{children:e.jsx("div",{className:"space-y-3",children:["Cloud Certifications","Agile Leadership","Data Visualization","UX/UI Design","Python for Data"].map(l=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{children:l}),e.jsx(h,{variant:"link",className:"h-8 p-0",children:"View courses"})]},l))})})]})]})})]})})]}),e.jsx(le,{open:m,onOpenChange:y,children:e.jsxs(re,{className:"max-w-md",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Add New Skill"}),e.jsx(he,{children:"Add a new skill to the employee database."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Skill Name"}),e.jsx(S,{placeholder:"Enter skill name",value:p.skillName,onChange:l=>A({...p,skillName:l.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Skill Type"}),e.jsxs(oe,{value:p.skillType,onValueChange:l=>A({...p,skillType:l}),children:[e.jsx(ce,{children:e.jsx(de,{})}),e.jsxs(me,{children:[e.jsx(B,{value:"technical",children:"Technical"}),e.jsx(B,{value:"soft",children:"Soft"}),e.jsx(B,{value:"language",children:"Language"}),e.jsx(B,{value:"certification",children:"Certification"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Skill Level"}),e.jsxs(oe,{value:p.level,onValueChange:l=>A({...p,level:l}),children:[e.jsx(ce,{children:e.jsx(de,{})}),e.jsxs(me,{children:[e.jsx(B,{value:"beginner",children:"Beginner"}),e.jsx(B,{value:"intermediate",children:"Intermediate"}),e.jsx(B,{value:"advanced",children:"Advanced"}),e.jsx(B,{value:"expert",children:"Expert"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Experience (years)"}),e.jsx(S,{type:"number",placeholder:"Years of experience",value:p.experience,onChange:l=>A({...p,experience:parseInt(l.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Employee"}),e.jsx(is,{value:p.employeeId,onValueChange:ee,placeholder:"Select an employee",employmentStatus:"Active",showSearch:!0,pageSize:10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Department"}),e.jsx(S,{placeholder:"Department (auto-filled)",value:p.department,readOnly:!0,className:"bg-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Job Title"}),e.jsx(S,{placeholder:"Job title (auto-filled)",value:p.jobTitle,readOnly:!0,className:"bg-muted"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(h,{variant:"outline",onClick:K,children:"Cancel"}),e.jsx(h,{onClick:ve,disabled:!p.skillName,children:"Add Skill"})]})]})})]})}function Sa(){const[s,a]=o.useState([]),[u,r]=o.useState([]),[g,x]=o.useState([]),[j,f]=o.useState(!0),[m,y]=o.useState(null),[p,A]=o.useState(!1),[M,n]=o.useState(!1),[v,C]=o.useState(!1),[V,z]=o.useState(null),[N,F]=o.useState(null),[Z,q]=o.useState(!1),[i,ee]=o.useState(!1),[ve,K]=o.useState(!1),[l,k]=o.useState(null),[H,W]=o.useState(null),[Q,De]=o.useState(null),[d,b]=o.useState(!1),[R,xe]=o.useState(null),[Ce,Ke]=o.useState(new Set),[ue,Qe]=o.useState(new Set),[Fe,Ie]=o.useState(new Set),[I,c]=o.useState({WorkflowName:"",Description:"",WorkflowStatus:"NotStarted",Progress:0,StartDate:"",TargetDate:""}),[D,_]=o.useState({Title:"",Description:"",DueDate:"",AssignedTo:"",TaskStatus:"Pending"}),[we,$]=o.useState({Label:""});o.useEffect(()=>{(async()=>{try{f(!0);const[w,P,O]=await Promise.all([T.onboarding.listWorkflows({sort:"ASC",pageSize:140}),T.onboarding.listTasks({sort:"ASC",pageSize:140}),T.onboarding.listTaskChecklistItems({sort:"ASC",pageSize:140})]);a(w.data),r(P.data),x(O.data)}catch(w){y("Failed to fetch data"),console.error(w)}finally{f(!1)}})()},[]);const Te=t=>{Ke(w=>{const P=new Set(w);return P.has(t)?P.delete(t):P.add(t),P})},Me=t=>{Qe(w=>{const P=new Set(w);return P.has(t)?P.delete(t):P.add(t),P})},Cs=async()=>{try{const t={...I,Progress:0,WorkflowStatus:"NotStarted",CreatedDate:new Date().toISOString(),UpdatedDate:new Date().toISOString()},w=await T.onboarding.createWorkflow(t),P=await T.onboarding.listWorkflows({sort:"ASC",pageSize:140});a(P.data),A(!1),c({WorkflowName:"",Description:"",WorkflowStatus:"NotStarted",Progress:0,StartDate:"",TargetDate:""}),J.success("Workflow created successfully")}catch(t){console.error("Error creating workflow:",t),J.error("Failed to create workflow")}},Ts=t=>{z(t),c({WorkflowName:t.WorkflowName,Description:t.Description,WorkflowStatus:t.WorkflowStatus,Progress:t.Progress,StartDate:t.StartDate,TargetDate:t.TargetDate}),n(!0)},Es=async()=>{if(V)try{const t={...I,UpdatedDate:new Date().toISOString()};await T.onboarding.updateWorkflow(V.WorkflowID,t);const w=await T.onboarding.listWorkflows({sort:"ASC",pageSize:140});a(w.data),n(!1),z(null),c({WorkflowName:"",Description:"",WorkflowStatus:"NotStarted",Progress:0,StartDate:"",TargetDate:""}),J.success("Workflow updated successfully")}catch(t){console.error("Error updating workflow:",t),J.error("Failed to update workflow")}},Is=t=>{F(t),C(!0)},Ps=async()=>{if(N)try{await T.onboarding.deleteWorkflow(N.WorkflowID);const t=await T.onboarding.listWorkflows({sort:"ASC",pageSize:140});a(t.data),C(!1),F(null),J.success("Workflow deleted successfully")}catch(t){console.error("Error deleting workflow:",t),J.error("Failed to delete workflow")}},As=t=>{var w;W(t),_({Title:t.Title,Description:t.Description,DueDate:t.DueDate,AssignedTo:((w=t.AssignedTo)==null?void 0:w.toString())||"",TaskStatus:t.TaskStatus}),ee(!0)},Ls=async()=>{if(H)try{await T.onboarding.updateTask(H.TaskID,D);const t=await T.onboarding.listTasks({sort:"ASC",pageSize:140});r(t.data),ee(!1),W(null),_({Title:"",Description:"",DueDate:"",AssignedTo:"",TaskStatus:"Pending"}),J.success("Task updated successfully")}catch(t){console.error("Error updating task:",t),J.error("Failed to update task")}},Hs=t=>{De(t),K(!0)},Os=async()=>{if(Q)try{await T.onboarding.deleteTask(Q.TaskID);const[t,w]=await Promise.all([T.onboarding.listTasks({sort:"ASC",pageSize:140}),T.onboarding.listTaskChecklistItems({sort:"ASC",pageSize:140})]);r(t.data),x(w.data),K(!1),De(null),J.success("Task deleted successfully")}catch(t){console.error("Error deleting task:",t),J.error("Failed to delete task")}},Fs=t=>{switch(t){case"Completed":return e.jsxs(se,{variant:"default",className:"gap-1 bg-green-100 text-green-800 hover:bg-green-100",children:[e.jsx(ha,{className:"h-3 w-3"})," Completed"]});case"InProgress":return e.jsxs(se,{variant:"default",className:"gap-1",children:[e.jsx(Ks,{className:"h-3 w-3"})," In Progress"]});case"Overdue":return e.jsxs(se,{variant:"destructive",className:"gap-1",children:[e.jsx(Je,{className:"h-3 w-3"})," Overdue"]});default:return e.jsx(se,{variant:"outline",className:"gap-1",children:"Pending"})}},Ms=t=>{switch(t){case"Completed":return e.jsx(se,{variant:"default",className:"bg-green-100 text-green-800 hover:bg-green-100",children:"Completed"});case"InProgress":return e.jsx(se,{variant:"default",children:"In Progress"});default:return e.jsx(se,{variant:"outline",children:"Not Started"})}},Pe=t=>t?new Date(t).toLocaleDateString("en-US"):"N/A",Vs=async()=>{if(l)try{const t={...D,WorkflowID:l,CreatedDate:new Date().toISOString(),UpdatedDate:new Date().toISOString()};await T.onboarding.createTask(t);const[w,P]=await Promise.all([T.onboarding.listTasks({sort:"ASC",pageSize:140}),T.onboarding.listWorkflows({sort:"ASC",pageSize:140})]);r(w.data),a(P.data),q(!1),_({Title:"",Description:"",DueDate:"",AssignedTo:"",TaskStatus:"Pending"}),k(null),J.success("Task created successfully")}catch(t){console.error("Error creating task:",t),J.error("Failed to create task")}},Js=async()=>{if(R)try{const t={TaskID:R,Label:we.Label,Completed:!1,CreatedDate:new Date().toISOString(),UpdatedDate:new Date().toISOString()};await T.onboarding.createTaskChecklistItem(t);const w=await T.onboarding.listTaskChecklistItems({sort:"ASC",pageSize:140});x(w.data),b(!1),$({Label:""}),xe(null),J.success("Checklist item created successfully")}catch(t){console.error("Error creating checklist item:",t),J.error("Failed to create checklist item")}},Ws=async t=>{try{const w=t.TaskStatus==="Completed"?"Pending":"Completed";await T.onboarding.updateTask(t.TaskID,{...t,TaskStatus:w,UpdatedDate:new Date().toISOString()});const[P,O]=await Promise.all([T.onboarding.listTasks({sort:"ASC",pageSize:140}),T.onboarding.listWorkflows({sort:"ASC",pageSize:140})]);r(P.data),a(O.data),J.success(w==="Completed"?"Task marked as complete":"Task marked as pending")}catch(w){console.error("Error updating task status:",w),J.error("Failed to update task status")}},_s=async t=>{try{Ie(w=>new Set(w).add(t.TaskChecklistID)),await T.onboarding.updateTaskChecklistItem(t.TaskChecklistID,{...t,Completed:!0,UpdatedDate:new Date().toISOString()}),x(w=>w.map(P=>P.TaskChecklistID===t.TaskChecklistID?{...P,Completed:!0,UpdatedDate:new Date().toISOString()}:P)),J.success(`Completed: ${t.Label}`)}catch(w){console.error("Error updating checklist item:",w),J.error("Failed to update checklist item")}finally{Ie(w=>{const P=new Set(w);return P.delete(t.TaskChecklistID),P})}};return j?e.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):m?e.jsx("div",{className:"flex justify-center p-8 text-red-500",children:m}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Onboarding Workflows"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage employee onboarding workflows and tasks"})]}),e.jsxs(h,{onClick:()=>A(!0),children:[e.jsx(Le,{className:"me-2 h-4 w-4"})," Create Workflow"]})]}),e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsx(U,{children:e.jsx(Y,{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No workflows found. Create your first workflow to get started."})})}):s.map(t=>{const w=u.filter(O=>O.WorkflowID===t.WorkflowID),P=Ce.has(t.WorkflowID);return e.jsxs(U,{children:[e.jsx(X,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Te(t.WorkflowID),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:`h-5 w-5 transition-transform ${P?"rotate-90":""}`}),e.jsx(fe,{className:"text-lg",children:t.WorkflowName}),Ms(t.WorkflowStatus)]}),e.jsx(Ne,{className:"mt-2",children:t.Description}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(rs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Start:"}),e.jsx("span",{className:"font-medium",children:Pe(t.StartDate)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(rs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Target:"}),e.jsx("span",{className:"font-medium",children:Pe(t.TargetDate)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Progress"}),e.jsxs("div",{className:"text-lg font-bold",children:[t.Progress,"%"]})]}),e.jsxs("div",{className:"flex gap-1",onClick:O=>O.stopPropagation(),children:[e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>Ts(t),children:e.jsx(Ge,{className:"h-4 w-4"})}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>Is(t),children:e.jsx(He,{className:"h-4 w-4"})})]})]})]})}),P&&e.jsxs(Y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Start Date:"}),e.jsx("p",{className:"font-medium",children:Pe(t.StartDate)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Target Date:"}),e.jsx("p",{className:"font-medium",children:Pe(t.TargetDate)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tasks:"}),e.jsx("p",{className:"font-medium",children:w.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Completed Tasks:"}),e.jsx("p",{className:"font-medium",children:w.filter(O=>O.TaskStatus==="Completed").length})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{size:"sm",onClick:O=>{O.stopPropagation(),k(t.WorkflowID),q(!0)},children:[e.jsx(Le,{className:"h-4 w-4 mr-2"})," Add Task"]})}),w.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No tasks in this workflow"}):e.jsx("div",{className:"space-y-2",children:w.map(O=>{const ms=g.filter(G=>G.TaskID===O.TaskID),hs=ue.has(O.TaskID);return e.jsxs(U,{children:[e.jsx(X,{className:"cursor-pointer hover:bg-muted/50 py-3",onClick:()=>Me(O.TaskID),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Be,{className:`h-4 w-4 transition-transform ${hs?"rotate-90":""}`}),e.jsx("input",{type:"checkbox",checked:O.TaskStatus==="Completed",onChange:G=>{G.stopPropagation(),Ws(O)},className:"h-4 w-4 rounded"}),e.jsx("span",{className:"font-medium",children:O.Title}),Fs(O.TaskStatus)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:Pe(O.DueDate)}),e.jsxs("div",{className:"flex gap-1",onClick:G=>G.stopPropagation(),children:[e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>As(O),children:e.jsx(Ge,{className:"h-4 w-4"})}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>Hs(O),children:e.jsx(He,{className:"h-4 w-4"})})]})]})]})}),hs&&e.jsxs(Y,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:O.Description}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(h,{size:"sm",variant:"outline",onClick:G=>{G.stopPropagation(),xe(O.TaskID),b(!0)},children:[e.jsx(Le,{className:"h-4 w-4 mr-2"})," Add Checklist Item"]})}),ms.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No checklist items"}):e.jsx("div",{className:"space-y-2",children:ms.map(G=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:G.Completed,onChange:()=>_s(G),disabled:Fe.has(G.TaskChecklistID),className:"h-4 w-4 rounded"}),e.jsx("span",{className:G.Completed?"line-through text-muted-foreground":"",children:G.Label})]}),Fe.has(G.TaskChecklistID)&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]},G.TaskChecklistID))})]})]},O.TaskID)})})]})]},t.WorkflowID)})}),e.jsx(le,{open:Z,onOpenChange:q,children:e.jsxs(re,{className:"max-w-2xl",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Create New Task"}),e.jsx(he,{children:"Add a new task to the workflow"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Task Title"}),e.jsx(S,{value:D.Title,onChange:t=>_({...D,Title:t.target.value}),placeholder:"e.g., Complete HR paperwork"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:D.Description,onChange:t=>_({...D,Description:t.target.value}),placeholder:"Describe the task..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Due Date"}),e.jsx(Ee,{date:D.DueDate?new Date(D.DueDate):void 0,onChange:t=>_({...D,DueDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Assigned To"}),e.jsx(is,{value:D.AssignedTo,onValueChange:t=>_({...D,AssignedTo:t}),placeholder:"Select an employee"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsx(h,{onClick:Vs,disabled:!D.Title,children:"Create Task"})]})]})}),e.jsx(le,{open:d,onOpenChange:b,children:e.jsxs(re,{className:"max-w-2xl",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Create New Checklist Item"}),e.jsx(he,{children:"Add a new checklist item to the task"})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Checklist Item Label"}),e.jsx(S,{value:we.Label,onChange:t=>$({...we,Label:t.target.value}),placeholder:"e.g., Sign employment contract"})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(h,{onClick:Js,disabled:!we.Label,children:"Create Checklist Item"})]})]})}),e.jsx(le,{open:p,onOpenChange:A,children:e.jsxs(re,{className:"max-w-2xl",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Create New Workflow"}),e.jsx(he,{children:"Create a new onboarding workflow for employees"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Workflow Name"}),e.jsx(S,{value:I.WorkflowName,onChange:t=>c({...I,WorkflowName:t.target.value}),placeholder:"e.g., New Employee Onboarding"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:I.Description,onChange:t=>c({...I,Description:t.target.value}),placeholder:"Describe the workflow..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(Ee,{date:I.StartDate?new Date(I.StartDate):void 0,onChange:t=>c({...I,StartDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Target Date"}),e.jsx(Ee,{date:I.TargetDate?new Date(I.TargetDate):void 0,onChange:t=>c({...I,TargetDate:t?format(t,"yyyy-MM-dd"):""})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsx(h,{onClick:Cs,disabled:!I.WorkflowName,children:"Create Workflow"})]})]})}),e.jsx(le,{open:M,onOpenChange:n,children:e.jsxs(re,{className:"max-w-2xl",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Edit Workflow"}),e.jsx(he,{children:"Update the workflow details"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Workflow Name"}),e.jsx(S,{value:I.WorkflowName,onChange:t=>c({...I,WorkflowName:t.target.value}),placeholder:"e.g., New Employee Onboarding"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:I.Description,onChange:t=>c({...I,Description:t.target.value}),placeholder:"Describe the workflow..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(Ee,{date:I.StartDate?new Date(I.StartDate):void 0,onChange:t=>c({...I,StartDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Target Date"}),e.jsx(Ee,{date:I.TargetDate?new Date(I.TargetDate):void 0,onChange:t=>c({...I,TargetDate:t?format(t,"yyyy-MM-dd"):""})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(h,{onClick:Es,disabled:!I.WorkflowName,children:"Update Workflow"})]})]})}),e.jsx(le,{open:v,onOpenChange:C,children:e.jsxs(re,{className:"max-w-md",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Delete Workflow"}),e.jsxs(he,{children:['Are you sure you want to delete the workflow "',N==null?void 0:N.WorkflowName,'"? This action cannot be undone.']})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(h,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsx(h,{variant:"destructive",onClick:Ps,children:"Delete Workflow"})]})]})}),e.jsx(le,{open:i,onOpenChange:ee,children:e.jsxs(re,{className:"max-w-2xl",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Edit Task"}),e.jsx(he,{children:"Update the task details"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Task Title"}),e.jsx(S,{value:D.Title,onChange:t=>_({...D,Title:t.target.value}),placeholder:"Enter task title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:D.Description,onChange:t=>_({...D,Description:t.target.value}),placeholder:"Describe the task..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Due Date"}),e.jsx(Ee,{date:D.DueDate?new Date(D.DueDate):void 0,onChange:t=>_({...D,DueDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs("select",{value:D.TaskStatus,onChange:t=>_({...D,TaskStatus:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"InProgress",children:"In Progress"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Overdue",children:"Overdue"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Assigned To"}),e.jsx(is,{value:D.AssignedTo,onValueChange:t=>_({...D,AssignedTo:t}),placeholder:"Select an employee",employmentStatus:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{variant:"outline",onClick:()=>ee(!1),children:"Cancel"}),e.jsx(h,{onClick:Ls,disabled:!D.Title,children:"Update Task"})]})]})}),e.jsx(le,{open:ve,onOpenChange:K,children:e.jsxs(re,{className:"max-w-md",children:[e.jsxs(ie,{children:[e.jsx(ne,{children:"Delete Task"}),e.jsxs(he,{children:['Are you sure you want to delete the task "',Q==null?void 0:Q.Title,'"? This action cannot be undone and will also delete all associated checklist items.']})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(h,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),e.jsx(h,{variant:"destructive",onClick:Os,children:"Delete Task"})]})]})})]})}function Ca(){const{t:s}=ye(),[a,u]=o.useState(null),[r,g]=o.useState(!0),[x,j]=o.useState(null),{data:f,isLoading:m}=Oe({queryKey:["employees"],queryFn:async()=>{const n=await T.employees.list({select_fields:"EmployeeID,FirstName,LastName,JobID,ReportsTo,HrDepartmentID,job_JobName,departments_HrDepartmentName",sort:"asc",pageSize:1e3});return(n==null?void 0:n.data)||[]}}),{data:y}=Oe({queryKey:["departments"],queryFn:async()=>{const n=await T.departments.list({});return(n==null?void 0:n.data)||[]}});o.useEffect(()=>{if(!(m||!f||!y))try{const n=new Map,v=new Map;f.forEach(N=>{var F;n.set(N.EmployeeID,{...N,department:N.departments_HrDepartmentName||"No Department",title:N.job_JobName||"No Title",children:[],expanded:!0}),N.ReportsTo&&(v.has(N.ReportsTo)||v.set(N.ReportsTo,[]),(F=v.get(N.ReportsTo))==null||F.push(N.EmployeeID))});const C=N=>{var q;const F=n.get(N);if(!F)return null;const Z=((q=v.get(N))==null?void 0:q.map(C).filter(Boolean))||[];return{id:F.EmployeeID,name:`${F.FirstName} ${F.LastName}`,title:F.title,department:F.department,children:Z,expanded:!0,hasChildren:Z.length>0}},V=Array.from(n.values()).filter(N=>!N.ReportsTo||!n.has(N.ReportsTo)).map(N=>N.EmployeeID);let z;V.length===1?z=C(V[0]):z={id:0,name:s("employees.dashboard.orgChart.virtualRoot"),title:"",department:"",children:V.map(C).filter(Boolean),expanded:!0,hasChildren:V.length>0},u(z)}catch(n){console.error("Error building org chart:",n),j("Failed to load organization chart")}finally{g(!1)}},[f,y,m]);const p=(n,v)=>n.id===v?{...n,expanded:!n.expanded}:n.children?{...n,children:n.children.map(C=>p(C,v))}:n,A=n=>{a&&u(p(a,n))},M=(n,v=0)=>{var z,N;if(!n)return null;const C=n.children&&n.children.length>0,V=n.expanded!==!1;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"relative flex flex-col items-center",children:e.jsxs("div",{className:`flex items-center ${v>0?"mt-4":""}`,children:[C&&e.jsx(h,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>A(n.id),children:V?e.jsx(Qs,{className:"h-4 w-4"}):e.jsx(Be,{className:"h-4 w-4 rtl:rotate-180"})}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"flex flex-col items-center p-3 border rounded-lg bg-card text-card-foreground shadow-sm",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center mb-2",children:e.jsx(bs,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("div",{className:"text-sm font-medium text-center",children:n.name}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:n.title}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:n.department})]})})]})}),C&&V&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("div",{className:"border-l-2 border-muted h-4"})}),C&&V&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${((z=n.children)==null?void 0:z.length)||1}, 1fr)`},children:(N=n.children)==null?void 0:N.map(F=>e.jsx("div",{className:"flex flex-col items-center",children:M(F,v+1)},F.id))})})]},n.id)};return r?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((n,v)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(pe,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(pe,{className:"h-4 w-[200px]"}),e.jsx(pe,{className:"h-3 w-[150px]"})]})]},v))}):x?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:x}),e.jsx(h,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:s("common.retry")})]}):e.jsx("div",{className:"overflow-x-auto py-4",children:e.jsx("div",{className:"min-w-max",children:a?e.jsx("div",{className:"flex justify-center",children:M(a)}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s("employees.dashboard.orgChart.noData")})})})}function yt(){const{t:s}=ye(),a=gs(),{tab:u}=qs(),[r,g]=o.useState(u||"dashboard"),x=$s(),j=y=>{g(y),a(`/employees/${y}`)},f=Object.entries(x).filter(([y,p])=>p).map(([y])=>y),m=()=>{const y=f.length;return y===1?"grid-cols-1":y===2?"grid-cols-2":y===3?"grid-cols-3":y===4?"grid-cols-4":y===5?"grid-cols-5":y===6?"grid-cols-6":"grid-cols-7"};return e.jsx("div",{className:"flex flex-col h-full min-h-0",children:e.jsxs(cs,{dir:s("common.dir",{defaultValue:"ltr"}),value:r,onValueChange:j,className:"flex flex-col flex-1 min-h-0 h-full",children:[e.jsxs(ds,{className:`grid w-full flex-shrink-0 ${m()}`,children:[x.dashboard&&e.jsxs(ae,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(oa,{className:"h-4 w-4"}),s("employees.dashboard.tabs.dashboard")]}),x["org-chart"]&&e.jsxs(ae,{value:"org-chart",className:"flex items-center gap-2",children:[e.jsx(ua,{className:"h-4 w-4"}),s("employees.dashboard.tabs.orgChart")]}),x.structure&&e.jsxs(ae,{value:"structure",className:"flex items-center gap-2",children:[e.jsx(ys,{className:"h-4 w-4"}),s("employees.dashboard.tabs.structure")]}),x.onboarding&&e.jsxs(ae,{value:"onboarding",className:"flex items-center gap-2",children:[e.jsx(xa,{className:"h-4 w-4"}),s("employees.dashboard.tabs.onboarding")]}),x.skills&&e.jsxs(ae,{value:"skills",className:"flex items-center gap-2",children:[e.jsx(pa,{className:"h-4 w-4"}),s("employees.dashboard.tabs.skills")]}),x.directory&&e.jsxs(ae,{value:"directory",className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-4 w-4"}),s("employees.dashboard.tabs.directory")]}),x.reports&&e.jsxs(ae,{value:"reports",className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),s("employees.dashboard.tabs.reports")]})]}),x.dashboard&&e.jsx(te,{value:"dashboard",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(Da,{})}),x["org-chart"]&&e.jsx(te,{value:"org-chart",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(Ca,{})}),x.structure&&e.jsx(te,{value:"structure",className:"flex-1 min-h-0 m-0",children:e.jsx(na,{})}),x.onboarding&&e.jsx(te,{value:"onboarding",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(Sa,{})}),x.skills&&e.jsx(te,{value:"skills",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(ka,{})}),x.directory&&e.jsx(te,{value:"directory",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(wa,{})}),x.reports&&e.jsx(te,{value:"reports",className:"flex-1 min-h-0 m-0 overflow-hidden",children:e.jsx(ja,{})})]})})}export{Da as EmployeeDashboardTab,yt as EmployeeDashboardView};
