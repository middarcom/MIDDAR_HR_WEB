import{r as t,j as s,U as D,S as $}from"./index-BbrTghgW.js";import{S as P,a as A,b as B,c as R,d as U}from"./select-BPHtPkSE.js";import{I as V}from"./input-CQIgNovL.js";import{a as q}from"./api-DrQz22N6.js";import{L as _}from"./loader-circle--WJp7lNV.js";const Y=({value:d,onValueChange:C,placeholder:u="Select an employee",disabled:L=!1,className:H="",employmentStatus:p,showSearch:I=!0,pageSize:f=10})=>{const[a,g]=t.useState([]),[N,j]=t.useState(!1),[S,b]=t.useState(!1),[o,k]=t.useState(""),[J,h]=t.useState(0),[E,v]=t.useState(!0),[x,F]=t.useState(!1);t.useRef(null);const l=t.useCallback(async(e=0,r="",c=!1)=>{try{e===0||c?j(!0):b(!0);const n={page:e,pageSize:f,field:"FirstName",sort:"ASC"};r&&(n.search=r),p&&(n.exact_filters=JSON.stringify({EmploymentStatus:p}));const i=(await q.employees.list(n)).data||[];c||e===0?(g(i),h(0)):g(m=>[...m,...i]),v(i.length===f)}catch(n){console.error("Error fetching employees:",n)}finally{j(!1),b(!1)}},[p,f]);t.useEffect(()=>{x&&a.length===0&&l(0,o,!0)},[x,l,a.length,o]);const M=e=>{k(e),h(0),v(!0),l(0,e,!0)},O=e=>{const r=e.target,{scrollTop:c,scrollHeight:n,clientHeight:w}=r;if(n-c<=w+20&&E&&!S&&!N){const m=J+1;h(m),l(m,o,!1)}},T=e=>{const r=[`${e.FirstName} ${e.LastName}`];return e.job_JobName&&r.push(e.job_JobName),e.departments_HrDepartmentName&&r.push(e.departments_HrDepartmentName),r.join(" - ")},y=d?a.find(e=>e.EmployeeID.toString()===d):null;return s.jsxs(P,{value:d,onValueChange:C,disabled:L,open:x,onOpenChange:F,children:[s.jsx(A,{className:H,children:s.jsx(B,{placeholder:u,children:y?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(D,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"truncate",children:T(y)})]}):u})}),s.jsxs(R,{className:"p-0",children:[I&&s.jsx("div",{className:"p-2 border-b sticky top-0 bg-background z-10",children:s.jsxs("div",{className:"relative",children:[s.jsx($,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(V,{placeholder:"Search employees...",value:o,onChange:e=>M(e.target.value),className:"pl-8",onClick:e=>e.stopPropagation()})]})}),s.jsx("div",{className:"max-h-60 overflow-y-auto",onScroll:O,children:N&&a.length===0?s.jsxs("div",{className:"flex items-center justify-center p-4",children:[s.jsx(_,{className:"h-4 w-4 animate-spin mr-2"}),"Loading employees..."]}):a.length===0?s.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No employees found"}):s.jsxs(s.Fragment,{children:[a.map(e=>s.jsx(U,{value:e.EmployeeID.toString(),className:"cursor-pointer",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(D,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"truncate font-medium",children:[e.FirstName," ",e.LastName]}),s.jsxs("div",{className:"text-sm text-muted-foreground truncate",children:[e.EmployeeCode,e.job_JobName&&` • ${e.job_JobName}`,e.departments_HrDepartmentName&&` • ${e.departments_HrDepartmentName}`]})]})]})},e.EmployeeID)),S&&s.jsxs("div",{className:"flex items-center justify-center p-4 text-muted-foreground",children:[s.jsx(_,{className:"h-4 w-4 animate-spin mr-2"}),"Loading more..."]}),!E&&a.length>0&&s.jsxs("div",{className:"p-2 text-center text-muted-foreground text-xs border-t",children:["All employees loaded (",a.length,")"]})]})})]})]})};export{Y as E};
