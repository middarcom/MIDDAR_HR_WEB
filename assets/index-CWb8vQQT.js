import{l as me,aa as tt,ap as Tt,r as v,j as e,aq as St,Q as $e,a3 as ht,b as Re,c as be,t as qe,B as P,d as ee,K as at,C as $,e as Y,f as G,F as Ve,g as q,k as ie,i as Ft,h as pt,n as J,$ as U,o as ze,a5 as kt,D as Et,S as Ht,ar as st,y as rt,z as nt,G as ct,J as ue,as as Mt,a8 as ke,at as $t,W as _t,Y as Vt,au as Rt,a as ce,a7 as zt,av as Lt,aw as xe}from"./index-CCrEZW60.js";import{T as Ye,a as Je,b as de,c as ot}from"./tabs-DMeKmE-R.js";import{T as Be,a as Ue,b as X,c as Q,d as Oe,e as V}from"./table-D_39BKO4.js";import{a as F}from"./api-DwYzDi__.js";import{A as yt}from"./arrow-left-CTHEqula.js";import{P as De}from"./plus-j7cHYJ2u.js";import{o as Ke,n as oe,d as he,s as Z,u as jt,t as Ct,a as we,b as qt,c as Bt}from"./types-Bc27I7t-.js";import{I as H}from"./input-B52n123F.js";import{L as D}from"./label-Dchh_76G.js";import{T as We}from"./textarea-C6lkPzsm.js";import{P as pe,b as ye,c as je,C as Ce,i as Ut,f as Ot}from"./popover-Dp7kce_M.js";import{u as lt}from"./useMutation-B4tjqKUk.js";import{S as fe,a as Ne,b as ge,c as ve,d as L}from"./select-BUhFCEhu.js";import{S as re}from"./skeleton-BKuK8gZZ.js";import{C as le}from"./checkbox-D011lLSb.js";import{D as ft,a as Nt,b as gt,c as vt,d as Dt,f as Kt}from"./dialog-Dq0_R7ZG.js";import{T as Te}from"./trash-2-CcHpsgZh.js";import{C as Qt}from"./circle-check-CQx3ntJQ.js";import{F as Yt}from"./filter-Dgd9sj9G.js";import{D as it}from"./download-CqEaroSX.js";import{E as dt}from"./eye-BTt7VBVM.js";import{S as Jt}from"./square-pen-Caip_tGA.js";import{P as Pt}from"./pencil-BOGtWOqt.js";import{C as Wt}from"./chevron-left-Bqlkwn7Z.js";import{p as Qe}from"./parseISO-Ba0618wU.js";import{R as Gt}from"./ReportViewer-BZDo9w3_.js";import"./getDaysInMonth-CHx9-T72.js";import"./index-75OEbrM5.js";import"./alert-CZaCO7D-.js";import"./date-picker-qSZDHeXW.js";import"./loader-circle-CT-eCON9.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=me("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=me("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=me("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=me("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=me("FileType2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 13v-1h6v1",key:"1dh9dg"}],["path",{d:"M5 12v6",key:"150t9c"}],["path",{d:"M4 18h2",key:"1xrofg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=me("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);function ra(t,i){const r=tt(t),d=tt(i),I=ut(r,d),o=Math.abs(Tt(r,d));r.setDate(r.getDate()-I*o);const h=+(ut(r,d)===-I),j=I*(o-h);return j===0?0:j}function ut(t,i){const r=t.getFullYear()-i.getFullYear()||t.getMonth()-i.getMonth()||t.getDate()-i.getDate()||t.getHours()-i.getHours()||t.getMinutes()-i.getMinutes()||t.getSeconds()-i.getSeconds()||t.getMilliseconds()-i.getMilliseconds();return r<0?-1:r>0?1:r}const se={getContracts:async(t={})=>{const i=t.page!==void 0?Math.max(0,t.page-1):0,r={sort:(t.sortOrder||"desc").toLowerCase(),pageSize:t.pageSize||10,page:i};return t.search&&(r.search=t.search),t.status&&(r.status=t.status),t.type&&(r.type=t.type),t.sortBy&&(r.sortBy=t.sortBy),await F.contract.list(r)},getContractById:async t=>{const i=await F.contract.get(t,{columns:"ContractID,EmployeeID,employees_FirstName,employees_LastName,ContractAmount,ContractDate,ContractStartDate,ContractEndDate,ContractNote,ContractType,ContractTitle,ContractStatus,ContractDescription,Status,CreatedAt,UpdatedAt,CreatedBy,UpdatedBy"}),r=await se.getContractPayments(t),d=r.filter(b=>b.contractpaytype_IsAdd===1),I=r.filter(b=>b.contractpaytype_IsAdd===0),o=d.reduce((b,A)=>{const _=A.contractpaytype_IsHour===1?parseFloat(A.ContractPAmountHour)||0:parseFloat(A.ContractPAmount)||0;return b+_},0),h=I.reduce((b,A)=>{const _=A.contractpaytype_IsHour===1?parseFloat(A.ContractPAmountHour)||0:parseFloat(A.ContractPAmount)||0;return b+_},0),j=(parseFloat(i.ContractAmount)||0)+o-h;return{...i,payments:r,additions:d,deductions:I,totalAdditions:o,totalDeductions:h,netAmount:j}},createContract:async t=>F.contract.create(t),updateContract:async(t,i)=>F.contract.update(t,i),deleteContract:async t=>F.contract.delete(t),getContractPayments:async t=>(await F.list("contractp",{exact_filters:JSON.stringify({ContractID:t}),select_fields:"ContractPID,ContractID,ContractPayTypeID,ContractPAmount,ContractPAmountHour,ContractNote,contractpaytype_ContractPayTypeName,contractpaytype_IsAdd,contractpaytype_IsHour",sort:"ContractPID asc"})).data||[],addPayment:async t=>F.create("contractp",t),updatePayment:async(t,i)=>F.update("contractp",t,i),deletePayment:async t=>F.delete("contractp",t),getPaymentTypes:async()=>(await F.list("contractpaytype",{exact_filters:JSON.stringify({IsActive:!0}),sort:"ContractPayTypeName asc"})).data||[],getContractDocuments:async t=>(await F.list("contractdocument",{exact_filters:JSON.stringify({ContractID:t,IsActive:!0}),sort:"UploadedAt desc"})).data||[],uploadDocument:async t=>F.create("contractdocument",t),deleteDocument:async t=>F.update("contractdocument",t,{IsActive:!1}),getTemplates:async()=>(await F.list("contractstemplate",{exact_filters:JSON.stringify({IsActive:!0}),sort:"TemplateName asc"})).data||[],getTemplateById:async t=>F.get("contractstemplate",t),exportContracts:async(t="pdf",i)=>{var r,d;return(d=(r=F.contract).export)==null?void 0:d.call(r,t,i)},submitForApproval:async(t,i,r)=>F.contract.update(t,{Status:"pending_approval",SubmittedBy:i,Comments:r}),approveContract:async(t,i,r)=>F.contract.update(t,{Status:"active",ApprovedBy:i,ApprovalDate:new Date().toISOString(),Comments:r}),rejectContract:async(t,i,r)=>F.contract.update(t,{Status:"rejected",RejectedBy:i,RejectionDate:new Date().toISOString(),RejectionReason:r}),terminateContract:async(t,i,r,d)=>F.contract.update(t,{Status:"terminated",TerminatedBy:i,TerminationDate:r,TerminationReason:d})};var na="Separator",xt="horizontal",ca=["horizontal","vertical"],wt=v.forwardRef((t,i)=>{const{decorative:r,orientation:d=xt,...I}=t,o=oa(d)?d:xt,j=r?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(St.div,{"data-orientation":o,...j,...I,ref:i})});wt.displayName=na;function oa(t){return ca.includes(t)}var At=wt;const _e=v.forwardRef(({className:t,orientation:i="horizontal",decorative:r=!0,...d},I)=>e.jsx(At,{ref:I,decorative:r,orientation:i,className:$e("shrink-0 bg-border",i==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...d}));_e.displayName=At.displayName;const la=()=>{const{id:t}=ht(),i=Re();v.useState("overview");const{data:r,isLoading:d,error:I}=be({queryKey:["contract",t],queryFn:()=>se.getContractById(Number(t)),enabled:!!t}),o=p=>{if(!p)return"N/A";try{return J(new Date(p),"PPP")}catch{return p}},h=p=>{const g=typeof p=="string"?parseFloat(p):p;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g||0)};if(d)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})});if(I||!r)return e.jsxs("div",{className:"p-8 text-center bg-destructive/10 rounded-lg",children:[e.jsx(qe,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-destructive mb-2",children:"Error Loading Contract"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The contract details could not be retrieved."}),e.jsx(P,{onClick:()=>i("/contracts"),children:"Back to Contracts"})]});const j=r,b=j.ContractID||j.id,A=j.additions||[],_=j.deductions||[],y=j.totalAdditions||0,T=j.totalDeductions||0,B=j.netAmount||0;return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center space-x-4 mb-2",children:e.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>i("/contracts"),className:"p-0 hover:bg-transparent",children:[e.jsx(yt,{className:"h-5 w-5 mr-1"}),"Back to Contracts"]})}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Contract #",b]}),e.jsx(ee,{variant:j.ContractStatus==="Active"?"success":"outline",children:j.ContractStatus||"New"})]}),e.jsxs("p",{className:"text-muted-foreground flex items-center",children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),j.employees_FirstName," ",j.employees_LastName]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(P,{variant:"outline",onClick:()=>i(`/contracts/${b}/edit`),children:"Edit Contract"}),e.jsx(P,{children:"Download PDF"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs($,{children:[e.jsx(Y,{children:e.jsxs(G,{className:"flex items-center",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2 text-primary"}),"Contract Overview"]})}),e.jsxs(q,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Base Salary"}),e.jsx("p",{className:"text-2xl font-bold",children:h(j.ContractAmount)})]}),e.jsx(_e,{}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ie,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Dates"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[o(j.ContractStartDate)," - ",j.ContractEndDate?o(j.ContractEndDate):"Open Ended"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Contract Type"}),e.jsx("p",{className:"text-lg",children:j.ContractType||"Standard Employment"})]}),e.jsx(_e,{}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ft,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Status"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current Status: ",e.jsx("span",{className:"font-semibold text-foreground",children:j.ContractStatus||"New"})]})]})]})]})]}),j.ContractNote&&e.jsxs("div",{className:"mt-8 p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Administrative Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:j.ContractNote})]})]})]}),e.jsxs(Ye,{defaultValue:"payments",className:"w-full",children:[e.jsxs(Je,{className:"grid w-full grid-cols-2 max-w-[400px]",children:[e.jsx(de,{value:"payments",children:"Financial Details"}),e.jsx(de,{value:"documents",children:"Documents"})]}),e.jsx(ot,{value:"payments",className:"space-y-4 mt-6",children:e.jsxs($,{children:[e.jsxs(Y,{children:[e.jsx(G,{className:"text-lg",children:"Salary Components"}),e.jsx(pt,{children:"All additions and deductions related to this contract"})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"flex items-center text-sm font-semibold text-green-600 mb-3",children:[e.jsx(Xt,{className:"h-4 w-4 mr-1"}),"Additions & Allowances"]}),e.jsxs(Be,{children:[e.jsx(Ue,{children:e.jsxs(X,{children:[e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Amount"}),e.jsx(Q,{children:"Hourly"}),e.jsx(Q,{children:"Note"})]})}),e.jsx(Oe,{children:A.length>0?A.map(p=>e.jsxs(X,{children:[e.jsx(V,{className:"font-medium",children:p.contractpaytype_ContractPayTypeName}),e.jsxs(V,{className:"text-green-600",children:["+",h(p.ContractPAmount)]}),e.jsx(V,{children:p.ContractPAmountHour>0?h(p.ContractPAmountHour):"-"}),e.jsx(V,{className:"text-xs text-muted-foreground",children:p.ContractNote||"-"})]},p.ContractPID)):e.jsx(X,{children:e.jsx(V,{colSpan:4,className:"text-center py-4 text-muted-foreground",children:"No additional payments"})})})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"flex items-center text-sm font-semibold text-red-600 mb-3",children:[e.jsx(Zt,{className:"h-4 w-4 mr-1"}),"Deductions"]}),e.jsxs(Be,{children:[e.jsx(Ue,{children:e.jsxs(X,{children:[e.jsx(Q,{children:"Type"}),e.jsx(Q,{children:"Amount"}),e.jsx(Q,{children:"Hourly"}),e.jsx(Q,{children:"Note"})]})}),e.jsx(Oe,{children:_.length>0?_.map(p=>e.jsxs(X,{children:[e.jsx(V,{className:"font-medium",children:p.contractpaytype_ContractPayTypeName}),e.jsxs(V,{className:"text-red-600",children:["-",h(p.ContractPAmount)]}),e.jsx(V,{children:p.ContractPAmountHour>0?h(p.ContractPAmountHour):"-"}),e.jsx(V,{className:"text-xs text-muted-foreground",children:p.ContractNote||"-"})]},p.ContractPID)):e.jsx(X,{children:e.jsx(V,{colSpan:4,className:"text-center py-4 text-muted-foreground",children:"No deductions"})})})]})]})]})})]})}),e.jsx(ot,{value:"documents",className:"mt-6",children:e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{className:"text-lg",children:"Contract Documents"})}),e.jsxs(q,{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(Ve,{className:"h-12 w-12 opacity-20 mb-2"}),e.jsx("p",{children:"No documents uploaded for this contract."}),e.jsxs(P,{variant:"outline",size:"sm",className:"mt-4",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Upload Document"]})]})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs($,{className:"bg-primary/5 border-primary/20",children:[e.jsx(Y,{children:e.jsx(G,{className:"text-lg",children:"Financial Summary"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Base Salary"}),e.jsx("span",{className:"font-medium",children:h(j.ContractAmount)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Additions"}),e.jsxs("span",{className:"text-green-600 font-medium",children:["+",h(y)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Deductions"}),e.jsxs("span",{className:"text-red-600 font-medium",children:["-",h(T)]})]}),e.jsx(_e,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold",children:"Net Salary"}),e.jsx("span",{className:"text-xl font-bold text-primary",children:h(B)})]})]})]}),e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{className:"text-lg",children:"Employee Info"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:e.jsx(at,{className:"h-6 w-6 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold",children:[j.employees_FirstName," ",j.employees_LastName]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Employee ID: ",j.EmployeeID]})]})]}),e.jsx(P,{variant:"outline",className:"w-full",onClick:()=>i(`/employees/${j.EmployeeID}`),children:"View Employee Profile"})]})]})]})]})]})},ia=Ke({ContractID:oe(),EmployeeID:oe().min(1,"Employee ID is required"),ContractAmount:oe().min(0,"Amount must be positive"),ContractDate:he(),ContractStartDate:he(),ContractEndDate:he(),ContractNote:Z().optional()}),da=()=>{const{id:t}=ht(),[i,r]=v.useState(!1),[d,I]=v.useState(!0),[o,h]=v.useState([]),[j,b]=v.useState([]),[A,_]=v.useState([]),[y,T]=v.useState(!1),B=Re(),p=jt({resolver:Ct(ia),defaultValues:{ContractID:0,EmployeeID:0,ContractAmount:0,ContractDate:new Date,ContractStartDate:new Date,ContractEndDate:new Date,ContractNote:""}}),g=n=>{const s=typeof n=="string"?parseFloat(n):n;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0)},S=n=>{const s=o.find(N=>N.ContractPayTypeID===n.ContractPayTypeID),l=(s==null?void 0:s.ContractPayTypeName)||"";return l.includes("Delay Deduct")||l.includes("Absent Deduct")||n.contractpaytype_IsHour===1||n.contractpaytype_IsHour==="1"?n.ContractPAmountHour||0:n.ContractPAmount||0},O=v.useMemo(()=>(y?A:j).filter(n=>n.contractpaytype_IsAdd===1),[j,A,y]),E=v.useMemo(()=>(y?A:j).filter(n=>n.contractpaytype_IsAdd===0),[j,A,y]),K=v.useMemo(()=>{const s=(y?A:j).find(N=>N.ContractPayTypeID==1),l=s?parseFloat(S(s)):0;return isNaN(l)?0:l},[j,A,y]),u=v.useMemo(()=>O.filter(n=>n.ContractPayTypeID!=1).reduce((n,s)=>n+(parseFloat(S(s))||0),0),[O]),a=v.useMemo(()=>E.reduce((n,s)=>n+(parseFloat(S(s))||0),0),[E]),x=v.useMemo(()=>K+u-a,[K,u,a]);v.useEffect(()=>{(async()=>{if(t)try{I(!0);const l=(await F.contract.get(parseInt(t))).data;l&&p.reset({ContractID:l.ContractID,EmployeeID:l.EmployeeID,ContractAmount:parseFloat(l.ContractAmount)||0,ContractDate:l.ContractDate?new Date(l.ContractDate):new Date,ContractStartDate:l.ContractStartDate?new Date(l.ContractStartDate):new Date,ContractEndDate:l.ContractEndDate?new Date(l.ContractEndDate):new Date,ContractNote:l.ContractNote||""});const N=await F.list("contractp",{exact_filters:{ContractID:parseInt(t)},sort:"ContractPID:asc",pageSize:200});Array.isArray(N.data)&&(b(N.data),_(N.data));const M=await F.list("contractpaytype",{pageSize:100});Array.isArray(M.data)&&h(M.data)}catch(s){console.error("Error fetching data:",s),U.error("Failed to load contract data.")}finally{I(!1)}})()},[t,p]);const c=async n=>{try{r(!0);const s={EmployeeID:n.EmployeeID,ContractAmount:n.ContractAmount,ContractDate:J(n.ContractDate,"yyyy-MM-dd"),ContractStartDate:J(n.ContractStartDate,"yyyy-MM-dd"),ContractEndDate:J(n.ContractEndDate,"yyyy-MM-dd"),ContractNote:n.ContractNote};await F.contract.update(n.ContractID,s),y&&await C(),U.success("Contract updated successfully"),B("/contracts")}catch(s){console.error("Error updating contract:",s),U.error("Failed to update contract.")}finally{r(!1)}},C=async()=>{try{for(const n of A){const s={ContractPAmount:n.ContractPAmount||0,ContractPAmountHour:n.ContractPAmountHour||0,ContractNote:n.ContractNote||""};await F.contractp.update(n.ContractPID,s)}b([...A])}catch(n){throw console.error("Error updating contract payments:",n),n}},f=(n,s,l)=>{const N=[...A],M=N[n];if(s==="ContractPAmount"||s==="ContractPAmountHour"){const ne=typeof l=="string"?parseFloat(l)||0:l;if(ne<0)return;M[s]=ne}else{if(s==="ContractNote"&&typeof l=="string"&&l.length>200)return;M[s]=l}_(N)},w=()=>{y&&_([...j]),T(!y)};return d?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs(P,{variant:"ghost",className:"w-fit p-0 hover:bg-transparent",onClick:()=>B(-1),children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Back to Contracts"]}),e.jsxs("h1",{className:"text-2xl font-bold",children:["Edit Contract #",t]})]}),e.jsxs("form",{onSubmit:p.handleSubmit(c),className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{children:"Contract Information"})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"ContractAmount",children:"Base Salary Amount"}),e.jsx(H,{id:"ContractAmount",type:"number",step:"0.01",...p.register("ContractAmount",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Contract Date"}),e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:$e("w-full justify-start text-left font-normal",!p.watch("ContractDate")&&"text-muted-foreground"),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),p.watch("ContractDate")?J(p.watch("ContractDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(je,{className:"w-auto p-0",children:e.jsx(Ce,{mode:"single",selected:p.watch("ContractDate"),onSelect:n=>p.setValue("ContractDate",n||new Date),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Start Date"}),e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:$e("w-full justify-start text-left font-normal"),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),p.watch("ContractStartDate")?J(p.watch("ContractStartDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(je,{className:"w-auto p-0",children:e.jsx(Ce,{mode:"single",selected:p.watch("ContractStartDate"),onSelect:n=>p.setValue("ContractStartDate",n||new Date),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"End Date"}),e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:$e("w-full justify-start text-left font-normal"),children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),p.watch("ContractEndDate")?J(p.watch("ContractEndDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(je,{className:"w-auto p-0",children:e.jsx(Ce,{mode:"single",selected:p.watch("ContractEndDate"),onSelect:n=>p.setValue("ContractEndDate",n||new Date),initialFocus:!0})})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"ContractNote",children:"Notes"}),e.jsx(We,{id:"ContractNote",...p.register("ContractNote")})]})]})]}),e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{children:"Financial Summary"})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Base Salary"}),e.jsx("span",{children:g(K)})]}),e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Total Additions"}),e.jsxs("span",{children:["+",g(u)]})]}),e.jsxs("div",{className:"flex justify-between text-red-600",children:[e.jsx("span",{children:"Total Deductions"}),e.jsxs("span",{children:["-",g(a)]})]}),e.jsxs("div",{className:"pt-4 border-t flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Net Amount"}),e.jsx("span",{children:g(x)})]})]})})]}),e.jsxs($,{children:[e.jsx(Y,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(G,{children:"Contract Payments"}),e.jsx(P,{type:"button",variant:y?"outline":"default",onClick:w,children:y?"Cancel":"Edit Payments"})]})}),e.jsx(q,{children:e.jsx("div",{className:"space-y-4",children:A.map((n,s)=>{var N,M,ne,Se,Fe,te,Pe;const l=o.find(ae=>ae.ContractPayTypeID===n.ContractPayTypeID);return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("h4",{className:"font-medium",children:(l==null?void 0:l.ContractPayTypeName)||`Pay Type ${n.ContractPayTypeID}`}),e.jsx(ee,{variant:(l==null?void 0:l.IsAdd)===1?"default":"destructive",children:(l==null?void 0:l.IsAdd)===1?"+":"-"}),(l==null?void 0:l.IsHour)===1||(l==null?void 0:l.IsHour)==="1"||(N=l==null?void 0:l.ContractPayTypeName)!=null&&N.includes("Delay Deduct")||(M=l==null?void 0:l.ContractPayTypeName)!=null&&M.includes("Absent Deduct")?e.jsx(ee,{variant:"secondary",children:"Hourly"}):null]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(l==null?void 0:l.IsHour)===1||(l==null?void 0:l.IsHour)==="1"||(ne=l==null?void 0:l.ContractPayTypeName)!=null&&ne.includes("Delay Deduct")||(Se=l==null?void 0:l.ContractPayTypeName)!=null&&Se.includes("Absent Deduct")?e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`hourly-${n.ContractPID}`,children:"Hourly Rate"}),e.jsx(H,{id:`hourly-${n.ContractPID}`,type:"number",step:"0.01",min:"0",value:n.ContractPAmountHour||"",onChange:ae=>f(s,"ContractPAmountHour",ae.target.value),disabled:!y,placeholder:"0.00",className:(n.ContractPAmountHour||0)<0?"border-red-500":""}),(n.ContractPAmountHour||0)<0&&e.jsx("p",{className:"text-sm text-red-500",children:"Amount cannot be negative"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`amount-${n.ContractPID}`,children:"Amount"}),e.jsx(H,{id:`amount-${n.ContractPID}`,type:"number",step:"0.01",min:"0",value:n.ContractPAmount||"",onChange:ae=>f(s,"ContractPAmount",ae.target.value),disabled:!y,placeholder:"0.00",className:(n.ContractPAmount||0)<0?"border-red-500":""}),(n.ContractPAmount||0)<0&&e.jsx("p",{className:"text-sm text-red-500",children:"Amount cannot be negative"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`note-${n.ContractPID}`,children:"Note"}),e.jsx(H,{id:`note-${n.ContractPID}`,value:n.ContractNote||"",onChange:ae=>f(s,"ContractNote",ae.target.value),disabled:!y,placeholder:"Optional note",className:(((Fe=n.ContractNote)==null?void 0:Fe.length)||0)>200?"border-red-500":""}),(((te=n.ContractNote)==null?void 0:te.length)||0)>200&&e.jsx("p",{className:"text-sm text-red-500",children:"Note must be 200 characters or less"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((Pe=n.ContractNote)==null?void 0:Pe.length)||0,"/200 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Current Value"}),e.jsx("div",{className:"text-sm font-medium",children:g(S(n))})]})]})]},n.ContractPID)})})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>B(-1),children:"Cancel"}),e.jsx(P,{type:"submit",disabled:i,children:i?"Saving...":"Update Contract"})]})]})]})},ma=Ke({ContractTemplate:Z().optional(),EmployeeID:Z().min(1,"Employee ID is required"),ContractAmount:we([Z(),oe()]).transform(t=>typeof t=="string"?parseFloat(t)||0:t),ContractDate:he(),ContractStartDate:he(),ContractEndDate:he(),ContractNote:Z().optional(),payments:qt(Ke({ContractPayTypeID:Z().min(1,"Payment type is required"),ContractPAmount:we([Z(),oe()]).transform(t=>typeof t=="string"?parseFloat(t)||0:t),ContractPAmountHour:we([Z(),oe()]).optional().transform(t=>typeof t=="string"?parseFloat(t)||0:t),ContractNote:Z().optional(),Hours:we([Z(),oe()]).optional().transform(t=>typeof t=="string"?parseFloat(t)||0:t),Multiplier:we([Z(),oe()]).optional().transform(t=>typeof t=="string"?parseFloat(t)||1:t)})).min(1,"At least one payment is required")}),It=({open:t,onOpenChange:i,onSuccess:r})=>{const[d,I]=v.useState(!1),o=jt({resolver:Ct(ma),defaultValues:{ContractDate:new Date,ContractStartDate:new Date,ContractEndDate:new Date(new Date().setFullYear(new Date().getFullYear()+1)),payments:[{ContractPayTypeID:"",ContractPAmount:0,ContractPAmountHour:0,ContractNote:"",Hours:0,Multiplier:0}]}}),{fields:h,append:j,remove:b,replace:A}=Bt({control:o.control,name:"payments"}),{data:_=[],isLoading:y}=be({queryKey:["employees","withoutContract"],queryFn:()=>F.list("employees",{hasContract:!1}).then(u=>u.data||[])}),T=v.useMemo(()=>{const u=new Set;return _.filter(a=>u.has(a.EmployeeID)?!1:(u.add(a.EmployeeID),!0))},[_]),{data:B=[]}=be({queryKey:["contractpaytype"],queryFn:()=>se.getPaymentTypes()}),p=v.useMemo(()=>{const u=new Set;return B.filter(a=>u.has(a.ContractPayTypeID)?!1:(u.add(a.ContractPayTypeID),!0))},[B]),{data:g=[]}=be({queryKey:["contractstemplate"],queryFn:()=>se.getTemplates()}),S=v.useMemo(()=>{const u=new Set;return g.filter(a=>u.has(a.ContractTemplateID)?!1:(u.add(a.ContractTemplateID),!0))},[g]),O=v.useCallback((u,a,x)=>{var w,n,s,l;const C=o.getValues("payments")[u],f=p.find(N=>N.ContractPayTypeID.toString()===C.ContractPayTypeID);if(f){if((f.ContractPayTypeName.includes("Delay Deduct")||f.ContractPayTypeName.includes("Absent Deduct")||f.IsHour===1||f.IsHour==="1"||f.IsHour===!0)&&(a==="Hours"||a==="ContractPAmountHour")){const N=a==="Hours"?parseFloat(x)||0:parseFloat(((w=C.Hours)==null?void 0:w.toString())||"0")||0,M=a==="ContractPAmountHour"?parseFloat(x)||0:parseFloat(((n=C.ContractPAmountHour)==null?void 0:n.toString())||"0")||0;o.setValue(`payments.${u}.Hours`,N),o.setValue(`payments.${u}.ContractPAmount`,N*M)}if(f.ContractPayTypeName.includes("Overtime")&&(a==="Multiplier"||a==="ContractPAmountHour")){const N=a==="Multiplier"?parseFloat(x)||1:parseFloat(((s=C.Multiplier)==null?void 0:s.toString())||"1")||1,M=a==="ContractPAmountHour"?parseFloat(x)||0:parseFloat(((l=C.ContractPAmountHour)==null?void 0:l.toString())||"0")||0;o.setValue(`payments.${u}.Multiplier`,N),o.setValue(`payments.${u}.ContractPAmount`,M*N)}}},[o,p]),E=v.useCallback(async u=>{const a=S.find(x=>{var c;return((c=x.ContractTemplateID)==null?void 0:c.toString())===u});if(a){o.setValue("ContractAmount",parseFloat(a.ContractAmount)||0);const x=new Date;if(o.setValue("ContractStartDate",x),a.ContractDurationDays){const c=new Date(x);c.setDate(x.getDate()+a.ContractDurationDays),o.setValue("ContractEndDate",c)}try{const c=await F.list("contracttemplatepaytype",{exact_filters:{ContractTemplateID:u}});if(Array.isArray(c.data)&&c.data.length>0){const C=c.data.map(f=>({ContractPayTypeID:f.ContractPayTypeID.toString(),ContractPAmount:parseFloat(f.ContractPAmount)||0,ContractPAmountHour:parseFloat(f.ContractPAmountHour)||0,ContractNote:f.ContractNote||"",Hours:0,Multiplier:1}));A(C)}}catch(c){console.error("Error fetching template pay types:",c)}}},[S,o,A]),K=async u=>{try{I(!0);const a={EmployeeID:parseInt(u.EmployeeID),ContractAmount:parseFloat(u.ContractAmount.toString())||0,ContractDate:J(u.ContractDate,"yyyy-MM-dd"),ContractStartDate:J(u.ContractStartDate,"yyyy-MM-dd"),ContractEndDate:J(u.ContractEndDate,"yyyy-MM-dd"),ContractNote:u.ContractNote,ContractStatus:"New"},x=await F.contract.create(a),c=x.ContractID||x.id;if(!c)throw new Error("Failed to get ContractID from response");for(const C of u.payments)await F.create("contractp",{ContractID:c,ContractPayTypeID:parseInt(C.ContractPayTypeID),ContractPAmount:parseFloat(C.ContractPAmount.toString())||0,ContractPAmountHour:parseFloat(C.ContractPAmountHour.toString())||0,ContractNote:C.ContractNote||""});U.success("Contract created successfully"),r==null||r(),i(!1),o.reset()}catch(a){console.error("Failed to create contract:",a),U.error("Failed to create contract")}finally{I(!1)}};return e.jsx(ft,{open:t,onOpenChange:i,children:e.jsxs(Nt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(gt,{children:[e.jsx(vt,{children:"Create New Contract"}),e.jsx(Dt,{children:"Create a new employment contract for an employee"})]}),e.jsxs("form",{onSubmit:o.handleSubmit(K),className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{className:"text-lg text-primary",children:"Contract Details"})}),e.jsx(q,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"EmployeeID",children:"Employee"}),e.jsxs(fe,{value:o.watch("EmployeeID"),onValueChange:u=>o.setValue("EmployeeID",u),children:[e.jsx(Ne,{id:"EmployeeID",className:o.formState.errors.EmployeeID?"border-destructive":"",children:e.jsx(ge,{placeholder:y?"Loading employees...":"Select an employee"})}),e.jsx(ve,{children:T.map(u=>e.jsxs(L,{value:u.EmployeeID.toString(),children:[u.FirstName," ",u.LastName," (",u.EmployeeCode,")"]},u.EmployeeID))})]}),o.formState.errors.EmployeeID&&e.jsx("p",{className:"text-sm text-destructive",children:o.formState.errors.EmployeeID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"ContractTemplate",children:"Contract Template"}),e.jsxs(fe,{value:o.watch("ContractTemplate"),onValueChange:u=>{o.setValue("ContractTemplate",u),E(u)},children:[e.jsx(Ne,{id:"ContractTemplate",children:e.jsx(ge,{placeholder:"Select a template"})}),e.jsx(ve,{children:S.map(u=>e.jsx(L,{value:u.ContractTemplateID.toString(),children:u.TemplateName},u.ContractTemplateID))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"ContractAmount",children:"Base Salary Amount"}),e.jsx(H,{id:"ContractAmount",type:"number",step:"0.01",...o.register("ContractAmount",{valueAsNumber:!0}),className:o.formState.errors.ContractAmount?"border-destructive":""}),o.formState.errors.ContractAmount&&e.jsx("p",{className:"text-sm text-destructive",children:o.formState.errors.ContractAmount.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Contract Date"}),e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),o.watch("ContractDate")?J(o.watch("ContractDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(je,{className:"w-auto p-0",children:e.jsx(Ce,{mode:"single",selected:o.watch("ContractDate"),onSelect:u=>o.setValue("ContractDate",u||new Date)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Start Date"}),e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),o.watch("ContractStartDate")?J(o.watch("ContractStartDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(je,{className:"w-auto p-0",children:e.jsx(Ce,{mode:"single",selected:o.watch("ContractStartDate"),onSelect:u=>o.setValue("ContractStartDate",u||new Date)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"End Date"}),e.jsxs(pe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"}),o.watch("ContractEndDate")?J(o.watch("ContractEndDate"),"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(je,{className:"w-auto p-0",children:e.jsx(Ce,{mode:"single",selected:o.watch("ContractEndDate"),onSelect:u=>o.setValue("ContractEndDate",u||new Date)})})]})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(D,{htmlFor:"ContractNote",children:"Notes"}),e.jsx(We,{id:"ContractNote",...o.register("ContractNote"),className:"min-h-[80px]",placeholder:"Any additional notes about this contract"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Payment Items"}),e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:()=>j({ContractPayTypeID:"",ContractPAmount:0,ContractPAmountHour:0,ContractNote:"",Hours:0,Multiplier:1}),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Add Item"]})]}),h.map((u,a)=>{var n,s,l;const x=o.watch(`payments.${a}`),c=p.find(N=>N.ContractPayTypeID.toString()===(x==null?void 0:x.ContractPayTypeID)),C=((n=c==null?void 0:c.ContractPayTypeName)==null?void 0:n.includes("Delay Deduct"))||((s=c==null?void 0:c.ContractPayTypeName)==null?void 0:s.includes("Absent Deduct")),f=(l=c==null?void 0:c.ContractPayTypeName)==null?void 0:l.includes("Overtime"),w=(c==null?void 0:c.IsHour)===1||(c==null?void 0:c.IsHour)==="1"||(c==null?void 0:c.IsHour)===!0||C||f;return e.jsx($,{children:e.jsx(q,{className:"p-4 space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-5 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Payment Type"}),e.jsxs(fe,{onValueChange:N=>o.setValue(`payments.${a}.ContractPayTypeID`,N),value:o.watch(`payments.${a}.ContractPayTypeID`),children:[e.jsx(Ne,{children:e.jsx(ge,{placeholder:"Type"})}),e.jsx(ve,{className:"max-h-60",children:p.map(N=>e.jsxs(L,{value:N.ContractPayTypeID.toString(),children:[N.ContractPayTypeName," ",N.IsAdd===1?"(+)":"(-)"]},N.ContractPayTypeID))})]})]}),w?e.jsxs(e.Fragment,{children:[C?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Hours"}),e.jsx(H,{...o.register(`payments.${a}.Hours`),onChange:N=>O(a,"Hours",N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Amount"}),e.jsx(H,{...o.register(`payments.${a}.ContractPAmount`),disabled:!0,className:"bg-muted"})]})]}):f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Multiplier"}),e.jsx(H,{...o.register(`payments.${a}.Multiplier`),onChange:N=>O(a,"Multiplier",N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Amount"}),e.jsx(H,{...o.register(`payments.${a}.ContractPAmount`),disabled:!0,className:"bg-muted"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Amount"}),e.jsx(H,{...o.register(`payments.${a}.ContractPAmount`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Hourly Rate"}),e.jsx(H,{...o.register(`payments.${a}.ContractPAmountHour`),onChange:N=>O(a,"ContractPAmountHour",N.target.value),placeholder:"0.00"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Amount"}),e.jsx(H,{...o.register(`payments.${a}.ContractPAmount`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Hourly Rate (Optional)"}),e.jsx(H,{...o.register(`payments.${a}.ContractPAmountHour`),onChange:N=>O(a,"ContractPAmountHour",N.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(D,{children:"Note"}),e.jsx(H,{...o.register(`payments.${a}.ContractNote`)})]}),e.jsx(P,{type:"button",variant:"ghost",size:"icon",className:"text-destructive mb-0.5",onClick:()=>b(a),disabled:h.length===1,children:e.jsx(Te,{className:"h-4 w-4"})})]})]})})},u.id)})]}),e.jsxs(Kt,{children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>i(!1),disabled:d,children:"Cancel"}),e.jsx(P,{type:"submit",disabled:d,children:d?"Saving...":"Create Contract"})]})]})]})})},Ee=10,He=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),Ae=(t,i="MMM dd, yyyy")=>{if(!t)return"N/A";try{return J(Qe(t),i)}catch{return"Invalid date"}},Ie=t=>{const i=new Date,r=t.ContractEndDate?Qe(t.ContractEndDate):null,d=t.ContractStartDate?Qe(t.ContractStartDate):null;if(!r||!d)return{label:"Draft",variant:"outline"};if(Ut(i,d))return{label:"Upcoming",variant:"secondary"};if(Ot(i,r))return{label:"Expired",variant:"destructive"};const I=ra(r,i);return I<=30?{label:`Expires in ${I} days`,variant:"warning"}:{label:"Active",variant:"success"}},ua=()=>{var Pe,ae;const{t,i18n:i}=ze();i.dir();const r=Re(),d=kt(),[I,o]=v.useState(""),[h,j]=v.useState("all"),[b,A]=v.useState("all"),[_,y]=v.useState({}),[T,B]=v.useState(1),[p,g]=v.useState("ContractStartDate"),[S,O]=v.useState("desc"),[E,K]=v.useState([]),[u,a]=v.useState({}),[x,c]=v.useState(!1),{data:C,isLoading:f,error:w,refetch:n}=be({queryKey:["contract",{page:T,search:I,status:h,type:b,sortBy:p,sortOrder:S}],queryFn:()=>se.getContracts({page:T,pageSize:Ee,search:I,status:h!=="all"?[h]:void 0,type:b!=="all"?[b]:void 0,sortBy:p,sortOrder:S==="asc"?"asc":"desc"}),placeholderData:m=>m}),s=C,l=v.useMemo(()=>{if(!C)return{totalContracts:0,activeContracts:0,total:0,active:0,expiringSoon:0,expiring30:0,terminated:0,avgAmount:0};const m=Array.isArray(s)?s:(s==null?void 0:s.data)||[],k=Array.isArray(s)?s.length:(s==null?void 0:s.total)||0,R=new Date;new Date().setDate(R.getDate()+30);let W=0,Ge=0,Ze=0,Xe=0;return m.forEach(et=>{const Le=Ie(et);Le.label==="Active"&&W++,Le.variant==="destructive"&&Ze++,Le.variant==="warning"&&Ge++;const bt=parseFloat(et.ContractAmount)||0;Xe+=bt}),{total:k,active:W,expiringSoon:Ge,terminated:Ze,avgAmount:k>0?Xe/k:0}},[s]);lt({mutationFn:se.deleteContract,onSuccess:()=>{d.invalidateQueries({queryKey:["contracts"]}),d.invalidateQueries({queryKey:["contract-stats"]}),U.success(t("common.success"))},onError:m=>{U.error(`${t("common.error")}: ${m.message}`)}});const N=lt({mutationFn:m=>se.exportContracts(m),onSuccess:(m,k)=>{const R=new Blob([m],{type:`application/${k}`}),z=window.URL.createObjectURL(R),W=document.createElement("a");W.href=z,W.download=`contracts-${new Date().toISOString().split("T")[0]}.${k}`,document.body.appendChild(W),W.click(),window.URL.revokeObjectURL(z),document.body.removeChild(W),U.success(`Exported contracts as ${k.toUpperCase()}`)},onError:m=>{U.error(`Error exporting contracts: ${m.message}`)}}),M=m=>{p===m?O(S==="asc"?"desc":"asc"):(g(m),O("desc"))},ne=()=>{var m;E.length===(Array.isArray(s)?s.length:((m=s==null?void 0:s.data)==null?void 0:m.length)||0)?K([]):K((Array.isArray(s)?s:(s==null?void 0:s.data)||[]).map(k=>k.ContractID)||[])},Se=(m,k)=>{K(k?R=>[...R,m]:R=>R.filter(z=>z!==m))},Fe=m=>{a(k=>({...k,[m]:!k[m]}))},te=v.useMemo(()=>!s||Array.isArray(s)?1:Math.ceil((s.total||0)/(s.pageSize||Ee)),[s]);return f?e.jsxs("div",{className:"container mx-auto py-2 space-y-6",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((m,k)=>e.jsxs($,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(re,{className:"h-4 w-24"}),e.jsx(re,{className:"h-4 w-4"})]}),e.jsx(q,{children:e.jsx(re,{className:"h-8 w-16"})})]},k))}),e.jsx($,{children:e.jsx(Y,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between",children:[e.jsx(re,{className:"h-10 w-full md:w-1/3"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(re,{className:"h-10 w-32"}),e.jsx(re,{className:"h-10 w-24"})]})]})})}),e.jsx($,{children:e.jsx(q,{className:"p-0",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(re,{className:"h-8 w-48"}),e.jsx(re,{className:"h-8 w-24"})]}),[...Array(5)].map((m,k)=>e.jsx(re,{className:"h-16 w-full"},k))]})})})]}):e.jsxs("div",{className:"h-full flex flex-col gap-3 overflow-hidden",children:[e.jsxs("div",{className:"grid gap-2 md:grid-cols-2 lg:grid-cols-4 flex-shrink-0 pt-2",children:[e.jsx(Me,{title:t("contracts.stats.total"),value:l.total.toString(),icon:e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(Me,{title:t("contracts.stats.active"),value:l.active.toString(),icon:e.jsx(Qt,{className:"h-4 w-4 text-muted-foreground"}),variant:"success"}),e.jsx(Me,{title:t("contracts.stats.expiringSoon"),value:l.expiringSoon.toString(),icon:e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"}),variant:"warning"}),e.jsx(Me,{title:t("contracts.stats.totalValue"),value:He(l.avgAmount),icon:e.jsx(Et,{className:"h-4 w-4 text-muted-foreground"}),variant:"accent"})]}),e.jsx($,{className:"flex-shrink-0 pt-2",children:e.jsx(Y,{className:"pb-3 py-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"w-full md:w-1/3",children:[e.jsx(D,{htmlFor:"search",className:"sr-only",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ht,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground rtl:left-auto rtl:right-3"}),e.jsx(H,{id:"search",placeholder:t("contracts.filters.searchPlaceholder"),className:"ps-10",value:I,onChange:m=>o(m.target.value)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(fe,{value:h,onValueChange:j,children:[e.jsxs(Ne,{className:"w-[180px]",children:[e.jsx(Yt,{className:"me-2 h-4 w-4"}),e.jsx(ge,{placeholder:t("contracts.table.status")})]}),e.jsxs(ve,{children:[e.jsx(L,{value:"all",children:t("contracts.filters.allStatuses")}),e.jsx(L,{value:"active",children:t("contracts.status.active")}),e.jsx(L,{value:"expired",children:t("contracts.status.expired")}),e.jsx(L,{value:"upcoming",children:t("contracts.status.upcoming")}),e.jsx(L,{value:"draft",children:t("contracts.status.draft")})]})]}),e.jsxs(P,{variant:"outline",onClick:()=>{o(""),j("all"),A("all"),y({})},children:[e.jsx(st,{className:"me-2 h-4 w-4"}),t("contracts.filters.reset")]})]})]})})}),e.jsxs($,{className:"flex flex-col min-h-[300px] flex-1 pt-2",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{id:"select-all",checked:E.length>0&&E.length===(Array.isArray(s)?s.length:((Pe=s==null?void 0:s.data)==null?void 0:Pe.length)||0),onCheckedChange:ne,className:"h-4 w-4"}),e.jsx(D,{htmlFor:"select-all",className:"text-sm font-medium",children:E.length>0?`${E.length} ${t("contracts.table.selected")}`:t("contracts.table.selectAll")}),E.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8",onClick:()=>{U.info("Bulk action triggered")},children:[e.jsx(it,{className:"me-2 h-4 w-4"}),t("contracts.table.exportSelected")]}),e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 text-destructive hover:bg-destructive/10 hover:text-destructive",onClick:()=>{confirm(t("common.confirmDelete"))&&Promise.all(E.map(m=>se.deleteContract(m))).then(()=>{d.invalidateQueries({queryKey:["contracts"]}),d.invalidateQueries({queryKey:["contract-stats"]}),K([]),U.success(t("common.success"))}).catch(m=>{U.error(`${t("common.error")}: ${m.message}`)})},children:[e.jsx(Te,{className:"me-2 h-4 w-4"}),t("common.delete")]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(P,{variant:"outline",size:"sm",className:"h-8",onClick:()=>n(),disabled:f,children:[e.jsx(st,{className:`me-2 h-4 w-4 ${f?"animate-spin":""}`}),t("common.refresh")]}),e.jsxs(rt,{children:[e.jsx(nt,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"sm",className:"h-8",children:[e.jsx(it,{className:"mr-2 h-4 w-4"}),"Export"]})}),e.jsxs(ct,{align:"end",children:[e.jsxs(ue,{onClick:()=>N.mutate("pdf"),children:[e.jsx(aa,{className:"me-2 h-4 w-4"}),t("common.exportPdf")]}),e.jsxs(ue,{onClick:()=>N.mutate("excel"),children:[e.jsx(mt,{className:"me-2 h-4 w-4"}),t("common.exportExcel")]}),e.jsxs(ue,{onClick:()=>N.mutate("csv"),children:[e.jsx(mt,{className:"me-2 h-4 w-4"}),t("common.exportCsv")]})]})]})]})]}),e.jsx(Mt,{className:"flex-1 min-h-[200px]",children:e.jsxs(Be,{children:[e.jsx(Ue,{className:"bg-muted/50",children:e.jsxs(X,{children:[e.jsx(Q,{className:"w-12",children:e.jsx(le,{id:"select-all-header",checked:E.length>0&&E.length===(Array.isArray(s)?s.length:((ae=s==null?void 0:s.data)==null?void 0:ae.length)||0),onCheckedChange:ne,className:"h-4 w-4"})}),e.jsx(Q,{className:"cursor-pointer hover:bg-muted/80",onClick:()=>M("employees_LastName"),children:e.jsxs("div",{className:"flex items-center",children:[t("contracts.table.employee"),p==="employees_LastName"&&e.jsx(ke,{className:`ms-1 h-4 w-4 ${S==="desc"?"rotate-180":""}`})]})}),e.jsx(Q,{className:"cursor-pointer hover:bg-muted/80",onClick:()=>M("ContractAmount"),children:e.jsxs("div",{className:"flex items-center",children:[t("contracts.table.amount"),p==="ContractAmount"&&e.jsx(ke,{className:`ms-1 h-4 w-4 ${S==="desc"?"rotate-180":""}`})]})}),e.jsx(Q,{className:"cursor-pointer hover:bg-muted/80",onClick:()=>M("ContractStartDate"),children:e.jsxs("div",{className:"flex items-center",children:[t("contracts.table.startDate"),p==="ContractStartDate"&&e.jsx(ke,{className:`ms-1 h-4 w-4 ${S==="desc"?"rotate-180":""}`})]})}),e.jsx(Q,{className:"cursor-pointer hover:bg-muted/80",onClick:()=>M("ContractEndDate"),children:e.jsxs("div",{className:"flex items-center",children:[t("contracts.table.endDate"),p==="ContractEndDate"&&e.jsx(ke,{className:`ms-1 h-4 w-4 ${S==="desc"?"rotate-180":""}`})]})}),e.jsx(Q,{children:t("contracts.table.status")}),e.jsx(Q,{className:"text-end",children:t("contracts.table.actions")})]})}),e.jsx(Oe,{children:w?e.jsx(X,{children:e.jsx(V,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-destructive",children:[e.jsx(qe,{className:"h-8 w-8"}),e.jsx("p",{children:t("contracts.errorLoading")}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>n(),children:t("common.retry")})]})})}):!s||Array.isArray(s)&&s.length===0||!Array.isArray(s)&&(!s.data||s.data.length===0)?e.jsx(X,{children:e.jsx(V,{colSpan:8,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx(Ve,{className:"h-12 w-12 opacity-20"}),e.jsx("p",{className:"text-lg font-medium",children:t("contracts.noContractsFound")}),e.jsx("p",{className:"text-sm",children:t("contracts.noContractsFoundDesc")}),e.jsxs(P,{variant:"outline",className:"mt-4",onClick:()=>c(!0),children:[e.jsx(De,{className:"me-2 h-4 w-4"}),t("contracts.add")]})]})})}):(Array.isArray(s)?s:(s==null?void 0:s.data)||[]).map(m=>{var k,R;return e.jsxs($t.Fragment,{children:[e.jsxs(X,{className:`${u[m.ContractID]?"bg-muted/20":""} hover:bg-muted/10`,onClick:()=>Fe(m.ContractID),children:[e.jsx(V,{onClick:z=>z.stopPropagation(),children:e.jsx(le,{checked:E.includes(m.ContractID),onCheckedChange:z=>Se(m.ContractID,!!z),onClick:z=>z.stopPropagation(),className:"h-4 w-4"})}),e.jsxs(V,{children:[e.jsxs("div",{className:"font-medium",children:[m.employees_FirstName," ",m.employees_LastName]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["ID: ",m.EmployeeID]})]}),e.jsx(V,{children:He(m.ContractAmount)}),e.jsx(V,{children:Ae(m.ContractStartDate)}),e.jsx(V,{children:Ae(m.ContractEndDate)}),e.jsx(V,{children:e.jsx(ee,{variant:Ie(m).variant,className:"capitalize",children:Ie(m).label})}),e.jsx(V,{className:"text-end",children:e.jsxs(rt,{children:[e.jsx(nt,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"icon",onClick:z=>z.stopPropagation(),children:[e.jsx(ta,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:t("contracts.table.actions")})]})}),e.jsxs(ct,{align:"end",children:[e.jsxs(ue,{onClick:()=>r(`/contracts/${m.ContractID}`),children:[e.jsx(dt,{className:"me-2 h-4 w-4"}),t("common.view")]}),e.jsxs(ue,{onClick:()=>r(`/contracts/${m.ContractID}/edit`),children:[e.jsx(Jt,{className:"me-2 h-4 w-4"}),t("common.edit")]}),e.jsxs(ue,{className:"text-destructive",onClick:z=>{z.stopPropagation(),confirm(t("common.confirmDelete"))&&se.deleteContract(m.ContractID).then(()=>{d.invalidateQueries({queryKey:["contracts"]}),d.invalidateQueries({queryKey:["contract-stats"]}),U.success(t("common.success"))}).catch(W=>{U.error(`${t("common.error")}: ${W.message}`)})},children:[e.jsx(Te,{className:"me-2 h-4 w-4"}),t("common.delete")]})]})]})})]}),u[m.ContractID]&&e.jsx(X,{className:"hover:bg-muted/30",children:e.jsx(V,{colSpan:8,className:"px-6 py-0 border-t-0",children:e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:t("contracts.details.contractInfo")}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.details.id"),":"]})," ",m.ContractID]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.details.type"),":"]})," ",m.ContractType||"N/A"]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.table.status"),":"]})," ",e.jsx(ee,{variant:Ie(m).variant,className:"capitalize",children:Ie(m).label})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:t("contracts.details.dates")}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.details.created"),":"]})," ",Ae(m.ContractDate)]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.table.startDate"),":"]})," ",Ae(m.ContractStartDate)]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.table.endDate"),":"]})," ",Ae(m.ContractEndDate)]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:t("contracts.details.financials")}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.table.amount"),":"]})," ",He(m.ContractAmount)]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.details.payments"),":"]})," ",((k=m.payments)==null?void 0:k.length)||0]}),e.jsxs("p",{className:"text-sm",children:[e.jsxs("span",{className:"font-medium",children:[t("contracts.details.totalPaid"),":"]})," ",He(((R=m.payments)==null?void 0:R.reduce((z,W)=>z+W.ContractPAmount,0))||0)]})]})]})]}),m.ContractNote&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:t("contracts.details.notes")}),e.jsx("p",{className:"text-sm",children:m.ContractNote})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(P,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px] min-w-[44px]",onClick:()=>r(`/contracts/${m.ContractID}`),"aria-label":t("contracts.viewDetails"),children:e.jsx(dt,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px] min-w-[44px]",onClick:()=>r(`/contracts/${m.ContractID}/edit`),"aria-label":t("contracts.edit"),children:e.jsx(Pt,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 min-h-[44px] min-w-[44px] text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>{confirm(t("common.confirmDelete"))&&se.deleteContract(m.ContractID).then(()=>{d.invalidateQueries({queryKey:["contract"]}),d.invalidateQueries({queryKey:["contract-stats"]}),U.success(t("common.success"))}).catch(z=>{U.error(`${t("common.error")}: ${z.message}`)})},"aria-label":t("contracts.delete"),children:e.jsx(Te,{className:"h-4 w-4"})})]})]})})})]},m.ContractID)})})]})}),!Array.isArray(C)&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:(((s==null?void 0:s.page)||1)-1)*((s==null?void 0:s.pageSize)||Ee)+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(((s==null?void 0:s.page)||1)*((s==null?void 0:s.pageSize)||Ee),(s==null?void 0:s.total)||0)})," ","of ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.total)||0})," contracts"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>B(m=>Math.max(m-1,1)),disabled:T===1||f,children:[e.jsx(Wt,{className:"h-4 w-4 rtl:rotate-180"}),e.jsx("span",{className:"ms-1",children:t("common.previous")})]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,te)},(m,k)=>{let R;return te<=5||T<=3?R=k+1:T>=te-2?R=te-4+k:R=T-2+k,e.jsx(P,{variant:R===T?"default":"outline",size:"sm",className:"w-10 h-10 p-0",onClick:()=>B(R),disabled:f,children:R},R)})}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>B(m=>Math.min(m+1,te)),disabled:T===te||f||te===0,children:[e.jsx("span",{className:"me-1",children:t("common.next")}),e.jsx(_t,{className:"h-4 w-4 rtl:rotate-180"})]})]})]})]}),e.jsx(It,{open:x,onOpenChange:c,onSuccess:()=>n()})]})},Me=({title:t,value:i,icon:r,variant:d="default"})=>{const I={default:"bg-background",success:"bg-green-50 dark:bg-green-900/20",warning:"bg-yellow-50 dark:bg-yellow-900/20",destructive:"bg-red-50 dark:bg-red-900/20",accent:"bg-blue-50 dark:bg-blue-900/20"},o={default:"text-foreground",success:"text-green-600 dark:text-green-400",warning:"text-yellow-600 dark:text-yellow-400",destructive:"text-red-600 dark:text-red-400",accent:"text-blue-600 dark:text-blue-400"};return e.jsx($,{className:`${I[d]} transition-colors`,children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:t}),e.jsx("h3",{className:`text-2xl font-bold ${o[d]}`,children:typeof i=="number"?i.toLocaleString():i})]}),e.jsx("div",{className:`rounded-full p-2 ${o[d]} bg-opacity-20 ${I[d]}`,children:r})]})})})};function xa(){const t=Vt(),i=Re(),[r,d]=v.useState(!1),{t:I,i18n:o}=ze(),h=o.dir()==="rtl",j=t.pathname.endsWith("/reports")?"reports":t.pathname.endsWith("/templates")?"templates":"overview";return e.jsxs("div",{className:"flex flex-col h-[calc(100vh-130px)]",children:[e.jsxs("div",{className:"flex-shrink-0 space-y-2 pt-2",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:I("contracts.title")}),e.jsxs("div",{className:"flex flex-row items-center justify-between gap-4 pt-2",children:[e.jsx(Ye,{value:j,onValueChange:b=>{b==="overview"?i("/contracts"):b==="reports"?i("/contracts/reports"):b==="templates"&&i("/contracts/templates")},dir:h?"rtl":"ltr",children:e.jsxs(Je,{children:[e.jsx(de,{value:"overview",children:I("contracts.tabs.overview")}),e.jsx(de,{value:"templates",children:I("contracts.tabs.templates")}),e.jsx(de,{value:"reports",children:I("contracts.tabs.reports")})]})}),j==="overview"&&e.jsxs(P,{onClick:()=>d(!0),children:[e.jsx(De,{className:"me-2 h-4 w-4"}),I("contracts.add")]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(Rt,{})}),e.jsx(It,{open:r,onOpenChange:d,onSuccess:()=>{window.location.reload()}})]})}const ha=()=>{const[t,i]=v.useState("contract_summary"),r={contract_summary:{type:"report_contract_summary",title:"Contract Summary Report",description:"List of all employee contracts with their status and details.",columns:[{key:"ContractID",label:"ID"},{key:"EmployeeName",label:"Employee"},{key:"ContractAmount",label:"Amount",format:d=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d)},{key:"ContractStartDate",label:"Start Date",format:d=>d?new Date(d).toLocaleDateString():"-"},{key:"ContractEndDate",label:"End Date",format:d=>d?new Date(d).toLocaleDateString():"-"},{key:"ContractStatus",label:"Status",format:d=>e.jsx(ee,{variant:d==="Running"?"default":d==="Completed"?"secondary":d==="Terminated"?"destructive":"outline",children:d})}],filters:[{key:"start_date",label:"Start Date",type:"date",defaultValue:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]},{key:"end_date",label:"End Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]}]},contract_components:{type:"report_contract_components",title:"Contract Pay Components Report",description:"Breakdown of salary components and deductions per contract.",columns:[{key:"ContractID",label:"Contract ID"},{key:"EmployeeName",label:"Employee"},{key:"ContractPayTypeName",label:"Component"},{key:"ComponentType",label:"Type",format:d=>e.jsx(ee,{variant:d==="Addition"?"default":"secondary",children:d})},{key:"ContractPAmount",label:"Amount",format:d=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d)},{key:"ContractPAmountHour",label:"Hourly Rate",format:d=>d>0?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d):"-"}],filters:[{key:"start_date",label:"Start Date",type:"date",defaultValue:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]},{key:"end_date",label:"End Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]}]}};return e.jsxs("div",{className:"h-full flex flex-col space-y-4 overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ye,{value:t,onValueChange:i,children:e.jsxs(Je,{children:[e.jsx(de,{value:"contract_summary",children:"Contract Summary"}),e.jsx(de,{value:"contract_components",children:"Pay Components"})]})})}),e.jsx($,{className:"flex-1 min-h-0 overflow-hidden",children:e.jsx(q,{className:"h-full p-0",children:e.jsx(Gt,{type:r[t].type,title:r[t].title,description:r[t].description,columns:r[t].columns,filters:r[t].filters})})})]})};function pa({open:t,onOpenChange:i,template:r,onSave:d,onCancel:I,onRefresh:o}){const{t:h}=ze(),[j,b]=v.useState(!1),[A,_]=v.useState([]),[y,T]=v.useState(r||{TemplateName:"",TemplateCode:"",TemplateDescription:"",ContractAmount:0,ContractDurationDays:30,ContractDurationMonths:12,TemplateType:"employment",ContractCategory:"Full-time",IsPublic:!1,IsActive:!0,IsDefault:!1,PayTypes:[]});v.useEffect(()=>{if(t)if(r!=null&&r.ContractTemplateID){const a={TemplateName:r.TemplateName||"",TemplateCode:r.TemplateCode||"",TemplateDescription:r.TemplateDescription||"",ContractAmount:r.ContractAmount||0,ContractDurationDays:r.ContractDurationDays||30,ContractDurationMonths:r.ContractDurationMonths||Math.round((r.ContractDurationDays||30)/30),TemplateType:r.TemplateType||"employment",ContractCategory:r.ContractCategory||"Full-time",IsPublic:r.IsPublic||!1,IsActive:r.IsActive!==void 0?r.IsActive:!0,IsDefault:r.IsDefault||!1,PayTypes:r.PayTypes||[],...r};T(a),A.length>0&&B(r.ContractTemplateID)}else T({TemplateName:"",TemplateCode:"",TemplateDescription:"",ContractAmount:0,ContractDurationDays:30,ContractDurationMonths:12,TemplateType:"employment",ContractCategory:"Full-time",IsPublic:!1,IsActive:!0,IsDefault:!1,PayTypes:[]})},[r,t]),v.useEffect(()=>{t&&(r!=null&&r.ContractTemplateID)&&A.length>0&&!y.PayTypes.length&&B(r.ContractTemplateID)},[r,t,A,y.PayTypes.length]);const B=async a=>{try{const x=ce.contracttemplatepaytype.list,c=await x({exact_filters:{ContractTemplateID:a}});let C=[];if(Array.isArray(c))C=c;else if(c&&c.data){const f=c.data;Array.isArray(f)?C=f:f.data&&Array.isArray(f.data)&&(C=f.data)}console.log("Template Pay Types found:",C),console.log("Available Pay Types:",A),T(f=>({...f,PayTypes:C.map(w=>{const n=A.find(s=>s.ContractPayTypeID===w.ContractPayTypeID);return{ContractPayTypeID:w.ContractPayTypeID,ContractPayTypeName:(n==null?void 0:n.ContractPayTypeName)||`Pay Type ${w.ContractPayTypeID}`,Description:(n==null?void 0:n.Description)||"",IsAdd:(n==null?void 0:n.IsAdd)||0,ContractPAmount:w.ContractPAmount||0,ContractPAmountHour:w.ContractPAmountHour||0,ContractNote:w.ContractNote||""}})}))}catch(x){console.error("Error fetching template pay types:",x),T(c=>({...c,PayTypes:[]}))}};v.useEffect(()=>{p()},[]);const p=async()=>{try{const a=ce.contractpaytype.list,x=await a();let c=[];if(Array.isArray(x))c=x;else if(x&&x.data){const C=x.data;Array.isArray(C)?c=C:C.data&&Array.isArray(C.data)&&(c=C.data)}_(c)}catch(a){console.error("Error fetching pay types:",a),_([])}},g=(a,x)=>{T(c=>{const C=c.PayTypes||[];return x?{...c,PayTypes:[...C,{ContractPayTypeID:a.ContractPayTypeID,ContractPayTypeName:a.ContractPayTypeName,Description:a.Description||"",IsAdd:a.IsAdd,ContractPAmount:0,ContractPAmountHour:0,ContractNote:""}]}:{...c,PayTypes:C.filter(f=>f.ContractPayTypeID!==a.ContractPayTypeID)}})},S=(a,x,c)=>{let C=c;(x!=="ContractNote"&&x!=="Hours"&&x!=="Multiplier"||x==="Hours"||x==="Multiplier")&&(C=typeof c=="string"?parseFloat(c)||0:c),T(f=>{const w=f.PayTypes.map(n=>{if(n.ContractPayTypeID===a){const s={...n,[x]:C},l=A.find(N=>N.ContractPayTypeID===a);if(l&&(l.ContractPayTypeName.includes("Delay Deduct")||l.ContractPayTypeName.includes("Absent Deduct"))){const N=s.Hours||0,M=s.ContractPAmountHour||0;s.ContractPAmount=N*M}if(l&&l.ContractPayTypeName.includes("Overtime")){const N=s.Multiplier||1,M=s.ContractPAmountHour||0;s.ContractPAmount=M*N}return s}return n});return{...f,PayTypes:w}})},O=()=>!y.PayTypes||!Array.isArray(y.PayTypes)?0:y.PayTypes.reduce((a,x)=>x.IsAdd===1?a+x.ContractPAmount:a,0),E=async a=>{var x,c;a.preventDefault(),b(!0);try{const C=O(),f={...y,ContractAmount:C};let w;if(r!=null&&r.ContractTemplateID)await ce.contractstemplate.update(r.ContractTemplateID,f),w=r.ContractTemplateID,await K(w);else{const n=await ce.contractstemplate.create(f);console.log("Template creation response:",n);const s=n;w=(s==null?void 0:s.ContractTemplateID)||((x=s==null?void 0:s.data)==null?void 0:x.ContractTemplateID)||(s==null?void 0:s.id)||((c=s==null?void 0:s.data)==null?void 0:c.id),console.log("Extracted template ID:",w)}y.PayTypes&&y.PayTypes.length>0&&(console.log("Calling saveTemplatePayTypes with ID:",w),await u(w,y.PayTypes)),d(f),o&&o(),i(!1)}catch(C){console.error("Error saving template:",C)}finally{b(!1)}},K=async a=>{try{const x=ce.contracttemplatepaytype.delete;await x(a)}catch(x){console.error("Error deleting existing pay types:",x)}},u=async(a,x)=>{try{console.log("Saving pay types for template ID:",a),console.log("Pay types to save:",x);const c=ce.contracttemplatepaytype.create;for(const C of x){const f={ContractTemplateID:a,ContractPayTypeID:C.ContractPayTypeID,ContractPAmount:C.ContractPAmount||0,ContractPAmountHour:C.ContractPAmountHour||0,ContractNote:C.ContractNote||"",SortOrder:0};console.log("Pay type data being sent:",f),await c(f)}}catch(c){throw console.error("Error saving template pay types:",c),c}};return e.jsx(ft,{open:t,onOpenChange:i,children:e.jsxs(Nt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(gt,{children:[e.jsx(vt,{children:h(r?"contracts.template.edit":"contracts.template.create")}),e.jsx(Dt,{children:h("contracts.template.description")})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{children:h("contracts.template.info")})}),e.jsxs(q,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"TemplateName",children:h("contracts.template.name")}),e.jsx(H,{id:"TemplateName",value:y.TemplateName||"",onChange:a=>T({...y,TemplateName:a.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"TemplateCode",children:h("contracts.template.code")}),e.jsx(H,{id:"TemplateCode",value:y.TemplateCode||"",onChange:a=>T({...y,TemplateCode:a.target.value.toUpperCase()}),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"TemplateDescription",children:h("contracts.template.description")}),e.jsx(We,{id:"TemplateDescription",value:y.TemplateDescription||"",onChange:a=>T({...y,TemplateDescription:a.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"TemplateType",children:h("contracts.template.type")}),e.jsxs(fe,{value:y.TemplateType,onValueChange:a=>T({...y,TemplateType:a}),children:[e.jsx(Ne,{children:e.jsx(ge,{})}),e.jsxs(ve,{children:[e.jsx(L,{value:"employment",children:"Employment"}),e.jsx(L,{value:"freelance",children:"Freelance"}),e.jsx(L,{value:"internship",children:"Internship"}),e.jsx(L,{value:"consultancy",children:"Consultancy"}),e.jsx(L,{value:"service",children:"Service"}),e.jsx(L,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"ContractCategory",children:h("contracts.template.category")}),e.jsx(H,{id:"ContractCategory",value:y.ContractCategory||"",onChange:a=>T({...y,ContractCategory:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(D,{htmlFor:"ContractDuration",children:[h("contracts.template.duration")," (months)"]}),e.jsx("div",{className:"flex gap-1",children:e.jsxs(fe,{value:(y.ContractDurationMonths||12).toString(),onValueChange:a=>{const x=parseInt(a);T({...y,ContractDurationMonths:x,ContractDurationDays:x*30})},children:[e.jsx(Ne,{className:"w-65",children:e.jsx(ge,{placeholder:"Select"})}),e.jsxs(ve,{children:[e.jsx(L,{value:"3",children:"3 months"}),e.jsx(L,{value:"6",children:"6 months"}),e.jsx(L,{value:"12",children:"12 months"}),e.jsx(L,{value:"24",children:"24 months"})]})]})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Duration: ",y.ContractDurationMonths||12," months (",y.ContractDurationDays||360," days)"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{id:"IsPublic",checked:y.IsPublic,onCheckedChange:a=>T({...y,IsPublic:!!a})}),e.jsx(D,{htmlFor:"IsPublic",children:h("contracts.template.public")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{id:"IsActive",checked:y.IsActive,onCheckedChange:a=>T({...y,IsActive:!!a})}),e.jsx(D,{htmlFor:"IsActive",children:h("contracts.template.active")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{id:"IsDefault",checked:y.IsDefault,onCheckedChange:a=>T({...y,IsDefault:!!a})}),e.jsx(D,{htmlFor:"IsDefault",children:h("contracts.template.default")})]})]})]})]}),e.jsxs($,{children:[e.jsx(Y,{children:e.jsx(G,{children:h("contracts.template.payTypes")})}),e.jsxs(q,{children:[e.jsx("div",{className:"space-y-4",children:A.map(a=>{var C,f;const x=(C=y.PayTypes)==null?void 0:C.some(w=>w.ContractPayTypeID===a.ContractPayTypeID),c=(f=y.PayTypes)==null?void 0:f.find(w=>w.ContractPayTypeID===a.ContractPayTypeID);return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(le,{id:`paytype-${a.ContractPayTypeID}`,checked:x,onCheckedChange:w=>g(a,!!w)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{htmlFor:`paytype-${a.ContractPayTypeID}`,className:"font-medium",children:a.ContractPayTypeName}),e.jsx(ee,{variant:a.IsAdd===1?"default":"destructive",children:a.IsAdd===1?"+":"-"})]}),a.Description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.Description})]})]})}),x&&c&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-4 gap-4 pl-7",children:[a.IsHour===1||a.IsHour==="1"||a.IsHour===!0||a.ContractPayTypeName.includes("Delay Deduct")||a.ContractPayTypeName.includes("Absent Deduct")?e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`hourly-${a.ContractPayTypeID}`,children:h("contracts.template.hourlyRate")}),e.jsx(H,{id:`hourly-${a.ContractPayTypeID}`,type:"text",value:c.ContractPAmountHour,onChange:w=>S(a.ContractPayTypeID,"ContractPAmountHour",w.target.value),placeholder:"0.00"})]}):null,a.ContractPayTypeName.includes("Delay Deduct")||a.ContractPayTypeName.includes("Absent Deduct")?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`hours-${a.ContractPayTypeID}`,children:"Hours"}),e.jsx(H,{id:`hours-${a.ContractPayTypeID}`,type:"text",value:c.Hours||"",onChange:w=>S(a.ContractPayTypeID,"Hours",w.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`amount-${a.ContractPayTypeID}`,children:h("contracts.template.amount")}),e.jsx(H,{id:`amount-${a.ContractPayTypeID}`,type:"text",value:c.ContractPAmount,disabled:!0,className:"bg-muted"})]})]}):a.ContractPayTypeName.includes("Overtime")?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`multiplier-${a.ContractPayTypeID}`,children:"Multiplier"}),e.jsx(H,{id:`multiplier-${a.ContractPayTypeID}`,type:"text",value:c.Multiplier||"",onChange:w=>S(a.ContractPayTypeID,"Multiplier",w.target.value),placeholder:"1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`amount-${a.ContractPayTypeID}`,children:h("contracts.template.amount")}),e.jsx(H,{id:`amount-${a.ContractPayTypeID}`,type:"text",value:c.ContractPAmount,disabled:!0,className:"bg-muted"})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`amount-${a.ContractPayTypeID}`,children:h("contracts.template.amount")}),e.jsx(H,{id:`amount-${a.ContractPayTypeID}`,type:"text",value:c.ContractPAmount,onChange:w=>S(a.ContractPayTypeID,"ContractPAmount",w.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:`note-${a.ContractPayTypeID}`,children:h("contracts.template.note")}),e.jsx(H,{id:`note-${a.ContractPayTypeID}`,value:c.ContractNote,onChange:w=>S(a.ContractPayTypeID,"ContractNote",w.target.value)})]})]})]},a.ContractPayTypeID)})}),e.jsx("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:h("contracts.template.totalAmount")}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",O().toFixed(2)]})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsxs(P,{type:"button",variant:"outline",onClick:()=>i(!1),children:[e.jsx(zt,{className:"mr-2 h-4 w-4"}),h("common.cancel")]}),e.jsxs(P,{type:"submit",disabled:j,children:[e.jsx(sa,{className:"mr-2 h-4 w-4"}),h(j?"common.saving":"common.save")]})]})]})]})})}function ya(){const{t}=ze(),[i,r]=v.useState([]),[d,I]=v.useState(!0),[o,h]=v.useState(!1),[j,b]=v.useState();v.useEffect(()=>{A()},[]);const A=async()=>{try{const g=await ce.contractstemplate.list();let S=[];if(Array.isArray(g))S=g;else if(g&&typeof g=="object"){const E=g;Array.isArray(E.data)?S=E.data:E.data&&Array.isArray(E.data.data)&&(S=E.data.data)}const O=S.filter((E,K,u)=>K===u.findIndex(a=>a.ContractTemplateID===E.ContractTemplateID));r(O)}catch(g){console.error("Error fetching templates:",g),r([])}finally{I(!1)}},_=()=>{b(void 0),h(!0)},y=g=>{b(g),h(!0)},T=async g=>{await A(),h(!1),b(void 0)},B=async g=>{if(confirm(t("contracts.template.deleteConfirm")))try{await ce.contractstemplate.delete(g),await A()}catch(S){console.error("Error deleting template:",S)}},p=async g=>{const S={...g,TemplateName:`${g.TemplateName} (Copy)`,TemplateCode:`${g.TemplateCode}_COPY`,ContractTemplateID:void 0};b(S),h(!0)};return d?e.jsx("div",{className:"flex justify-center p-8",children:t("common.loading")}):e.jsxs("div",{className:"h-full flex flex-col space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"flex-shrink-0 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:t("contracts.templates.title")}),e.jsx("p",{className:"text-muted-foreground",children:t("contracts.templates.description")})]}),e.jsxs(P,{onClick:_,children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),t("contracts.templates.create")]})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(g=>e.jsxs($,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(Y,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(G,{className:"text-lg",children:g.TemplateName}),e.jsx(pt,{className:"text-xs mt-1",children:g.TemplateCode})]}),e.jsxs("div",{className:"flex gap-1",children:[g.IsDefault&&e.jsx(ee,{variant:"default",className:"text-xs",children:t("contracts.template.default")}),g.IsPublic&&e.jsx(ee,{variant:"secondary",className:"text-xs",children:t("contracts.template.public")}),!g.IsActive&&e.jsx(ee,{variant:"destructive",className:"text-xs",children:t("contracts.template.inactive")})]})]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-2",children:[g.TemplateDescription&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:g.TemplateDescription}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("contracts.template.amount")}),e.jsxs("span",{className:"font-semibold",children:["$",g.ContractAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("contracts.template.duration")}),e.jsxs("span",{className:"font-semibold",children:[g.ContractDurationDays," ",t("common.days")]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:t("contracts.template.usage")}),e.jsx("span",{className:"font-semibold",children:g.UsageCount})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(P,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>y(g),children:[e.jsx(Pt,{className:"h-3 w-3 mr-1"}),t("common.edit")]}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>p(g),children:e.jsx(ea,{className:"h-3 w-3"})}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>B(g.ContractTemplateID),children:e.jsx(Te,{className:"h-3 w-3"})})]})]})})]},g.ContractTemplateID))}),i.length===0&&e.jsx($,{children:e.jsxs(q,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:t("contracts.templates.empty")}),e.jsxs(P,{onClick:_,children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),t("contracts.templates.create")]})]})})]}),e.jsx(pa,{open:o,onOpenChange:h,template:j,onSave:T,onCancel:()=>{h(!1),b(void 0)}})]})}function Ya(){return e.jsxs(Lt,{children:[e.jsxs(xe,{element:e.jsx(xa,{}),children:[e.jsx(xe,{index:!0,element:e.jsx(ua,{})}),e.jsx(xe,{path:"templates",element:e.jsx(ya,{})}),e.jsx(xe,{path:"reports",element:e.jsx(ha,{})})]}),e.jsx(xe,{path:":id",element:e.jsx(la,{})}),e.jsx(xe,{path:":id/edit",element:e.jsx(da,{})})]})}export{la as ContractDetails,ya as ContractTemplates,xa as ContractsLayout,Ya as ContractsModule,ha as ContractsReports,da as EditContract,ua as EmployeeContracts};
