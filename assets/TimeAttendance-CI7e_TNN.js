import{l as Fs,r as c,m as Os,aF as Ps,j as e,d as Ze,C as q,g as K,u as Ct,B as v,e as ne,f as le,h as Ce,t as et,i as Qe,k as It,U as vt,a9 as Bs,K as gt,a0 as _s,Q as Nt,n as V,S as Ft,R as qe,F as Ms,a5 as Ls,b as Hs,o as $s,a as C}from"./index-DcTsfPOQ.js";import{R as zs}from"./ReportViewer-mOsnLBaH.js";import{T as Ot,a as Ws,b as Y,c as de}from"./tabs--CwFPUC6.js";import{o as Us,s as me,n as Ke,f as U,u as Vs,t as Rs}from"./types-D04yGbvz.js";import{D as ue,a as xe,b as pe,c as fe,f as ye}from"./dialog-BTqBvcGL.js";import{I as P}from"./input-COXv_7eX.js";import{L as A}from"./label-CAQongzc.js";import{S as bt}from"./switch-DUqhGd3N.js";import{S as Ys}from"./ScrollableTabs-B5bhjMmm.js";import{D as qs,d as he}from"./index-D2zfLPLw.js";import Ks from"./EmployeeCheckInOut-DI3So9kJ.js";import{S as Ie}from"./skeleton-C0wj_6h9.js";import{A as tt,a as st,b as at}from"./alert-OO0Ojiqf.js";import{P as wt}from"./progress-C40gf3c0.js";import{aO as Js,E as Qs,aP as Xs,u as Gs,aQ as Zs,d as ea,aR as ta,aS as sa,aT as aa,ad as ra,ae as na,aU as la,ao as Pt,aV as ia,aW as St,aK as oa,aM as ca,aN as da,C as ma,aL as ha}from"./PieChart-CFYHXZsb.js";import{P as ua}from"./plus-7yv9qKks.js";import{P as rt}from"./pencil-BE3j2NYC.js";import{T as nt}from"./trash-2-B_FQxvZR.js";import{P as xa,b as pa,c as fa,C as ya,g as Bt}from"./popover-Bj1zDLHq.js";import{T as _t,a as Mt,b as je,c as F,d as Lt,e as I}from"./table-BJW1dPs9.js";import{M as ja}from"./map-pin-DnVTCD3Q.js";import{C as At}from"./circle-check-big-BGEqZooA.js";import{C as kt}from"./circle-x-DzFu7jU1.js";import{D as Dt}from"./download-CdRm0dBl.js";import{U as Je}from"./upload-B3qDrM1g.js";import"./select-DCRErqP0.js";import"./index-9jX0xVs3.js";import"./date-picker-BfeghS0q.js";import"./loader-circle-BaCmAyG7.js";import"./index-DcfIKM1A.js";import"./checkbox-Bg6Eu0gF.js";import"./api-DUHMZ36Z.js";import"./EmployeeDropdown-DuTUVXBl.js";import"./getDaysInMonth-8Efe35wA.js";import"./chevron-left-CDQ6U5C1.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Fs("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);function Xe(){return Xe=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(s[a]=n[a])}return s},Xe.apply(null,arguments)}function Et(s,r){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);r&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),n.push.apply(n,a)}return n}function ga(s){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Et(Object(n),!0).forEach(function(a){lt(s,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(n,a))})}return s}function lt(s,r,n){return(r=Na(r))in s?Object.defineProperty(s,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[r]=n,s}function Na(s){var r=ba(s,"string");return typeof r=="symbol"?r:r+""}function ba(s,r){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var a=n.call(s,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}var H=32;class it extends c.PureComponent{renderIcon(r,n){var{inactiveColor:a}=this.props,i=H/2,x=H/6,g=H/3,d=r.inactive?a:r.color,N=n??r.type;if(N==="none")return null;if(N==="plainline")return c.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:i,x2:H,y2:i,className:"recharts-legend-icon"});if(N==="line")return c.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(i,"h").concat(g,`
            A`).concat(x,",").concat(x,",0,1,1,").concat(2*g,",").concat(i,`
            H`).concat(H,"M").concat(2*g,",").concat(i,`
            A`).concat(x,",").concat(x,",0,1,1,").concat(g,",").concat(i),className:"recharts-legend-icon"});if(N==="rect")return c.createElement("path",{stroke:"none",fill:d,d:"M0,".concat(H/8,"h").concat(H,"v").concat(H*3/4,"h").concat(-H,"z"),className:"recharts-legend-icon"});if(c.isValidElement(r.legendIcon)){var j=ga({},r);return delete j.legendIcon,c.cloneElement(r.legendIcon,j)}return c.createElement(Js,{fill:d,cx:i,cy:i,size:H,sizeType:"diameter",type:N})}renderItems(){var{payload:r,iconSize:n,layout:a,formatter:i,inactiveColor:x,iconType:g}=this.props,d={x:0,y:0,width:H,height:H},N={display:a==="horizontal"?"inline-block":"block",marginRight:10},j={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map((f,b)=>{var m=f.formatter||i,p=Os({"recharts-legend-item":!0,["legend-item-".concat(b)]:!0,inactive:f.inactive});if(f.type==="none")return null;var B=f.inactive?x:f.color,$=m?m(f.value,f,b):f.value;return c.createElement("li",Xe({className:p,style:N,key:"legend-item-".concat(b)},Qs(this.props,f,b)),c.createElement(Xs,{width:n,height:n,viewBox:d,style:j,"aria-label":"".concat($," legend icon")},this.renderIcon(f,g)),c.createElement("span",{className:"recharts-legend-item-text",style:{color:B}},$))})}render(){var{payload:r,layout:n,align:a}=this.props;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return c.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}lt(it,"displayName","Legend");lt(it,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});function wa(){return Gs(Zs)}var Sa=["contextPayload"];function Ge(){return Ge=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)({}).hasOwnProperty.call(n,a)&&(s[a]=n[a])}return s},Ge.apply(null,arguments)}function Tt(s,r){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);r&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),n.push.apply(n,a)}return n}function ie(s){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?Tt(Object(n),!0).forEach(function(a){ot(s,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(n,a))})}return s}function ot(s,r,n){return(r=Aa(r))in s?Object.defineProperty(s,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):s[r]=n,s}function Aa(s){var r=ka(s,"string");return typeof r=="symbol"?r:r+""}function ka(s,r){if(typeof s!="object"||!s)return s;var n=s[Symbol.toPrimitive];if(n!==void 0){var a=n.call(s,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}function Da(s,r){if(s==null)return{};var n,a,i=Ea(s,r);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(s);for(a=0;a<x.length;a++)n=x[a],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(s,n)&&(i[n]=s[n])}return i}function Ea(s,r){if(s==null)return{};var n={};for(var a in s)if({}.hasOwnProperty.call(s,a)){if(r.indexOf(a)!==-1)continue;n[a]=s[a]}return n}function Ta(s){return s.value}function Ca(s){var{contextPayload:r}=s,n=Da(s,Sa),a=la(r,s.payloadUniqBy,Ta),i=ie(ie({},n),{},{payload:a});return c.isValidElement(s.content)?c.cloneElement(s.content,i):typeof s.content=="function"?c.createElement(s.content,i):c.createElement(it,i)}function Ia(s,r,n,a,i,x){var{layout:g,align:d,verticalAlign:N}=r,j,f;return(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))&&(d==="center"&&g==="vertical"?j={left:((a||0)-x.width)/2}:j=d==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))&&(N==="middle"?f={top:((i||0)-x.height)/2}:f=N==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),ie(ie({},j),f)}function Fa(s){var r=Pt();return c.useEffect(()=>{r(ia(s))},[r,s]),null}function Oa(s){var r=Pt();return c.useEffect(()=>(r(St(s)),()=>{r(St({width:0,height:0}))}),[r,s]),null}function Pa(s){var r=wa(),n=ta(),a=sa(),{width:i,height:x,wrapperStyle:g,portal:d}=s,[N,j]=aa([r]),f=ra(),b=na();if(f==null||b==null)return null;var m=f-(a.left||0)-(a.right||0),p=Fe.getWidthOrHeight(s.layout,x,i,m),B=d?g:ie(ie({position:"absolute",width:(p==null?void 0:p.width)||i||"auto",height:(p==null?void 0:p.height)||x||"auto"},Ia(g,s,a,f,b,N)),g),$=d??n;if($==null)return null;var _=c.createElement("div",{className:"recharts-legend-wrapper",style:B,ref:j},c.createElement(Fa,{layout:s.layout,align:s.align,verticalAlign:s.verticalAlign,itemSorter:s.itemSorter}),c.createElement(Oa,{width:N.width,height:N.height}),c.createElement(Ca,Ge({},s,p,{margin:a,chartWidth:f,chartHeight:b,contextPayload:r})));return Ps.createPortal(_,$)}class Fe extends c.PureComponent{static getWidthOrHeight(r,n,a,i){return r==="vertical"&&ea(n)?{height:n}:r==="horizontal"?{width:a||i}:null}render(){return c.createElement(Pa,this.props)}}ot(Fe,"displayName","Legend");ot(Fe,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});const Ba=()=>{const[s,r]=c.useState("daily_attendance"),n=[{key:"start_date",label:"Start Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]},{key:"end_date",label:"End Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]},{key:"employee_id",label:"Employee ID",type:"text"}],i={daily_attendance:{type:"time_attendance_daily",title:"Daily Attendance Report",description:"Detailed view of employee check-in/out times for a specific date range.",columns:[{key:"EmployeeID",label:"ID"},{key:"EmployeeName",label:"Name"},{key:"AttendanceDate",label:"Date",format:x=>x?new Date(x).toLocaleDateString():"-"},{key:"CheckInTime",label:"Check In"},{key:"CheckOutTime",label:"Check Out"},{key:"TotalHoursWorked",label:"Hours",format:x=>x?Number(x).toFixed(2):"-"},{key:"Status",label:"Status",format:x=>e.jsx(Ze,{variant:x==="Present"?"default":x==="Absent"?"destructive":"secondary",children:x})}],filters:[...n]},monthly_summary:{type:"time_attendance_monthly_summary",title:"Monthly Attendance Summary",description:"Aggregated attendance data per employee for the month.",columns:[{key:"EmployeeName",label:"Name"},{key:"TotalPresent",label:"Days Present"},{key:"TotalAbsent",label:"Days Absent"},{key:"TotalLate",label:"Days Late"},{key:"TotalOvertimeHours",label:"Overtime (Hrs)",format:x=>Number(x).toFixed(2)}],filters:[{key:"month",label:"Month",type:"date",defaultValue:new Date().toISOString().slice(0,7)}]},shift_adherence:{type:"shift_adherence_report",title:"Shift Adherence Report",description:"Comparison of scheduled shift hours vs actual worked hours.",columns:[{key:"EmployeeName",label:"Name"},{key:"ShiftName",label:"Shift"},{key:"PlannedHours",label:"Planned"},{key:"ActualHours",label:"Actual"},{key:"Variance",label:"Variance",format:x=>e.jsx("span",{className:Number(x)<0?"text-red-500":"text-green-500",children:x?Number(x).toFixed(2):"-"})}],filters:[...n]}}[s];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(q,{children:e.jsx(K,{className:"p-4",children:e.jsx(Ot,{value:s,onValueChange:r,className:"w-full",children:e.jsxs(Ws,{className:"grid w-full grid-cols-3",children:[e.jsx(Y,{value:"daily_attendance",children:"Daily Attendance"}),e.jsx(Y,{value:"monthly_summary",children:"Monthly Summary"}),e.jsx(Y,{value:"shift_adherence",children:"Shift Adherence"})]})})})}),e.jsx(zs,{reportType:i.type,title:i.title,description:i.description,columns:i.columns,filterFields:i.filters,disableAutoFetch:!0})]})},_a=Us({name:me().min(1,"Name is required"),description:me().optional(),startTime:me().min(1,"Start time is required"),endTime:me().min(1,"End time is required"),breakMinutes:Ke().min(0).default(60),delayTimeAllowed:Ke().min(0).default(15),overtimeAllow:U().default(!1),overtimeHours:Ke().min(0).default(0),isActive:U().default(!0),monday:U().default(!1),tuesday:U().default(!1),wednesday:U().default(!1),thursday:U().default(!1),friday:U().default(!1),saturday:U().default(!1),sunday:U().default(!1),notes:me().optional()});function Ma({open:s,onOpenChange:r,onSubmit:n,initialData:a,loading:i=!1}){const[x,g]=c.useState(!1);Ct();const d=Vs({resolver:Rs(_a),defaultValues:{name:"",description:"",startTime:"09:00",endTime:"17:00",breakMinutes:60,delayTimeAllowed:15,overtimeAllow:!1,overtimeHours:0,isActive:!0,sunday:!0,monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!1,saturday:!0}});c.useEffect(()=>{if(a){const j=f=>f?f.includes(":")?f.substring(0,5):f:"09:00";d.reset({name:a.name||a.ShiftName||"",description:a.description||a.Description||"",startTime:j(a.startTime||a.CheckInTime),endTime:j(a.endTime||a.CheckOutTime),breakMinutes:a.breakMinutes||a.BreakMinutes||a.breakDuration||60,delayTimeAllowed:a.delayTimeAllowed||a.DelayTimeAllowed||15,overtimeAllow:!!(a.overtimeAllow||a.OvertimeAllow===1||a.OvertimeAllow===!0),overtimeHours:parseFloat(a.overtimeHours||a.OvertimeHours||0),isActive:a.isActive!==void 0?a.isActive:a.Status==="Active"||a.status==="Active"||!0,monday:!!(a.monday||a.Monday),tuesday:!!(a.tuesday||a.Tuesday),wednesday:!!(a.wednesday||a.Wednesday),thursday:!!(a.thursday||a.Thursday),friday:!!(a.friday||a.Friday),saturday:!!(a.saturday||a.Saturday),sunday:!!(a.sunday||a.Sunday),notes:a.notes||a.Notes||""})}else s&&d.reset({name:"",description:"",startTime:"09:00",endTime:"17:00",breakMinutes:60,delayTimeAllowed:15,overtimeAllow:!1,overtimeHours:0,isActive:!0,sunday:!0,monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!1,saturday:!0,notes:""})},[a,s,d]);const N=async j=>{try{g(!0);const f=m=>m?m.split(":").length===2?`${m}:00`:m:"00:00:00",b={...j,startTime:f(j.startTime),endTime:f(j.endTime)};await n(b),r(!1)}catch(f){console.error("Error submitting shift:",f)}finally{g(!1)}};return e.jsx(ue,{open:s,onOpenChange:r,children:e.jsxs(xe,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsx(pe,{children:e.jsx(fe,{className:"text-xl font-bold",children:a?"Edit Shift":"Create New Shift"})}),e.jsxs("form",{onSubmit:d.handleSubmit(N),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Shift Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"name",children:"Shift Name *"}),e.jsx(P,{id:"name",placeholder:"Enter shift name",...d.register("name")}),d.formState.errors.name&&e.jsx("p",{className:"text-sm text-red-500",children:d.formState.errors.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"description",children:"Description"}),e.jsx(P,{id:"description",placeholder:"Enter shift description",...d.register("description")})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Shift Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"startTime",children:"Start Time *"}),e.jsx(P,{id:"startTime",type:"time",...d.register("startTime")}),d.formState.errors.startTime&&e.jsx("p",{className:"text-sm text-red-500",children:d.formState.errors.startTime.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"endTime",children:"End Time *"}),e.jsx(P,{id:"endTime",type:"time",...d.register("endTime")}),d.formState.errors.endTime&&e.jsx("p",{className:"text-sm text-red-500",children:d.formState.errors.endTime.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"breakMinutes",children:"Break Duration (minutes)"}),e.jsx(P,{id:"breakMinutes",type:"text",placeholder:"60",...d.register("breakMinutes",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"delayTimeAllowed",children:"Delay Allowed (minutes)"}),e.jsx(P,{id:"delayTimeAllowed",type:"number",min:"0",...d.register("delayTimeAllowed",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Overtime Settings"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(bt,{id:"overtimeAllow",checked:d.watch("overtimeAllow"),onCheckedChange:j=>d.setValue("overtimeAllow",j)}),e.jsx(A,{htmlFor:"overtimeAllow",children:"Allow Overtime"})]}),d.watch("overtimeAllow")&&e.jsx("div",{className:"mt-2",children:e.jsx(P,{id:"overtimeHours",type:"number",min:"0",step:"0.5",placeholder:"Max overtime hours",...d.register("overtimeHours",{valueAsNumber:!0})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(bt,{id:"isActive",checked:d.watch("isActive"),onCheckedChange:j=>d.setValue("isActive",j)}),e.jsx(A,{htmlFor:"isActive",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Shift Schedule"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{id:"sunday",label:"Sunday"},{id:"monday",label:"Monday"},{id:"tuesday",label:"Tuesday"},{id:"wednesday",label:"Wednesday"},{id:"thursday",label:"Thursday"},{id:"friday",label:"Friday"},{id:"saturday",label:"Saturday"}].map(j=>e.jsxs("div",{className:"flex items-center space-x-2 border p-3 rounded-md",children:[e.jsx("input",{type:"checkbox",id:j.id,...d.register(j.id),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx(A,{htmlFor:j.id,className:"font-medium cursor-pointer",children:j.label})]},j.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"notes",children:"Notes"}),e.jsx(P,{id:"notes",placeholder:"Additional notes",...d.register("notes")})]})]}),e.jsxs(ye,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:x||i,children:"Cancel"}),e.jsx(v,{type:"submit",disabled:x||i,children:x||i?"Saving...":"Save"})]})]})]})})}const Te=({title:s,value:r,subtitle:n="",icon:a,className:i=""})=>e.jsx(q,{className:i,children:e.jsx(K,{className:"p-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s}),e.jsx("h3",{className:"text-2xl font-bold",children:r}),n&&e.jsx("p",{className:"text-xs text-muted-foreground",children:n})]})})});function La({dashboardMetrics:s,loading:r,error:n}){return e.jsxs(q,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Attendance Overview"}),e.jsx(Ce,{children:"Today's attendance statistics and metrics"})]}),e.jsx(K,{children:r.dashboard?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((a,i)=>e.jsx(Ie,{className:"h-32 w-full"},i))}):n.dashboard?e.jsxs(tt,{variant:"destructive",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx(st,{children:"Error"}),e.jsx(at,{children:n.dashboard})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Te,{title:"Total Employees",value:s.totalEmployees,className:"border"}),e.jsx(Te,{title:"Present Today",value:s.presentToday,subtitle:`${s.onTimeToday} on time, ${s.lateToday} late`,className:"border"}),e.jsx(Te,{title:"Absent Today",value:s.absentToday,className:"border"}),e.jsx(Te,{title:"Active Shifts",value:s.activeShifts,subtitle:`${s.totalShifts} total`,className:"border"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(q,{children:[e.jsx(ne,{children:e.jsx(le,{children:"Attendance Status"})}),e.jsx(K,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(oa,{width:"100%",height:"100%",children:e.jsxs(ca,{children:[e.jsx(da,{data:[{name:"Present",value:s.presentToday,color:"#10B981"},{name:"Absent",value:s.absentToday,color:"#EF4444"},{name:"Late",value:s.lateToday,color:"#F59E0B"}],cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:a,percent:i})=>`${a}: ${(i*100).toFixed(0)}%`,children:[{name:"Present",color:"#10B981"},{name:"Absent",color:"#EF4444"},{name:"Late",color:"#F59E0B"}].map((a,i)=>e.jsx(ma,{fill:a.color},`cell-${i}`))}),e.jsx(ha,{formatter:(a,i)=>[a,i]}),e.jsx(Fe,{})]})})})})]}),e.jsxs(q,{children:[e.jsx(ne,{children:e.jsx(le,{children:"Work Hours"})}),e.jsx(K,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Average Hours Worked"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.averageHours.toFixed(1),"h"]})]}),e.jsx(wt,{value:s.averageHours/8*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overtime Today"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.overtimeToday.toFixed(1),"h"]})]}),e.jsx(wt,{value:Math.min(s.overtimeToday*10,100),className:"h-2"})]})]})})]})]})]})})]})}function Ha({shiftsData:s,shiftAssignments:r,totalShifts:n,loading:a,error:i,shiftsPage:x,setShiftsPage:g,pageSize:d,expandedShift:N,setExpandedShift:j,setShowCreateShift:f,handleEditShift:b,handleAssignEmployee:m,handleUnassignEmployee:p,handleDeleteShift:B}){const $=h=>r.filter(w=>w.ShiftID===h&&w.IsActive),_=h=>h?h.substring(0,5):"--:--",J=h=>{const w=[];return h.Sunday&&w.push("Sun"),h.Monday&&w.push("Mon"),h.Tuesday&&w.push("Tue"),h.Wednesday&&w.push("Wed"),h.Thursday&&w.push("Thu"),h.Friday&&w.push("Fri"),h.Saturday&&w.push("Sat"),w.length>0?w.join(", "):"No days"};return e.jsx("div",{className:"space-y-4",children:e.jsxs(q,{children:[e.jsx(ne,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(le,{children:"Shift Management"}),e.jsx(Ce,{children:"View shifts, assign employees, and manage schedules"})]}),e.jsxs(v,{onClick:()=>f(!0),children:[e.jsx(ua,{className:"h-4 w-4 mr-2"}),"Add Shift"]})]})}),e.jsx(K,{children:a.shifts?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((h,w)=>e.jsx(Ie,{className:"h-12 w-full"},w))}):i.shifts?e.jsxs(tt,{variant:"destructive",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx(st,{children:"Error"}),e.jsx(at,{children:i.shifts})]}):s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No shifts found. Create your first shift to get started."}):e.jsxs("div",{className:"space-y-4",children:[s.map(h=>{const w=$(h.ShiftID),Z=N===h.ShiftID;return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 cursor-pointer bg-white",onClick:()=>j(Z?null:h.ShiftID),children:[e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Shift Name"}),e.jsx("p",{className:"font-semibold text-base",children:h.ShiftName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Working Hours"}),e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[e.jsx(Qe,{className:"h-4 w-4"}),h.CheckInTime&&h.CheckOutTime?`${_(h.CheckInTime)} - ${_(h.CheckOutTime)}`:"Not set"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Working Days"}),e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[e.jsx(It,{className:"h-4 w-4"}),J(h)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Assigned Employees"}),e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[e.jsx(vt,{className:"h-4 w-4"}),w.length," employee",w.length!==1?"s":""]})]})]}),e.jsx(Bs,{className:`h-5 w-5 ml-4 transition-transform ${Z?"rotate-180":""}`})]}),Z&&e.jsx("div",{className:"border-t bg-gray-50",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-In Time"}),e.jsx("p",{className:"font-medium",children:_(h.CheckInTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-Out Time"}),e.jsx("p",{className:"font-medium",children:_(h.CheckOutTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Break Duration"}),e.jsxs("p",{className:"font-medium",children:[h.BreakDuration||0," min"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Delay Allowed"}),e.jsxs("p",{className:"font-medium",children:[h.DelayTimeAllowed||0," min"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overtime Allow"}),e.jsx("p",{className:"font-medium",children:h.OvertimeAllow?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overtime Hours"}),e.jsxs("p",{className:"font-medium",children:[h.OvertimeHours||0," hrs"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(Ze,{variant:h.IsActive?"default":"secondary",children:h.IsActive?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Created"}),e.jsx("p",{className:"font-medium text-sm",children:h.CreatedDate?new Date(h.CreatedDate).toLocaleDateString():"N/A"})]})]}),h.Description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx("p",{className:"font-medium text-sm",children:h.Description})]}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Assigned Employees (",w.length,")"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:O=>{O.stopPropagation(),m(h)},className:"gap-2",children:[e.jsx(gt,{className:"h-4 w-4"}),"Assign Employee"]})]}),w.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm bg-white rounded border",children:"No employees assigned to this shift yet"}):e.jsx("div",{className:"space-y-2",children:w.map(O=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(gt,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:O.EmployeeName||`Employee #${O.EmployeeID}`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:O.EmployeeCode||`ID: ${O.EmployeeID}`})]})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>p(h.ShiftID,O.EmployeeID),className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(_s,{className:"h-4 w-4"})})]},O.ShiftEmployeesID))})]}),e.jsxs("div",{className:"flex space-x-2 pt-4 border-t",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:O=>{O.stopPropagation(),b(h)},children:[e.jsx(rt,{className:"h-4 w-4 mr-2"}),"Edit Shift"]}),e.jsxs(v,{variant:"outline",size:"sm",className:"text-red-500 hover:text-red-600 hover:bg-red-50",onClick:O=>{O.stopPropagation(),B(h.ShiftID.toString())},children:[e.jsx(nt,{className:"h-4 w-4 mr-2"}),"Delete Shift"]})]})]})})]},h.ShiftID)}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min((x-1)*d+1,s.length)})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(x*d,s.length)})," ","of ",e.jsx("span",{className:"font-medium",children:s.length})," shifts"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>g(h=>Math.max(1,h-1)),disabled:x===1||a.shifts,children:"Previous"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>g(h=>h+1),disabled:x*d>=s.length||a.shifts,children:"Next"})]})]})]})})]})})}function $a({className:s,date:r,onDateChange:n,placeholder:a="Pick a date"}){return e.jsx("div",{className:Nt("grid gap-2",s),children:e.jsxs(xa,{children:[e.jsx(pa,{asChild:!0,children:e.jsxs(v,{id:"date",variant:"outline",className:Nt("w-[300px] justify-start text-left font-normal",!r&&"text-muted-foreground"),children:[e.jsx(It,{className:"mr-2 h-4 w-4"}),r!=null&&r.from?r.to?e.jsxs(e.Fragment,{children:[V(r.from,"LLL dd, y")," -"," ",V(r.to,"LLL dd, y")]}):V(r.from,"LLL dd, y"):e.jsx("span",{children:a})]})}),e.jsx(fa,{className:"w-auto p-0",align:"start",children:e.jsx(ya,{initialFocus:!0,mode:"range",defaultMonth:r==null?void 0:r.from,selected:r,onSelect:n,numberOfMonths:2})})]})})}function za({attendanceData:s,loading:r,error:n,dateRange:a,setDateRange:i,searchText:x,setSearchText:g,currentPage:d,setCurrentPage:N,pageSize:j,totalRows:f,handleEditAttendance:b,handleDeleteAttendance:m}){return e.jsxs(q,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Attendance Tracking"}),e.jsx(Ce,{children:"Daily attendance records and management"})]}),e.jsx(K,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(A,{htmlFor:"search",children:"Search Employees"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(Ft,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(P,{id:"search",placeholder:"Search by name or employee ID...",value:x,onChange:p=>g(p.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(A,{children:"Date Range"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-2",children:[e.jsx($a,{date:a,onDateChange:i,placeholder:"Select date range"}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>i({from:new Date,to:new Date}),children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Today"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>i({from:Bt(new Date,7),to:new Date}),children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Last 7 Days"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{const p=new Date;i({from:new Date(p.getFullYear(),p.getMonth(),1),to:p})},children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"This Month"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),"Geofencing"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(va,{className:"h-4 w-4 mr-2"}),"Biometric"]})]})]})]}),r.attendance?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((p,B)=>e.jsx(Ie,{className:"h-12 w-full"},B))}):n.attendance?e.jsxs(tt,{variant:"destructive",children:[e.jsx(et,{className:"h-4 w-4"}),e.jsx(st,{children:"Error"}),e.jsx(at,{children:n.attendance})]}):s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No attendance records found."}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(_t,{children:[e.jsx(Mt,{children:e.jsxs(je,{children:[e.jsx(F,{children:"Employee ID"}),e.jsx(F,{children:"Employee Name"}),e.jsx(F,{className:"w-[200px]",children:"Attendance Date"}),e.jsx(F,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(Lt,{children:s.map(p=>e.jsxs(je,{className:"h-12",children:[e.jsx(I,{className:"font-medium",children:p.EmployeeID}),e.jsx(I,{children:p.EmployeeName||`${p.employees_FirstName} ${p.employees_LastName}`}),e.jsx(I,{children:p.AttendanceDate?V(new Date(p.AttendanceDate),"MMM d, yyyy h:mm a"):"-"}),e.jsx(I,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>b(p),className:"h-8 w-8 p-0",children:e.jsx(rt,{className:"h-4 w-4"})}),e.jsx(v,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600",onClick:()=>m(p.AttendanceID.toString()),children:e.jsx(nt,{className:"h-4 w-4"})})]})})]},p.AttendanceID))})]}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min((d-1)*j+1,f)})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(d*j,f)})," ","of ",e.jsx("span",{className:"font-medium",children:f})," records"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>N(p=>Math.max(1,p-1)),disabled:d===1||r.attendance,children:"Previous"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>N(p=>p+1),disabled:d*j>=f||r.attendance,children:"Next"})]})]})]})})]})})]})}function Wa({shiftBookData:s,totalShiftBookRecords:r,loading:n,error:a,searchText:i,setSearchText:x,shiftBookPage:g,setShiftBookPage:d,pageSize:N,handleEditShiftBook:j,handleDeleteShiftBook:f,getStatusVariant:b}){return e.jsxs(q,{children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Shift Records"}),e.jsx(Ce,{children:"Detailed shift booking and attendance records"})]}),e.jsxs(K,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(A,{htmlFor:"search",children:"Search Records"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ft,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(P,{id:"search",placeholder:"Search by employee name or shift...",value:i,onChange:m=>x(m.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs(v,{variant:"outline",children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),n.shiftBook?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((m,p)=>e.jsx(Ie,{className:"h-12 w-full"},p))}):e.jsxs(_t,{children:[e.jsx(Mt,{children:e.jsxs(je,{children:[e.jsx(F,{children:"Employee ID"}),e.jsx(F,{children:"Shift ID"}),e.jsx(F,{children:"Date"}),e.jsx(F,{children:"Check-In"}),e.jsx(F,{children:"Check-Out"}),e.jsx(F,{children:"Total Hours"}),e.jsx(F,{children:"Overtime"}),e.jsx(F,{children:"Absent"}),e.jsx(F,{children:"Delay"}),e.jsx(F,{children:"Leave"}),e.jsx(F,{children:"Status"}),e.jsx(F,{children:"Notes"}),e.jsx(F,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(Lt,{children:s.length>0?s.map(m=>e.jsxs(je,{children:[e.jsx(I,{children:m.EmployeeID}),e.jsx(I,{children:m.ShiftBookID}),e.jsx(I,{children:m.ShiftBookDate}),e.jsx(I,{children:m.CheckInTime||"-"}),e.jsx(I,{children:m.CheckOutTime||"-"}),e.jsx(I,{children:m.TotalHoursWorked||"-"}),e.jsx(I,{children:m.OvertimeHours||"-"}),e.jsx(I,{children:m.Absent?e.jsx(At,{className:"h-4 w-4 text-red-500"}):e.jsx(kt,{className:"h-4 w-4 text-gray-300"})}),e.jsx(I,{children:m.DelayHours||"-"}),e.jsx(I,{children:m.Leave?e.jsx(At,{className:"h-4 w-4 text-green-500"}):e.jsx(kt,{className:"h-4 w-4 text-gray-300"})}),e.jsx(I,{children:e.jsx(Ze,{variant:b(m.Status||""),children:m.Status})}),e.jsx(I,{className:"max-w-[200px] truncate",children:m.Notes||"-"}),e.jsx(I,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>j(m),className:"h-8 w-8 p-0",children:e.jsx(rt,{className:"h-4 w-4"})}),e.jsx(v,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600",onClick:()=>{var p;return f(m.key||((p=m.ShiftBookID)==null?void 0:p.toString())||`${m.EmployeeID}-${m.ShiftBookDate}`)},children:e.jsx(nt,{className:"h-4 w-4"})})]})})]},m.key||m.ShiftBookID||`${m.EmployeeID}-${m.ShiftBookDate}`)):e.jsx(je,{children:e.jsx(I,{colSpan:13,className:"h-24 text-center",children:n.shiftBook?"Loading shift book data...":"No shift book records found"})})})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:s.length>0?e.jsxs(e.Fragment,{children:["Showing ",e.jsx("span",{className:"font-medium",children:(g-1)*N+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(g*N,r)})," ","of ",e.jsx("span",{className:"font-medium",children:r})," records"]}):"No records found"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>d(m=>Math.max(1,m-1)),disabled:g===1||n.shiftBook,children:"Previous"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>d(m=>m+1),disabled:g*N>=r||n.shiftBook,children:"Next"})]})]})]})]})}const Ar=()=>{c.useRef(null);const{tab:s}=Ls(),r=Hs(),n=s||"dashboard",{toast:a}=Ct(),{t:i}=$s(),[x,g]=c.useState(!1),[d,N]=c.useState(null),[j,f]=c.useState(!1),[b,m]=c.useState(null),[p,B]=c.useState(""),[$,_]=c.useState(""),[J,h]=c.useState([]),[w,Z]=c.useState(!1),[O,Q]=c.useState(""),[Ht,ve]=c.useState(0),[Oe,Pe]=c.useState(!0),[Be,ct]=c.useState(!1),[$t,ge]=c.useState(!1),[Ua,zt]=c.useState(!1),[Wt,_e]=c.useState(!1),[Ut,Ne]=c.useState(!1),[dt,Me]=c.useState(null),[mt,ht]=c.useState(!1),[X,Le]=c.useState([]),[Vt,He]=c.useState(!1),[z,ut]=c.useState(""),[D,Rt]=c.useState({from:Bt(new Date,7),to:new Date}),[be,Yt]=c.useState(1),[$e,qt]=c.useState(1),[ze,Kt]=c.useState(1),[ee]=c.useState(10),[Jt,Qt]=c.useState(0),[we,k]=c.useState({attendance:!1,shifts:!1,shiftBook:!1,dashboard:!1}),[Se,M]=c.useState({attendance:null,shifts:null,shiftBook:null,dashboard:null}),[Xt,Gt]=c.useState({totalEmployees:0,presentToday:0,absentToday:0,lateToday:0,onTimeToday:0,overtimeToday:0,averageHours:0,totalShifts:0,activeShifts:0}),[Zt,es]=c.useState([]),[ts,ss]=c.useState(0),[as,rs]=c.useState(null),[We,ns]=c.useState([]),[ls,is]=c.useState([]),[E,te]=c.useState(null),[os,xt]=c.useState([]),[cs,pt]=c.useState(0),ft=async()=>{k(t=>({...t,dashboard:!0})),M(t=>({...t,dashboard:null}));try{const t=he().format("YYYY-MM-DD"),[o,l,u]=await Promise.all([C.timeattendance.list({startDate:t,endDate:t,page:0,pageSize:1e3}),C.employees.list({select_fields:"EmployeeID,employees_FirstName,employees_LastName",filters:JSON.stringify({EmploymentStatus:"Active"})}),C.shifts.list({})]),S=(Array.isArray(l==null?void 0:l.data)?l.data:[]).length,L=Array.isArray(o==null?void 0:o.data)?o.data:[],G=new Set(L.filter(T=>T&&(T.Status==="Present"||T.Status==="Late")&&T.EmployeeID).map(T=>T.EmployeeID)).size,W=Math.max(0,S-G),De=L.filter(T=>T&&T.Status==="Late").length,ae=Math.max(0,G-De),{totalOvertime:re,totalHoursWorked:R}=L.reduce((T,oe)=>oe?{totalOvertime:T.totalOvertime+(Number(oe.OvertimeMinutes)||0)/60,totalHoursWorked:T.totalHoursWorked+(Number(oe.TotalMinutesWorked)||0)/60}:T,{totalOvertime:0,totalHoursWorked:0}),Re=G>0?R/G:0,Ee=Array.isArray(u==null?void 0:u.data)?u.data:[],Ye=Ee.filter(T=>T&&T.Status==="Active").length;Gt({totalEmployees:S,presentToday:G,absentToday:W,lateToday:De,onTimeToday:ae,overtimeToday:parseFloat(re.toFixed(2)),averageHours:parseFloat(Re.toFixed(2)),totalShifts:Ee.length,activeShifts:Ye})}catch(t){console.error("Error fetching dashboard metrics:",t),M(o=>({...o,dashboard:t instanceof Error?t.message:"Failed to fetch dashboard metrics."}))}finally{k(t=>({...t,dashboard:!1}))}},Ae=async()=>{if(n==="shifts"){k(t=>({...t,shifts:!0})),M(t=>({...t,shifts:null}));try{const t=await C.shifts.list({page:$e-1,pageSize:ee,field:"ShiftName",sort:"ASC"}),o=(t.data||[]).map(l=>{const u=[];l.monday&&u.push("Mon"),l.tuesday&&u.push("Tue"),l.wednesday&&u.push("Wed"),l.thursday&&u.push("Thu"),l.friday&&u.push("Fri"),l.saturday&&u.push("Sat"),l.sunday&&u.push("Sun");const y=S=>S?he(S,"HH:mm:ss").format("h:mm A"):"--";return{...l,workingDays:u.length>0?u.join(", "):"--",formattedTime:l.startTime&&l.endTime?`${y(l.startTime)} - ${y(l.endTime)}`:"--",delayTime:l.delayTimeAllowed?`${l.delayTimeAllowed} min`:"--",ShiftID:l.id,ShiftName:l.name,CheckInTime:l.startTime,CheckOutTime:l.endTime,BreakDuration:l.breakMinutes,DelayTimeAllowed:l.delayTimeAllowed,OvertimeAllow:l.overtimeAllow,OvertimeHours:l.overtimeHours,Status:l.isActive?"Active":"Inactive",CreatedDate:l.createdAt,Description:l.description,IsActive:l.isActive,Sunday:l.sunday,Monday:l.monday,Tuesday:l.tuesday,Wednesday:l.wednesday,Thursday:l.thursday,Friday:l.friday,Saturday:l.saturday}});es(o),ss(t.total||0),await Ue()}catch(t){M(o=>({...o,shifts:t instanceof Error?t.message:"Failed to fetch shifts"}))}finally{k(t=>({...t,shifts:!1}))}}},Ue=async()=>{try{const o=((await C.shiftEmployees.list({pageSize:1e3})).data||[]).map(l=>({...l,ShiftEmployeesID:l.ShiftEmployeesID,ShiftID:l.ShiftID,EmployeeID:l.EmployeeID,EmployeeName:l.employees_FirstName&&l.employees_LastName?`${l.employees_FirstName} ${l.employees_LastName}`:void 0,EmployeeCode:l.employees_EmployeeCode,IsActive:l.IsActive!==!1,Notes:l.Notes}));ns(o)}catch(t){console.error("Error fetching shift assignments:",t)}},se=async()=>{if(n==="attendance"){k(t=>({...t,attendance:!0})),M(t=>({...t,attendance:null}));try{const t={page:be-1,pageSize:ee,field:"AttendanceDate",sort:"ASC",select_fields:"AttendanceID,EmployeeID,AttendanceDate,employees_FirstName,employees_LastName"};if(z){const y=parseInt(z,10);isNaN(y)?(t.search=z,t.searchFields="EmployeeID,employees_FirstName,employees_LastName"):t.exact_filters=JSON.stringify({EmployeeID:y})}if(D!=null&&D.from&&(D!=null&&D.to)){const y=new Date(D.to);y.setHours(23,59,59,999),t.advanced_filters=JSON.stringify([{column:"AttendanceDate",filter_type:"greater_equals",value:V(D.from,"yyyy-MM-dd")},{column:"AttendanceDate",filter_type:"less_equals",value:V(y,"yyyy-MM-dd HH:mm:ss.SSS")}])}const o=await C.timeattendance.list(t),u=((o==null?void 0:o.data)||[]).map(y=>({...y,EmployeeName:`${y.employees_FirstName||""} ${y.employees_LastName||""}`.trim(),AttendanceDate:he(y.AttendanceDate).isValid()?he(y.AttendanceDate).format("MMM D, YYYY h:mm A"):"N/A"}));is(u),Qt((o==null?void 0:o.total)||0)}catch(t){M(o=>({...o,attendance:t instanceof Error?t.message:"Failed to fetch attendance data"}))}finally{k(t=>({...t,attendance:!1}))}}},Ve=async()=>{k(t=>({...t,shiftBook:!0})),M(t=>({...t,shiftBook:null}));try{const t=D!=null&&D.from?V(D.from,"yyyy-MM-dd"):void 0,o=D!=null&&D.to?V(D.to,"yyyy-MM-dd"):void 0,l={page:ze-1,pageSize:ee,field:"ShiftBookDate",sort:"ASC",select_fields:"ShiftBookID,EmployeeID,ShiftID,ShiftBookDate,CheckInTime,CheckOutTime,TotalHoursWorked,OvertimeHours,AbsentHours,DelayHours,LeaveHours,Status,Notes,employees_FirstName,employees_LastName"};if(t&&o&&(l.advanced_filters=JSON.stringify([{column:"ShiftBookDate",filter_type:"greater_equals",value:t},{column:"ShiftBookDate",filter_type:"less_equals",value:o}])),z){const y=parseInt(z,10);isNaN(y)?(l.search=z,l.searchFields="EmployeeID,employees_FirstName,employees_LastName"):l.exact_filters=JSON.stringify({EmployeeID:y})}const u=await C.shiftBook.list(l);if(u&&Array.isArray(u.data)){const y=u.data.map(S=>{var L;return{...S,key:((L=S.ShiftBookID)==null?void 0:L.toString())||`${S.EmployeeID}-${S.ShiftBookDate}`,EmployeeName:S.employees_FirstName?`${S.employees_FirstName} ${S.employees_LastName||""}`.trim():`Employee ${S.EmployeeID}`}});xt(y),pt(u.total!==void 0?u.total:u.data.length)}else xt([]),pt(0)}catch{M(o=>({...o,shiftBook:"Failed to load shift book records."}))}finally{k(t=>({...t,shiftBook:!1}))}},ds=async t=>{try{k(l=>({...l,shifts:!0}));const o=await C.shifts.create(t);return await Ae(),a({title:i("common.success"),description:i("timeAttendance.shiftCreated")}),o}catch(o){throw a({title:i("common.error"),description:i("timeAttendance.shiftCreateFailed"),variant:"destructive"}),o}finally{k(o=>({...o,shifts:!1}))}},ms=async(t,o)=>{try{k(u=>({...u,shifts:!0}));const l=await C.shifts.update(t,o);return await Ae(),a({title:i("common.success"),description:i("timeAttendance.shiftUpdated")}),l}catch(l){throw a({title:i("common.error"),description:i("timeAttendance.shiftUpdateFailed"),variant:"destructive"}),l}finally{k(l=>({...l,shifts:!1}))}},hs=async t=>{try{d?await ms(d.ShiftID,t):await ds(t),g(!1),N(null)}catch(o){console.error("Error submitting shift:",o)}},us=t=>{N(t),g(!0)},xs=async t=>{var l,u;const o=We.filter(y=>y.ShiftID===parseInt(t)&&y.IsActive);if(o.length>0){a({title:i("timeAttendance.cannotDeleteShift"),description:i("timeAttendance.shiftHasEmployees",{count:o.length}),variant:"destructive"});return}if(window.confirm(i("timeAttendance.confirmDeleteShift")))try{k(y=>({...y,shifts:!0})),await C.shifts.delete(t),a({title:i("common.success"),description:i("timeAttendance.shiftDeleted")}),await Ae()}catch(y){const S=((u=(l=y==null?void 0:y.response)==null?void 0:l.data)==null?void 0:u.detail)||(y==null?void 0:y.message)||i("timeAttendance.shiftDeleteFailed");a({title:i("common.error"),description:S,variant:"destructive"})}finally{k(y=>({...y,shifts:!1}))}},ke=async(t=0,o="",l=!1)=>{try{t===0||l?Z(!0):ct(!0);const u={page:t,pageSize:10,select_fields:"EmployeeID,FirstName,LastName,EmployeeCode,Email",sort:"FirstName",sortOrder:"asc"};o&&(u.search=o,u.searchFields="FirstName,LastName,EmployeeCode,Email");const S=(await C.employees.list(u)).data||[];l||t===0?(h(S),ve(0)):h(L=>[...L,...S]),Pe(S.length===10)}catch{a({title:i("common.error"),description:i("timeAttendance.loadEmployeesFailed"),variant:"destructive"})}finally{Z(!1),ct(!1)}},ps=t=>{m(t),f(!0),B(""),_(""),Q(""),ve(0),Pe(!0),ke(0,"",!0)},fs=async()=>{if(!(!p||!b))try{await C.shiftEmployees.create({EmployeeID:parseInt(p),ShiftID:b.ShiftID,Notes:null}),a({title:i("common.success"),description:i("timeAttendance.employeeAssigned")}),f(!1),m(null),B(""),_(""),Q(""),await Ue()}catch{a({title:i("common.error"),description:i("timeAttendance.assignFailed"),variant:"destructive"})}},ys=async(t,o)=>{if(window.confirm(i("timeAttendance.confirmUnassign")))try{const l=We.find(u=>u.ShiftID===t&&u.EmployeeID===o);l&&(await C.shiftEmployees.delete(l.ShiftEmployeesID),a({title:i("common.success"),description:i("timeAttendance.employeeUnassigned")}),await Ue())}catch{a({title:i("common.error"),description:i("timeAttendance.unassignFailed"),variant:"destructive"})}},js=()=>{if(!Be&&Oe){const t=Ht+1;ve(t),ke(t,O,!1)}},vs=t=>{Q(t),ve(0),Pe(!0),ke(0,t,!0)},gs=t=>{var l;const o=(l=t.target.files)==null?void 0:l[0];o&&(Me(o),Ns(o))},Ns=t=>{const o=new FileReader;o.onload=l=>{var u,y;try{const L=((u=l.target)==null?void 0:u.result).split(`
`).filter(W=>W.trim()),G=((y=L[0])!=null&&y.includes("EmployeeID")?L.slice(1):L).map((W,De)=>{const ae=W.includes("	")?W.split("	").map(R=>R.trim()):W.split(",").map(R=>R.trim());let re=ae[1]||"";if(re){const R=re.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})\s*(AM|PM)/i);if(R){const[,Re,Ee,Ye,T,oe,Is,jt]=R;let ce=parseInt(T,10);jt.toUpperCase()==="PM"&&ce!==12?ce+=12:jt.toUpperCase()==="AM"&&ce===12&&(ce=0),re=`${Ye}-${Re.padStart(2,"0")}-${Ee.padStart(2,"0")} ${ce.toString().padStart(2,"0")}:${oe}:${Is}`}}return{id:De+1,EmployeeID:ae[0]||"",AttendanceDate:re,valid:ae[0]&&ae[1]}}).filter(W=>W.valid);Le(G),He(!0)}catch{a({title:i("timeAttendance.parseError"),description:i("timeAttendance.parseErrorDesc"),variant:"destructive"})}},o.readAsText(t)},bs=async()=>{if(X.length===0){a({title:i("common.noData"),description:i("timeAttendance.noValidRecords"),variant:"destructive"});return}ht(!0);try{const t=X.map(o=>({EmployeeID:parseInt(o.EmployeeID,10),AttendanceDate:o.AttendanceDate}));await C.directBulkAdd.timeAttendance(t),a({title:i("timeAttendance.importSuccess"),description:i("timeAttendance.importSuccessDesc",{count:t.length})}),Ne(!1),Me(null),Le([]),He(!1),n==="attendance"?await se():n==="shiftbook"&&await Ve()}catch{a({title:i("timeAttendance.importFailed"),description:i("timeAttendance.importFailedDesc"),variant:"destructive"})}finally{ht(!1)}},yt=()=>{const t=`EmployeeID	AttendanceDate
1	2024-10-01 08:48:00
1	2024-10-01 18:46:00`,o=new Blob([t],{type:"text/csv"}),l=window.URL.createObjectURL(o),u=document.createElement("a");u.href=l,u.download="attendance_import_template.csv",document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(l)},ws=t=>{const o=t.target,{scrollTop:l,scrollHeight:u,clientHeight:y}=o;u-l<=y+100&&Oe&&!Be&&js()},Ss=async t=>{try{const o=await C.timeattendance.list({rowID:t.AttendanceID,pageSize:1});if(o.data&&o.data.length>0){const l=o.data[0];te({AttendanceID:l.AttendanceID,EmployeeID:l.EmployeeID,EmployeeName:l.employees_FirstName+" "+l.employees_LastName,AttendanceDate:l.AttendanceDate,originalDate:l.AttendanceDate}),ge(!0)}}catch{M(l=>({...l,attendance:"Failed to load attendance record for editing."}))}},As=async t=>{try{k(o=>({...o,attendance:!0})),E&&E.AttendanceID&&await C.timeattendance.update(E.AttendanceID,{AttendanceDate:t.AttendanceDate}),await se(),ge(!1),te(null)}catch{M(l=>({...l,attendance:"Failed to update attendance date."}))}finally{k(o=>({...o,attendance:!1}))}},ks=async t=>{if(window.confirm("Are you sure you want to delete this attendance record?"))try{k(o=>({...o,attendance:!0})),await C.timeattendance.delete(t),await se()}catch{M(l=>({...l,attendance:"Failed to delete attendance record."}))}finally{k(o=>({...o,attendance:!1}))}},Ds=async t=>{te(t),zt(!0)},Es=async t=>{if(window.confirm("Are you sure you want to delete this shift book record?"))try{k(o=>({...o,shiftBook:!0})),await C.shiftBook.delete(t),await Ve()}catch{M(l=>({...l,shiftBook:"Failed to delete shift book record."}))}finally{k(o=>({...o,shiftBook:!1}))}},Ts=t=>{switch(t==null?void 0:t.toLowerCase()){case"present":return"default";case"absent":return"destructive";case"late":return"secondary";case"on leave":return"outline";default:return"outline"}};return c.useEffect(()=>{(async()=>{switch(n){case"dashboard":await ft();break;case"shifts":await Ae();break;case"attendance":await se();break;case"shiftBook":await Ve();break}})()},[n,be,$e,ze,D]),c.useEffect(()=>{n==="dashboard"?ft():n==="attendance"&&se()},[]),c.useEffect(()=>{const t=setTimeout(()=>{n==="attendance"&&se()},500);return()=>clearTimeout(t)},[z,be]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto max-w-7xl px-4 space-y-6",children:[e.jsxs(Ot,{value:n,onValueChange:t=>r(`/time_attendance/${t}`),className:"space-y-4",children:[e.jsxs(Ys,{className:"md:grid md:grid-cols-5",children:[e.jsx(Y,{value:"dashboard",children:"Dashboard"}),e.jsx(Y,{value:"attendance",children:"TimeAttendance"}),e.jsx(Y,{value:"shiftBook",children:"ShiftBook"}),e.jsx(Y,{value:"shifts",children:"Shifts"}),e.jsx(Y,{value:"reports",children:"Reports"})]}),e.jsx(de,{value:"dashboard",className:"space-y-4",children:e.jsx(La,{dashboardMetrics:Xt,loading:we,error:Se})}),e.jsx(de,{value:"shifts",className:"space-y-4",children:e.jsx(Ha,{shiftsData:Zt,shiftAssignments:We,totalShifts:ts,loading:we,error:Se,shiftsPage:$e,setShiftsPage:qt,pageSize:ee,expandedShift:as,setExpandedShift:rs,setShowCreateShift:g,handleEditShift:us,handleAssignEmployee:ps,handleUnassignEmployee:ys,handleDeleteShift:xs})}),e.jsxs(de,{value:"attendance",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Time Attendance Records"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{onClick:()=>_e(!0),size:"sm",className:"gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Check In/Out"]}),e.jsxs(v,{onClick:yt,variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Dt,{className:"h-4 w-4"}),"Download Template"]}),e.jsxs(v,{onClick:()=>Ne(!0),size:"sm",className:"gap-2",children:[e.jsx(Je,{className:"h-4 w-4"}),"Bulk Import"]})]})]}),e.jsx(za,{attendanceData:ls,loading:we,error:Se,dateRange:D,setDateRange:Rt,searchText:z,setSearchText:ut,currentPage:be,setCurrentPage:Yt,pageSize:ee,totalRows:Jt,handleEditAttendance:Ss,handleDeleteAttendance:ks})]}),e.jsx(de,{value:"shiftBook",className:"space-y-4",children:e.jsx(Wa,{shiftBookData:os,totalShiftBookRecords:cs,loading:we,error:Se,searchText:z,setSearchText:ut,shiftBookPage:ze,setShiftBookPage:Kt,pageSize:ee,handleEditShiftBook:Ds,handleDeleteShiftBook:Es,getStatusVariant:Ts})}),e.jsx(de,{value:"reports",className:"space-y-4",children:e.jsx(Ba,{})})]}),e.jsx(ue,{open:$t,onOpenChange:t=>{ge(t),t||te(null)},children:e.jsxs(xe,{className:"sm:max-w-[500px]",children:[e.jsx(pe,{children:e.jsx(fe,{children:"Edit Attendance Date"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"employee",children:"Employee"}),e.jsx(P,{id:"employee",value:(E==null?void 0:E.EmployeeName)||"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"currentDate",children:"Current Date"}),e.jsx(P,{id:"currentDate",value:E!=null&&E.originalDate?V(new Date(E.originalDate),"MMM d, yyyy h:mm a"):"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"attendanceDate",children:"New Attendance Date & Time *"}),e.jsx(qs,{value:E!=null&&E.AttendanceDate?he(E.AttendanceDate):null,onChange:t=>te(o=>({...o,AttendanceDate:t?t.format("YYYY-MM-DD HH:mm:ss"):null})),showTime:!0,placeholder:"Select new date and time",className:"w-full"})]})]}),e.jsxs(ye,{children:[e.jsx(v,{variant:"outline",onClick:()=>{ge(!1),te(null)},children:"Cancel"}),e.jsx(v,{onClick:()=>As(E),disabled:!(E!=null&&E.AttendanceDate),children:"Update Date"})]})]})}),e.jsx(Ma,{open:x,onOpenChange:t=>{g(t),t||N(null)},onSubmit:hs,initialData:d}),e.jsx(ue,{open:j,onOpenChange:t=>{f(t),t||(m(null),B(""),_(""),Q(""))},children:e.jsxs(xe,{className:"sm:max-w-[500px]",children:[e.jsx(pe,{children:e.jsx(fe,{children:"Assign Employee to Shift"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"shiftInfo",children:"Shift"}),e.jsx(P,{id:"shiftInfo",value:b?`${b.ShiftName} (${b.CheckInTime} - ${b.CheckOutTime})`:"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(A,{htmlFor:"employee",children:"Select Employee *"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{id:"employee",placeholder:"Search employees...",value:p?$:O,onChange:t=>vs(t.target.value),onFocus:()=>{p&&(B(""),_(""),Q(""),ke(0,"",!0))},className:"mb-2"}),J.length>0&&O&&e.jsx("div",{className:"absolute z-50 w-full bg-white border rounded-md shadow-lg max-h-[300px] overflow-y-auto",onScroll:ws,children:w&&J.length===0?e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading employees..."}):J.length===0?e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No employees found"}):e.jsxs(e.Fragment,{children:[J.map(t=>e.jsxs("div",{onClick:()=>{B(t.EmployeeID.toString()),_(`${t.FirstName} ${t.LastName||""}`.trim()),Q(""),h([])},className:`p-3 cursor-pointer hover:bg-muted transition-colors ${p===t.EmployeeID.toString()?"bg-muted":""}`,children:[e.jsx("div",{className:"font-medium text-sm",children:`${t.FirstName} ${t.LastName||""}`.trim()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.EmployeeCode})]},t.EmployeeID)),Be&&e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading more employees..."}),!Oe&&J.length>0&&e.jsx("div",{className:"p-4 text-center text-muted-foreground text-sm",children:"All employees loaded"})]})})]})]})]}),e.jsxs(ye,{children:[e.jsx(v,{variant:"outline",onClick:()=>{f(!1),m(null),B(""),Q("")},children:"Cancel"}),e.jsx(v,{onClick:fs,disabled:!p||w,children:"Add Employee"})]})]})}),e.jsx(ue,{open:Ut,onOpenChange:t=>{Ne(t),t||(Me(null),Le([]),He(!1))},children:e.jsxs(xe,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsx(pe,{children:e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Bulk Import Attendance Records"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Step 1: Download Template"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Download the CSV template file and fill it with your attendance data."}),e.jsxs(v,{onClick:yt,variant:"outline",className:"w-full gap-2",children:[e.jsx(Dt,{className:"h-4 w-4"}),"Download CSV Template"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Step 2: Upload File"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(A,{htmlFor:"file-upload",className:"text-sm font-medium",children:"Upload CSV File"}),e.jsx(P,{id:"file-upload",type:"file",accept:".csv",onChange:gs,className:"cursor-pointer"})]}),dt&&e.jsxs("p",{className:"text-sm text-green-600",children:["Selected: ",dt.name]})]})]}),Vt&&X.length>0&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Step 3: Preview Data"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first ",X.length," records"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border rounded-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Row"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"EmployeeID"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Date"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Check In"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Check Out"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Status"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Notes"})]})}),e.jsx("tbody",{children:X.map((t,o)=>e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-2 text-sm",children:t.id}),e.jsx("td",{className:"border p-2 text-sm",children:t.EmployeeID}),e.jsx("td",{className:"border p-2 text-sm",children:t.AttendanceDate}),e.jsx("td",{className:"border p-2 text-sm",children:t.CheckInTime}),e.jsx("td",{className:"border p-2 text-sm",children:t.CheckOutTime}),e.jsx("td",{className:"border p-2 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.Status==="Present"?"bg-green-100 text-green-800":t.Status==="Late"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.Status})}),e.jsx("td",{className:"border p-2 text-sm",children:t.Notes})]},t.id))})]})})]})]}),e.jsxs(ye,{className:"flex justify-between",children:[e.jsx(v,{variant:"outline",onClick:()=>Ne(!1),children:"Cancel"}),e.jsx(v,{onClick:bs,disabled:mt||X.length===0,className:"gap-2",children:mt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-r-2 border-t-2 border-gray-300 border-t-transparent"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-4 w-4"}),"Import ",X.length," Records"]})})]})]})}),e.jsx(ue,{open:Wt,onOpenChange:_e,children:e.jsxs(xe,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(pe,{children:e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),"Check In / Check Out"]})}),e.jsx("div",{className:"py-4",children:e.jsx(Ks,{})}),e.jsx(ye,{children:e.jsx(v,{variant:"outline",onClick:()=>_e(!1),children:"Close"})})]})})]})})};export{Ar as default};
