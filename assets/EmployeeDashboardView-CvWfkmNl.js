import{l as We,o as ue,r as n,j as e,P as je,C as W,g as _,B as x,$ as ns,d as X,k as _e,a0 as Ws,x as _s,y as Vs,E as Js,I as zs,u as Bs,n as Ee,a1 as ds,c as Ie,e as Y,U as cs,Q as $e,W as Us,a2 as $s,f as me,b as os,a3 as qs,a4 as Rs,F as Oe,h as pe,S as ms,A as Ze,z as es,J as hs,a5 as Gs,a6 as Ys,V as Fe,a as S,_ as M,q as Ks,i as Qs,a7 as Xs}from"./index-Bt_qYF7e.js";import{T as Ge,a as Ye,b as te,c as le}from"./tabs-nV_fVNZu.js";import{T as xs,a as ps,b as Se,c as re,d as us,e as ae}from"./table-CZIP08Oi.js";import{S as he}from"./skeleton-B5IxJdik.js";import{I as H}from"./input-Cs0r3c1h.js";import{P as Zs}from"./progress-i6MmBLCQ.js";import{S as ge,a as fe,b as ye,c as Ne,d as G}from"./select-AiO2ANK_.js";import{D as ie,a as ne,b as de,c as ce,f as ea,d as oe}from"./dialog-CWEZULTY.js";import{C as ss}from"./checkbox-T_0lB5pP.js";import{u as sa,U as as}from"./use-mobile-BN6CWD15.js";import{P as aa,a as ta,b as ze,c as la,d as ra}from"./pagination-Clu0VgO8.js";import{E as ia}from"./ellipsis-mRtKJbvV.js";import{E as qe}from"./EmployeeDropdown-DI7Wva_F.js";import{C as we}from"./date-picker-CRhZKckn.js";import{R as ts}from"./ReportViewer-BdI0b9Cd.js";import{o as na,s as ee,l as ls,d as rs,u as da,t as ca}from"./types-CD2kk4bq.js";import{a as He}from"./api-BYTcMetT.js";import{L as R}from"./label-CTvvvVeK.js";import{P as js,b as gs,c as fs,C as ys}from"./popover-VONLzH8b.js";import{L as Re}from"./loader-circle-d-5q11Hx.js";import{p as Ns}from"./parse-DnujH2BM.js";import{L as oa}from"./layout-grid-CR2x5hwh.js";import{P as Ce}from"./plus-De3WeMOg.js";import{E as ma}from"./eye-DRNexzEP.js";import{S as Me}from"./square-pen-BdpVwC-X.js";import{M as Be,P as is}from"./phone-CXTq_U1H.js";import{T as Te}from"./trash-2-ixp3286y.js";import{F as ha}from"./filter-vh9_Ffox.js";import{S as xa}from"./star-B2Hv5X_1.js";import{C as pa}from"./circle-check-big-2XuSSa5-.js";import"./index-da16CiNc.js";import"./chevron-left-3DLBy2_V.js";import"./alert-CJsotLI_.js";import"./download-BwSGJ_lt.js";import"./getDaysInMonth-DEtwUiq9.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=We("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=We("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=We("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=We("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);function fa({data:s,columns:a,actions:o=[],bulkActions:v=[],keyExtractor:y,onRowClick:c,emptyState:u,mobileCardRender:g,className:d,enableBulkSelect:j=!1,rowHeight:p,currentPage:D=1,totalPages:A=0,totalCount:r=0,pageSize:N=10,onPageChange:C,isLoading:L=!1}){const B=sa(),{t:m}=ue(),[T,U]=n.useState(new Set);n.useEffect(()=>{const h=new Set(s.map(y));U(I=>{const E=new Set(I);for(const se of I)h.has(se)||E.delete(se);return E})},[s,y]);const J=h=>{const I=new Set(T);I.has(h)?I.delete(h):I.add(h),U(I)},be=()=>{T.size===s.length?U(new Set):U(new Set(s.map(y)))},Z=()=>{U(new Set)},ve=()=>s.filter(h=>T.has(y(h))),z=h=>{const I=o.filter(E=>!E.show||E.show(h));return I.length===0?null:e.jsxs(_s,{children:[e.jsx(Vs,{asChild:!0,onClick:E=>E.stopPropagation(),children:e.jsx(x,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(ia,{className:"h-4 w-4"})})}),e.jsx(Js,{align:"end",children:I.map((E,se)=>e.jsxs(zs,{onClick:K=>{K.stopPropagation(),E.onClick(h)},className:je(E.variant==="destructive"&&"text-destructive focus:text-destructive"),children:[E.icon&&e.jsx("span",{className:"me-2",children:E.icon}),E.label]},se))})]})};if(s.length===0)return u||e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:m("common.noData","No data available")});if(B)return e.jsx("div",{className:je("space-y-3 w-full overflow-hidden",d),children:s.map((h,I)=>g?e.jsx("div",{onClick:()=>c==null?void 0:c(h),className:"w-full",children:g(h,z(h))},y(h)):e.jsx(W,{className:je("w-full overflow-hidden transition-all",c&&"cursor-pointer hover:shadow-md active:scale-[0.99]"),onClick:()=>c==null?void 0:c(h),children:e.jsx(_,{className:"p-4 w-full",children:e.jsxs("div",{className:"space-y-3 w-full",children:[a.filter(E=>!E.hideOnMobile).map((E,se)=>e.jsxs("div",{className:"flex items-start justify-between gap-2 w-full min-w-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground font-medium uppercase tracking-wide flex-shrink-0",children:E.header}),e.jsx("div",{className:"text-sm text-end flex-shrink-0 max-w-[60%]",children:E.render(h,I)})]},E.key)),o.length>0&&e.jsx("div",{className:"pt-2 border-t flex justify-end",children:z(h)})]})})},y(h)))});const l=T.size,w=l===s.length&&s.length>0,F=l>0&&l<s.length;return e.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[j&&l>0&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-primary/5 border border-primary/20 rounded-lg animate-in fade-in slide-in-from-top-2 flex-shrink-0",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm font-medium",children:[l," ",l===1?m("common.item","item"):m("common.items","items")," ",m("common.selected","selected")]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[v.map((h,I)=>e.jsxs(x,{variant:h.variant==="destructive"?"destructive":"outline",size:"sm",onClick:()=>h.onClick(ve()),className:je(h.variant==="destructive"&&"hover:bg-destructive/90"),children:[h.icon&&e.jsx("span",{className:"me-2",children:h.icon}),h.label]},I)),e.jsx(x,{variant:"ghost",size:"sm",onClick:Z,className:"text-muted-foreground hover:text-foreground",children:e.jsx(ns,{className:"h-4 w-4"})})]})]}),e.jsx(W,{className:je("overflow-hidden flex-1 flex flex-col",d),children:e.jsx(_,{className:"p-0 flex-1 flex flex-col",children:e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs(xs,{children:[e.jsx(ps,{children:e.jsxs(Se,{className:"bg-muted/50 hover:bg-muted/50 sticky top-0 z-20 shadow-sm",children:[j&&e.jsx(re,{className:"w-12",children:e.jsx(ss,{checked:w,indeterminate:F,onCheckedChange:be,"aria-label":m("common.selectAll","Select all")})}),a.map(h=>e.jsx(re,{className:je("font-semibold",h.className),children:h.header},h.key)),o.length>0&&e.jsx(re,{className:"w-[100px] text-end",children:m("common.actions")})]})}),e.jsx(us,{children:s.map((h,I)=>{const E=y(h),se=T.has(E);return e.jsxs(Se,{className:je("group transition-colors",se&&"bg-primary/5",c&&"cursor-pointer hover:bg-muted/50",p),onClick:()=>c==null?void 0:c(h),children:[j&&e.jsx(ae,{onClick:K=>K.stopPropagation(),children:e.jsx(ss,{checked:se,onCheckedChange:()=>J(E),"aria-label":m("common.selectItem","Select item")})}),a.map(K=>e.jsx(ae,{className:je(K.className,"overflow-hidden"),children:K.render(h,I)},K.key)),o.length>0&&e.jsx(ae,{className:"text-end",children:e.jsx("div",{children:z(h)})})]},E)})})]})})})}),A>0&&C&&e.jsx("div",{className:"flex-shrink-0 border-t pt-4 bg-background",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:r>0?e.jsxs(e.Fragment,{children:[m("common.showing")," ",(D-1)*N+1," ",m("common.to")," ",Math.min(D*N,r)," ",m("common.of")," ",r," ",m("common.users")]}):e.jsx(e.Fragment,{children:m("common.noData","No data")})}),e.jsx(aa,{children:e.jsxs(ta,{children:[e.jsx(ze,{children:e.jsx(la,{onClick:()=>C(Math.max(1,D-1)),className:D===1||L?"pointer-events-none opacity-50":"cursor-pointer","aria-disabled":D===1||L})}),e.jsx(ze,{children:e.jsx("span",{className:"px-3 py-2 text-sm flex items-center gap-2",children:L?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),m("common.loading")]}):e.jsxs(e.Fragment,{children:[m("common.page")," ",D," ",m("common.of")," ",A]})})}),e.jsx(ze,{children:e.jsx(ra,{onClick:()=>C(Math.min(A,D+1)),className:D===A||L?"pointer-events-none opacity-50":"cursor-pointer","aria-disabled":D===A||L})})]})})]})})]})}function ya({children:s,variant:a="secondary"}){return e.jsx(X,{variant:a,className:"text-xs font-medium",children:s})}function Na({date:s,fallback:a="Not set"}){return s?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(_e,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{children:new Date(s).toLocaleDateString()})]}):e.jsx("span",{className:"text-muted-foreground",children:a})}function ba({title:s,subtitle:a,icon:o}){return e.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full",children:[o&&(typeof o=="function"?Ws.createElement(o):o),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium truncate text-sm break-words",children:s}),a&&e.jsx("div",{className:"text-xs text-muted-foreground truncate break-words",children:a})]})]})}const va=()=>{const s={type:"report_employee_directory",title:"Employee Directory",description:"Complete list of active employees with their job titles and departments.",columns:[{key:"EmployeeID",label:"ID"},{key:"EmployeeName",label:"Name"},{key:"Email",label:"Email"},{key:"JobName",label:"Job Title"},{key:"Department",label:"Department"},{key:"Branch",label:"Branch",format:o=>o||"-"},{key:"HireDate",label:"Hire Date",format:o=>o?new Date(o).toLocaleDateString():"-"},{key:"EmploymentStatus",label:"Status",format:o=>e.jsx(X,{variant:o==="Active"?"default":"secondary",children:o})}]},a={type:"report_employee_hiring",title:"Hiring Report",description:"Employees hired within a specific date range.",columns:[{key:"EmployeeID",label:"ID"},{key:"EmployeeName",label:"Name"},{key:"JobName",label:"Job Title"},{key:"Department",label:"Department"},{key:"HireDate",label:"Hire Date",format:o=>o?new Date(o).toLocaleDateString():"-"},{key:"EmploymentStatus",label:"Status"}],filters:[{key:"start_date",label:"Start Date",type:"date",defaultValue:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]},{key:"end_date",label:"End Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]}]};return e.jsx("div",{className:"space-y-6",children:e.jsxs(Ge,{defaultValue:"directory",className:"space-y-4",children:[e.jsxs(Ye,{children:[e.jsx(te,{value:"directory",children:"Employee Directory"}),e.jsx(te,{value:"hiring",children:"Hiring History"})]}),e.jsx(le,{value:"directory",children:e.jsx(ts,{reportType:s.type,title:s.title,description:s.description,columns:s.columns,disableAutoFetch:!1})}),e.jsx(le,{value:"hiring",children:e.jsx(ts,{reportType:a.type,title:a.title,description:a.description,columns:a.columns,filterFields:a.filters,disableAutoFetch:!0})})]})})},Da=na({FirstName:ee().min(1,"First Name is required"),LastName:ee().min(1,"Last Name is required"),Email:ee().email("Invalid email").nullish().or(ls("")),Phone:ee().min(10,"Phone must be 10+ digits").nullish().or(ls("")),DateOfBirth:rs({required_error:"Date of Birth is required"}),Gender:ee().min(1,"Gender is required"),NationalID:ee().nullish(),Address:ee().nullish(),City:ee().nullish(),Country:ee().nullish(),PostalCode:ee().nullish(),HireDate:rs({required_error:"Hire Date is required"}),EmploymentStatus:ee().nullish(),HrDepartmentID:ee().min(1,"Department is required"),JobID:ee().min(1,"Job Title is required")});function wa({form:s}){const{t:a}=ue(),o=(v,y)=>{if(y.length===10){const c=Ns(y,"dd/MM/yyyy",new Date);ds(c)&&s.setValue(v,c,{shouldValidate:!0})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:a("employees.form.sections.personal.title")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.firstName")}),e.jsx(H,{...s.register("FirstName")}),s.formState.errors.FirstName&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.FirstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.lastName")}),e.jsx(H,{...s.register("LastName")}),s.formState.errors.LastName&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.LastName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.email")}),e.jsx(H,{type:"email",...s.register("Email")}),s.formState.errors.Email&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.Email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.phone")}),e.jsx(H,{...s.register("Phone")}),s.formState.errors.Phone&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.Phone.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.dob")}),e.jsxs(js,{children:[e.jsx(gs,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(_e,{className:"me-2 h-4 w-4"}),s.watch("DateOfBirth")?Ee(s.watch("DateOfBirth"),"PPP"):"Select date"]})}),e.jsxs(fs,{className:"w-auto p-0",children:[e.jsx(ys,{mode:"single",selected:s.watch("DateOfBirth"),onSelect:v=>v&&s.setValue("DateOfBirth",v)}),e.jsx("div",{className:"p-3 border-t",children:e.jsx(H,{value:s.watch("DateOfBirth")?Ee(s.watch("DateOfBirth"),"dd/MM/yyyy"):"",onChange:v=>o("DateOfBirth",v.target.value),placeholder:"DD/MM/YYYY"})})]})]}),s.formState.errors.DateOfBirth&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.DateOfBirth.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.gender.label")}),e.jsxs(ge,{onValueChange:v=>s.setValue("Gender",v),value:s.watch("Gender"),children:[e.jsx(fe,{children:e.jsx(ye,{placeholder:a("employees.form.gender.placeholder")})}),e.jsxs(Ne,{children:[e.jsx(G,{value:"M",children:a("employees.form.gender.male")}),e.jsx(G,{value:"F",children:a("employees.form.gender.female")})]})]}),s.formState.errors.Gender&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.Gender.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.nationalId")}),e.jsx(H,{...s.register("NationalID")}),s.formState.errors.NationalID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.NationalID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.address")}),e.jsx(H,{...s.register("Address")})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.city")}),e.jsx(H,{...s.register("City")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.country")}),e.jsx(H,{...s.register("Country")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.form.postalCode")}),e.jsx(H,{...s.register("PostalCode")})]})]})]})}function ka({form:s}){const{t:a}=ue(),[o,v]=n.useState({departments:[],jobs:[],employmentStatuses:[{id:"Active",name:a("common.active")},{id:"Inactive",name:a("common.inactive")},{id:"On Leave",name:a("employees.statusTypes.On Leave")},{id:"Terminated",name:a("employees.statusTypes.Terminated")}]}),[y,c]=n.useState(!0);n.useEffect(()=>{(async()=>{try{c(!0);const[j,p]=await Promise.all([He.departments.list({page:0,pageSize:100}),He.job.list({page:0,pageSize:100})]);v(D=>({...D,departments:j.data||[],jobs:p.data||[]}))}catch(j){console.error("Error fetching job data:",j)}finally{c(!1)}})()},[]);const u=o.jobs.filter(d=>!s.watch("HrDepartmentID")||String(d.HrDepartmentID)===String(s.watch("HrDepartmentID")));n.useEffect(()=>{const d=s.getValues("JobID");d&&u.length>0&&(u.some(p=>String(p.JobID)===String(d))||s.setValue("JobID",""))},[s.watch("HrDepartmentID"),o.jobs]);const g=d=>{if(d.length===10){const j=Ns(d,"dd/MM/yyyy",new Date);ds(j)&&s.setValue("HireDate",j,{shouldValidate:!0})}};return y?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Job Information"}),e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Re,{className:"h-6 w-6 animate-spin text-muted-foreground"}),e.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Loading job data..."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:a("employees.form.sections.job.title")}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.department")}),e.jsxs(ge,{value:s.watch("HrDepartmentID"),onValueChange:d=>s.setValue("HrDepartmentID",d),children:[e.jsx(fe,{children:e.jsx(ye,{placeholder:a("employees.form.departmentPlaceholder")})}),e.jsx(Ne,{children:o.departments.map(d=>e.jsx(G,{value:String(d.HrDepartmentID),children:d.HrDepartmentName},d.HrDepartmentID))})]}),s.formState.errors.HrDepartmentID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.HrDepartmentID.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.jobTitle")}),e.jsxs(ge,{value:s.watch("JobID"),onValueChange:d=>s.setValue("JobID",d),disabled:!s.watch("HrDepartmentID"),children:[e.jsx(fe,{children:e.jsx(ye,{placeholder:s.watch("HrDepartmentID")?a("employees.form.jobPlaceholder"):"Select Department first"})}),e.jsx(Ne,{children:u.map(d=>e.jsx(G,{value:String(d.JobID),children:d.JobName},d.JobID))})]}),s.formState.errors.JobID&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.JobID.message})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.status")}),e.jsxs(ge,{value:s.watch("EmploymentStatus"),onValueChange:d=>s.setValue("EmploymentStatus",d),children:[e.jsx(fe,{children:e.jsx(ye,{placeholder:a("employees.form.statusPlaceholder")})}),e.jsx(Ne,{children:o.employmentStatuses.map(d=>e.jsx(G,{value:d.id,children:d.name},d.id))})]}),s.formState.errors.EmploymentStatus&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.EmploymentStatus.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{children:a("employees.hireDate")}),e.jsxs(js,{children:[e.jsx(gs,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(_e,{className:"me-2 h-4 w-4"}),s.watch("HireDate")?Ee(s.watch("HireDate"),"PPP"):a("employees.form.pickDate")]})}),e.jsxs(fs,{className:"w-auto p-0",children:[e.jsx(ys,{mode:"single",selected:s.watch("HireDate"),onSelect:d=>d&&s.setValue("HireDate",d)}),e.jsx("div",{className:"p-3 border-t",children:e.jsx(H,{value:s.watch("HireDate")?Ee(s.watch("HireDate"),"dd/MM/yyyy"):"",onChange:d=>g(d.target.value),placeholder:"DD/MM/YYYY"})})]})]}),s.formState.errors.HireDate&&e.jsx("p",{className:"text-sm text-red-500",children:s.formState.errors.HireDate.message})]})]})]})}function Sa({employee:s,open:a,onOpenChange:o,onSuccess:v}){const{t:y}=ue(),{toast:c}=Bs(),[u,g]=n.useState(null),[d,j]=n.useState(!1),p=da({resolver:ca(Da),defaultValues:{FirstName:(s==null?void 0:s.FirstName)||"",LastName:(s==null?void 0:s.LastName)||"",Email:(s==null?void 0:s.Email)||"",Phone:(s==null?void 0:s.Phone)||(s==null?void 0:s.PhoneNumber)||"",DateOfBirth:s!=null&&s.DateOfBirth?new Date(s.DateOfBirth):void 0,Gender:(s==null?void 0:s.Gender)==="M"||(s==null?void 0:s.Gender)==="F"?s.Gender:"",NationalID:(s==null?void 0:s.NationalID)||"",HrDepartmentID:"",JobID:"",HireDate:new Date,EmploymentStatus:"",Address:"",City:"",Country:"",PostalCode:""}});n.useEffect(()=>{a&&(s!=null&&s.EmployeeID)&&D(s.EmployeeID)},[a,s==null?void 0:s.EmployeeID]);const D=async r=>{try{j(!0);const N=await He.list("employees",{select_fields:["EmployeeID","FirstName","LastName","Email","Phone","PhoneNumber","DateOfBirth","Gender","NationalID","Address","City","Country","PostalCode","HireDate","EmploymentStatus","TerminationDate","CreatedDate","UpdatedDate","departments_HrDepartmentName","job_JobName","HrDepartmentID","JobID"].join(","),sort:"ASC",pageSize:140,exact_filters:JSON.stringify({EmployeeID:r})});N.data&&N.data.length>0&&g(N.data[0])}catch(N){console.error("Error fetching employee data:",N),c({title:"Error",description:"Failed to load employee data. Please try again.",variant:"destructive"})}finally{j(!1)}};n.useEffect(()=>{var r,N;if(u){const C={...u,HrDepartmentID:((r=u.HrDepartmentID)==null?void 0:r.toString())||"",JobID:((N=u.JobID)==null?void 0:N.toString())||"",DateOfBirth:u.DateOfBirth?new Date(u.DateOfBirth):null,HireDate:u.HireDate?new Date(u.HireDate):null,Email:u.Email||"",Phone:u.Phone||u.PhoneNumber||"",Address:u.Address||"",City:u.City||"",Country:u.Country||"",PostalCode:u.PostalCode||"",EmploymentStatus:u.EmploymentStatus||""};p.reset(C)}},[u,p]);const A=async r=>{if(s!=null&&s.EmployeeID)try{const N=L=>L?Ee(L,"yyyy-MM-dd"):null,C={...r,HrDepartmentID:r.HrDepartmentID?Number(r.HrDepartmentID):null,JobID:r.JobID?Number(r.JobID):null,DateOfBirth:N(r.DateOfBirth),HireDate:N(r.HireDate),Email:r.Email||null,Phone:r.Phone||null,Address:r.Address||null,City:r.City||null,Country:r.Country||null,PostalCode:r.PostalCode||null,EmploymentStatus:r.EmploymentStatus||null};await He.employees.update(s.EmployeeID,C),c({title:"Success",description:"Employee updated successfully."}),v(),o(!1)}catch(N){console.error("Error updating employee:",N),c({title:"Error",description:"Failed to update employee. Please try again.",variant:"destructive"})}};return e.jsx(ie,{open:a,onOpenChange:o,children:e.jsxs(ne,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsx(ce,{children:y("employees.edit")})}),d?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Re,{className:"h-6 w-6 animate-spin text-muted-foreground mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading employee data..."})]}):e.jsxs("form",{onSubmit:p.handleSubmit(A),className:"space-y-6",children:[Object.keys(p.formState.errors).length>0&&e.jsxs("div",{className:"p-4 mb-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-red-800 mb-1",children:"Please fix the following errors:"}),e.jsx("ul",{className:"list-disc list-inside text-xs text-red-700",children:Object.entries(p.formState.errors).map(([r,N])=>e.jsxs("li",{children:[r,": ",N.message]},r))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(wa,{form:p}),e.jsx("div",{className:"border-t border-gray-200 my-6"}),e.jsx(ka,{form:p})]}),e.jsxs(ea,{children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>o(!1),children:y("common.cancel")}),e.jsx(x,{type:"submit",disabled:p.formState.isSubmitting,children:p.formState.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"me-2 h-4 w-4 animate-spin"}),y("common.saving")]}):y("common.save")})]})]})]})})}function Ca(){const{t:s}=ue(),[a,o]=n.useState({totalEmployees:0,activeEmployees:0,onLeave:0,departments:0,newHiresThisMonth:0,terminatedThisMonth:0}),{data:v,isLoading:y}=Ie({queryKey:["employees"],queryFn:async()=>{try{const g=await S.employees.list({select_fields:"EmployeeID,FirstName,LastName,Email,EmploymentStatus,HireDate,TerminationDate,HrDepartmentID",sort:"asc",pageSize:1e3});return(g==null?void 0:g.data)||[]}catch(g){return console.error("Error fetching employees:",g),[]}},retry:1,staleTime:5*60*1e3}),{data:c}=Ie({queryKey:["departments"],queryFn:async()=>{try{const g=await S.departments.list({});return(g==null?void 0:g.data)||[]}catch(g){return console.error("Error fetching departments:",g),[]}},retry:1,staleTime:5*60*1e3});if(n.useEffect(()=>{if(v&&c){const g=new Date,d=g.getMonth(),j=g.getFullYear(),p=v.filter(A=>{if(!A.HireDate)return!1;const r=new Date(A.HireDate);return r.getMonth()===d&&r.getFullYear()===j}).length,D=v.filter(A=>{if(!A.TerminationDate)return!1;const r=new Date(A.TerminationDate);return r.getMonth()===d&&r.getFullYear()===j}).length;o({totalEmployees:v.length,activeEmployees:v.filter(A=>A.EmploymentStatus==="Active").length,onLeave:v.filter(A=>A.EmploymentStatus==="On Leave").length,departments:c.length,newHiresThisMonth:p,terminatedThisMonth:D})}},[v,c]),y)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((g,d)=>e.jsxs(W,{className:"bg-muted/10",children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(he,{className:"h-4 w-24"}),e.jsx(he,{className:"h-6 w-6 rounded-full"})]}),e.jsxs(_,{children:[e.jsx(he,{className:"h-8 w-16 mb-2"}),e.jsx(he,{className:"h-4 w-32"})]})]},d))})});const u=[{title:s("employees.dashboard.totalEmployees"),value:a.totalEmployees,icon:e.jsx(cs,{className:"h-4 w-4 text-muted-foreground"}),description:s("employees.dashboard.allDepartments")},{title:s("employees.dashboard.activeEmployees"),value:a.activeEmployees,icon:e.jsx(as,{className:"h-4 w-4 text-green-500"}),description:s("employees.dashboard.currentlyWorking")},{title:s("employees.dashboard.onLeave"),value:a.onLeave,icon:e.jsx($e,{className:"h-4 w-4 text-amber-500"}),description:s("employees.dashboard.currentlyOnLeave")},{title:s("employees.dashboard.departments"),value:a.departments,icon:e.jsx(Us,{className:"h-4 w-4 text-blue-500"}),description:s("employees.dashboard.activeDepartments")},{title:s("employees.dashboard.newHires"),value:a.newHiresThisMonth,icon:e.jsx(as,{className:"h-4 w-4 text-emerald-500"}),description:s("employees.dashboard.thisMonth")},{title:s("employees.dashboard.terminations"),value:a.terminatedThisMonth,icon:e.jsx($s,{className:"h-4 w-4 text-red-500"}),description:s("employees.dashboard.thisMonth")}];return e.jsx("div",{className:"space-y-4 overflow-y-auto h-full",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:u.map((g,d)=>e.jsxs(W,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(me,{className:"text-sm font-medium",children:g.title}),e.jsx("div",{className:"h-4 w-4",children:g.icon})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.value}),e.jsx("p",{className:"text-xs text-muted-foreground",children:g.description})]})]},d))})})}function Ta(){const{t:s}=ue(),[a,o]=n.useState(null),[v,y]=n.useState(!1),[c,u]=n.useState(!1),[g,d]=n.useState(!1),[j,p]=n.useState([]),[D,A]=n.useState(0),[r,N]=n.useState(!0),[C,L]=n.useState(!1),[B,m]=n.useState(null),[T,U]=n.useState(""),[J,be]=n.useState("all"),[Z,ve]=n.useState("all"),[z,l]=n.useState(1),w=10,F=os(),h=Math.ceil(D/w);console.log("Pagination Debug:",{currentPage:z,totalPages:h,totalCount:D,pageSize:w});const I=i=>{o(i),y(!0)},E=i=>{o(i),u(!0)},se=i=>{o(i),d(!0)},K=async()=>{if(a)try{await S.employees.delete(a.EmployeeID),await xe(),d(!1),o(null)}catch(i){console.error("Error deleting employee:",i),m("Failed to delete employee. Please try again.")}},Pe=async()=>{await xe(z)},xe=async(i=1)=>{try{console.log("Fetching employees for page:",i,"pageSize:",w),i===1?N(!0):L(!0);const $=["EmployeeID","FirstName","LastName","Email","Phone","DateOfBirth","Gender","NationalID","Address","City","Country","PostalCode","HireDate","EmploymentStatus","TerminationDate","CreatedDate","UpdatedDate","departments_HrDepartmentName","job_JobName","full_name","employee_display","status_display","gender_display","age","years_of_service","dob_formatted","hire_date_formatted","phone_display","email_display","job_JobNameEn","departments_HrDepartmentNameEn"],k={};J!=="all"&&(k.departments_HrDepartmentName=J),Z!=="all"&&(k.EmploymentStatus=Z),T&&(k.search=T);const Q={select_fields:$,page:i-1,pageSize:w,sort:"desc",field:"FirstName",...k};console.log("API call params:",Q);const f=await S.employees.list(Q),V=(f==null?void 0:f.data)||[],De=(f==null?void 0:f.total)??(f==null?void 0:f.totalRows)??(f==null?void 0:f.totalCount)??0;console.log("API response:",{employeesCount:V.length,total:De,page:i}),Array.isArray(V)?(console.log("Setting employees:",V.length,"employees"),p(V),A(De)):(console.log("Unexpected response format:",f),m("Unexpected response format from server"))}catch($){const k=$ instanceof Error?$.message:"Failed to fetch employees";m(k)}finally{N(!1),L(!1)}};n.useEffect(()=>{xe(1)},[]),n.useEffect(()=>{l(1),xe(1)},[T,J,Z]),n.useEffect(()=>{xe(z)},[z]);const Ve=["all","IT","HR","Finance","Operations","Sales","Marketing"],Je=["all","Active","On Leave","Terminated"],Ae=i=>i?new Date(i).toLocaleDateString(s("common.locale",{defaultValue:"en-US"}),{year:"numeric",month:"short",day:"numeric"}):"N/A",Le=i=>i.split(" ").map($=>$[0]).join("").toUpperCase();return r?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:s("employees.dashboard.directory.loadingTitle")}),e.jsx("p",{className:"text-muted-foreground",children:s("employees.dashboard.directory.loadingSubtitle")})]})}),e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((i,$)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(he,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(he,{className:"h-4 w-[250px]"}),e.jsx(he,{className:"h-4 w-[200px]"})]})]},$))})]}):B?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:B}),e.jsx(x,{onClick:()=>xe(1),children:s("common.retry")})]})}):e.jsxs("div",{className:"flex flex-col h-full min-h-0 gap-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 flex-shrink-0",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:s("employees.dashboard.directory.title")}),e.jsxs("p",{className:"text-muted-foreground",children:[D," ",s("common.total")]})]}),e.jsxs(x,{onClick:()=>F("/employees/new"),children:[e.jsx(Ce,{className:"me-2 h-4 w-4"}),s("employees.add")]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-shrink-0",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ms,{className:"absolute start-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:s("employees.dashboard.directory.searchPlaceholder"),className:"ps-10",value:T,onChange:i=>U(i.target.value)})]}),e.jsxs(ge,{value:J,onValueChange:be,children:[e.jsx(fe,{className:"w-full md:w-[200px]",children:e.jsx(ye,{placeholder:s("employees.department")})}),e.jsx(Ne,{children:Ve.map(i=>e.jsx(G,{value:i,children:i==="all"?s("employees.dashboard.directory.allDepartments"):s(`employees.dashboard.directory.departmentsList.${i}`,i)},i))})]}),e.jsxs(ge,{value:Z,onValueChange:ve,children:[e.jsx(fe,{className:"w-full md:w-[150px]",children:e.jsx(ye,{placeholder:s("employees.status")})}),e.jsx(Ne,{children:Je.map(i=>e.jsx(G,{value:i,children:i==="all"?s("employees.dashboard.directory.allStatus"):s(`employees.dashboard.statusTypes.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col gap-2",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Debug: Employees state has ",j.length," items"]}),e.jsx(fa,{data:j,keyExtractor:i=>i.EmployeeID,className:"h-full",currentPage:z,totalPages:h,totalCount:D,pageSize:w,onPageChange:i=>{console.log("ListView onPageChange called with page:",i),l(i)},isLoading:C,columns:[{key:"employee",header:s("employees.dashboard.directory.table.employee"),render:i=>e.jsx(ba,{title:`${i.FirstName} ${i.LastName}`,subtitle:i.Email,icon:e.jsx(Ze,{className:"h-8 w-8 me-2",children:e.jsx(es,{className:"text-xs",children:Le(`${i.FirstName} ${i.LastName}`)})})})},{key:"department",header:s("employees.dashboard.directory.table.department"),render:i=>i.departments_HrDepartmentName||"N/A"},{key:"jobTitle",header:s("employees.dashboard.directory.table.jobTitle"),render:i=>i.job_JobName||"N/A"},{key:"status",header:s("employees.dashboard.directory.table.status"),render:i=>e.jsx(ya,{variant:i.EmploymentStatus==="Active"?"default":i.EmploymentStatus==="On Leave"?"outline":i.EmploymentStatus==="Terminated"?"destructive":"outline",children:s(`employees.dashboard.statusTypes.${i.EmploymentStatus}`,i.EmploymentStatus)})},{key:"hireDate",header:s("employees.dashboard.directory.table.hireDate"),render:i=>e.jsx(Na,{date:i.HireDate})}],actions:[{label:s("employees.dashboard.directory.viewDetails"),icon:e.jsx(ma,{className:"h-4 w-4"}),onClick:I,ariaLabel:s("employees.dashboard.directory.viewDetails")},{label:s("employees.edit"),icon:e.jsx(Me,{className:"h-4 w-4"}),onClick:E,ariaLabel:s("employees.edit")},{label:s("employees.dashboard.directory.sendEmail"),icon:e.jsx(Be,{className:"h-4 w-4"}),onClick:i=>{window.open(`mailto:${i.Email}`,"_blank")},ariaLabel:s("employees.dashboard.directory.sendEmail")},{label:s("employees.dashboard.directory.callEmployee"),icon:e.jsx(is,{className:"h-4 w-4"}),onClick:i=>{window.open(`tel:${i.Phone}`,"_blank")},ariaLabel:s("employees.dashboard.directory.callEmployee")},{label:s("employees.dashboard.directory.deleteEmployee"),icon:e.jsx(Te,{className:"h-4 w-4"}),onClick:se,variant:"destructive",ariaLabel:s("employees.dashboard.directory.deleteEmployee")}],emptyState:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(hs,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:s("employees.dashboard.directory.noEmployees")}),e.jsx("p",{className:"text-muted-foreground",children:s("employees.dashboard.directory.noEmployeesDesc")})]}),enableBulkSelect:!0,bulkActions:[{label:s("employees.dashboard.directory.sendEmail"),icon:e.jsx(Be,{className:"h-4 w-4"}),onClick:i=>{const $=i.map(k=>k.Email).filter(Boolean).join(",");$&&window.open(`mailto:${$}`,"_blank")}},{label:s("employees.dashboard.directory.exportSelected"),icon:e.jsx(Oe,{className:"h-4 w-4"}),onClick:i=>{console.log("Export selected employees:",i)}}]})]}),a&&e.jsx(Sa,{employee:a,open:c,onOpenChange:u,onSuccess:Pe}),e.jsx(ie,{open:v,onOpenChange:y,children:e.jsxs(ne,{className:"max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsx(de,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(ce,{className:"text-2xl",children:s("employees.dashboard.directory.profile")}),e.jsxs(oe,{children:[s("employees.dashboard.directory.profileDesc")," ",a==null?void 0:a.FirstName," ",a==null?void 0:a.LastName]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>F(`/employee_documents/${a==null?void 0:a.EmployeeID}`),children:[e.jsx(Oe,{className:"mr-2 h-4 w-4"}),s("employees.dashboard.directory.viewDocuments")]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>F(`/contracts/${a!=null&&a.EmployeeID?a.EmployeeID+1e3:""}`),children:[e.jsx(Oe,{className:"me-2 h-4 w-4"}),s("employees.dashboard.directory.viewContract")]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>{y(!1),a&&E(a)},children:[e.jsx(Me,{className:"me-2 h-4 w-4"}),s("employees.dashboard.directory.editProfile")]})]})]})}),a&&e.jsxs("div",{className:"flex-1 overflow-y-auto pr-2",children:[e.jsxs(W,{children:[e.jsx(Y,{className:"bg-gray-50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Personal Information"})}),e.jsx(_,{className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsxs("p",{className:"text-base",children:[a.FirstName," ",a.LastName]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Employee ID"}),e.jsx("p",{className:"text-base",children:a.EmployeeCode})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"National ID"}),e.jsx("p",{className:"text-base",children:a.NationalID||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{className:"text-base",children:a.Email||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"text-base",children:a.Phone||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),e.jsx("p",{className:"text-base",children:a.dob_formatted||(a.DateOfBirth?new Date(a.DateOfBirth).toLocaleDateString():"N/A")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),e.jsx("p",{className:"text-base",children:a.gender_display||a.Gender||"N/A"})]})]})})]}),e.jsxs(W,{children:[e.jsx(Y,{className:"bg-gray-50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Employment Details"})}),e.jsxs(_,{className:"px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Department"}),e.jsx("p",{className:"text-base",children:a.departments_HrDepartmentName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Job Title"}),e.jsx("p",{className:"text-base",children:a.job_JobName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Job Level"}),e.jsx("p",{className:"text-base",children:a.joblevel_JobLevelName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Employment Type"}),e.jsx("p",{className:"text-base",children:a.jobtype_JobTypeName||"N/A"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Hire Date"}),e.jsx("p",{className:"text-base",children:a.hire_date_formatted||(a.HireDate?new Date(a.HireDate).toLocaleDateString():"N/A")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(X,{variant:a.EmploymentStatus==="Active"?"default":a.EmploymentStatus==="On Leave"?"secondary":a.EmploymentStatus==="Terminated"?"destructive":"outline",children:a.status_display||a.EmploymentStatus})]})]}),a.TerminationDate&&e.jsx("div",{className:"mt-4 bg-red-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(_e,{className:"h-4 w-4 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s("employees.terminationDate")}),e.jsx("p",{children:Ae(a.TerminationDate)})]})]})})]})]}),e.jsxs(W,{children:[e.jsx(Y,{className:"bg-gray-50 px-6 py-4",children:e.jsx("h3",{className:"text-lg font-semibold",children:"Contact Information"})}),e.jsx(_,{className:"px-6 py-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),e.jsxs("div",{children:[e.jsx("p",{children:a.Address||"No address provided"}),a.City&&a.Country&&e.jsxs("p",{children:[a.City,", ",a.Country," ",a.PostalCode]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Contact"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{children:a.Email||s("common.unknown")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{children:a.Phone||s("common.unknown")})]})]})]})]})})]})]})]})}),e.jsx(ie,{open:g,onOpenChange:d,children:e.jsxs(ne,{children:[e.jsxs(de,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-destructive"}),s("employees.dashboard.directory.deleteConfirmTitle")]}),e.jsx(oe,{children:s("employees.dashboard.directory.deleteConfirmDesc")})]}),a&&e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ze,{className:"h-10 w-10",children:e.jsx(es,{children:Le(`${a.FirstName} ${a.LastName}`)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:`${a.FirstName} ${a.LastName}`}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",a.EmployeeID]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Department:"})," ",a.departments_HrDepartmentName||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Job Title:"})," ",a.job_JobName||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",a.status_display||a.EmploymentStatus]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Hire Date:"})," ",Ae(a.HireDate)]})]})]}),e.jsx("div",{className:"mt-4 p-3 bg-destructive/10 border border-destructive/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-destructive font-medium",children:"⚠️ Warning: This will permanently delete the employee and all associated data."})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>d(!1),children:s("common.cancel")}),e.jsx(x,{variant:"destructive",onClick:K,disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white me-2"}),s("employees.dashboard.directory.deleting")]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"me-2 h-4 w-4"}),s("employees.dashboard.directory.deleteEmployee")]})})]})]})})]})}function Ea(){const{t:s}=ue(),a=Gs(),[o,v]=n.useState(""),[y,c]=n.useState("all"),[u,g]=n.useState(null),[d,j]=n.useState(!1),[p,D]=n.useState({skillName:"",skillType:"technical",level:"beginner",experience:0,employeeId:"",department:"",jobTitle:""}),{data:A=[],isLoading:r,error:N}=Ie({queryKey:["skills"],queryFn:async()=>{const l=await S.skills.list({pageSize:1e3});return(l==null?void 0:l.data)||[]}}),C=A.map(l=>{var w,F,h,I;return{id:((w=l.SkillID)==null?void 0:w.toString())||"",skillName:l.SkillName||"",skillType:((F=l.SkillType)==null?void 0:F.toLowerCase())||"technical",level:((h=l.SkillLevel)==null?void 0:h.toLowerCase())||"beginner",experience:parseInt(l.SkillExperience)||0,lastUsed:l.lastUsed||"",verified:!!l.SVerified,verifiedBy:l.verifiedBy||"",verificationDate:l.verificationDate||"",employeeId:((I=l.SEmployeeID)==null?void 0:I.toString())||"",employeeName:l.employee_name||"",department:l.department||"",jobTitle:l.jobTitle||""}}),L=[{id:"frontend",name:"Frontend Development",description:"Web frontend technologies and frameworks",skills:C.filter(l=>["React","Vue","Angular","JavaScript","TypeScript","CSS","HTML"].includes(l.skillName))},{id:"backend",name:"Backend Development",description:"Server-side technologies and databases",skills:C.filter(l=>["Node.js","Python","Java","C#","SQL","MongoDB","PostgreSQL"].includes(l.skillName))},{id:"cloud",name:"Cloud & DevOps",description:"Cloud platforms and DevOps tools",skills:C.filter(l=>l.skillName.includes("AWS")||l.skillName.includes("Azure")||l.skillName.includes("GCP")||l.skillName.includes("Docker")||l.skillName.includes("Kubernetes"))},{id:"languages",name:"Languages",description:"Spoken and written languages",skills:C.filter(l=>l.skillType==="language")},{id:"certifications",name:"Certifications",description:"Professional certifications and qualifications",skills:C.filter(l=>l.skillType==="certification")}],m=[...C.filter(l=>{const w=l.skillName.toLowerCase().includes(o.toLowerCase())||l.employeeName.toLowerCase().includes(o.toLowerCase())||l.department.toLowerCase().includes(o.toLowerCase()),F=y==="all"||l.skillType===y;return w&&F})].sort((l,w)=>{if(!u)return 0;const F=l[u.key],h=w[u.key];return F<h?u.direction==="asc"?-1:1:F>h?u.direction==="asc"?1:-1:0}),T=l=>{let w="asc";u&&u.key===l&&u.direction==="asc"&&(w="desc"),g({key:l,direction:w})},U=l=>{switch(l){case"beginner":return 25;case"intermediate":return 50;case"advanced":return 75;case"expert":return 100;default:return 0}},J=l=>{const F={technical:{color:"bg-blue-100 text-blue-800",label:"Technical"},soft:{color:"bg-green-100 text-green-800",label:"Soft Skill"},language:{color:"bg-purple-100 text-purple-800",label:"Language"},certification:{color:"bg-orange-100 text-orange-800",label:"Certification"}}[l]||{color:"bg-gray-100 text-gray-800",label:"Other"};return e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${F.color}`,children:F.label})},be=()=>{j(!0)},Z=async l=>{if(D({...p,employeeId:l}),l)try{const w=await S.employees.list({exact_filters:{EmployeeID:parseInt(l)},select_fields:"departments_HrDepartmentName,job_JobName"});if(w.data&&w.data.length>0){const F=w.data[0];D(h=>({...h,employeeId:l,department:F.departments_HrDepartmentName||"",jobTitle:F.job_JobName||""}))}}catch(w){console.error("Error fetching employee details:",w)}},ve=async()=>{try{await S.skills.create({SkillName:p.skillName,SkillType:p.skillType,SkillLevel:p.level,SkillExperience:p.experience.toString(),SEmployeeID:p.employeeId,department:p.department,jobTitle:p.jobTitle}),D({skillName:"",skillType:"technical",level:"beginner",experience:0,employeeId:"",department:"",jobTitle:""}),j(!1),M.success("Skill added successfully"),a.invalidateQueries({queryKey:["skills"]})}catch(l){console.error("Error adding skill:",l),M.error("Failed to add skill")}},z=()=>{D({skillName:"",skillType:"technical",level:"beginner",experience:0,employeeId:"",department:"",jobTitle:""}),j(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:s("employees.dashboard.skills.title")}),e.jsx("p",{className:"text-muted-foreground",children:s("employees.dashboard.skills.subtitle")})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:min-w-[300px]",children:[e.jsx(ms,{className:"absolute start-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(H,{placeholder:s("employees.dashboard.skills.searchPlaceholder"),className:"ps-10 w-full",value:o,onChange:l=>v(l.target.value)})]}),e.jsxs(x,{variant:"outline",children:[e.jsx(ha,{className:"h-4 w-4 me-2"}),s("employees.dashboard.skills.filter")]}),e.jsxs(x,{onClick:be,children:[e.jsx(Ce,{className:"h-4 w-4 me-2"}),s("employees.dashboard.skills.addSkill")]})]})]}),e.jsxs(Ge,{dir:s("common.dir",{defaultValue:"ltr"}),defaultValue:"matrix",className:"space-y-4",children:[e.jsxs(Ye,{children:[e.jsx(te,{value:"matrix",children:s("employees.dashboard.skills.tabs.matrix")}),e.jsx(te,{value:"employees",children:s("employees.dashboard.skills.tabs.employees")}),e.jsx(te,{value:"categories",children:s("employees.dashboard.skills.tabs.categories")}),e.jsx(te,{value:"gaps",children:s("employees.dashboard.skills.tabs.gaps")})]}),e.jsxs(le,{value:"matrix",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 overflow-x-auto pb-2",children:[e.jsx(x,{variant:y==="all"?"default":"outline",onClick:()=>c("all"),children:s("employees.dashboard.skills.filters.all")}),e.jsx(x,{variant:y==="technical"?"default":"outline",onClick:()=>c("technical"),children:s("employees.dashboard.skills.filters.technical")}),e.jsx(x,{variant:y==="soft"?"default":"outline",onClick:()=>c("soft"),children:s("employees.dashboard.skills.filters.soft")}),e.jsx(x,{variant:y==="language"?"default":"outline",onClick:()=>c("language"),children:s("employees.dashboard.skills.filters.language")}),e.jsx(x,{variant:y==="certification"?"default":"outline",onClick:()=>c("certification"),children:s("employees.dashboard.skills.filters.certification")})]}),e.jsx(W,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(xs,{children:[e.jsx(ps,{children:e.jsxs(Se,{children:[e.jsx(re,{className:"cursor-pointer",onClick:()=>T("skillName"),children:e.jsxs("div",{className:"flex items-center",children:[s("employees.dashboard.skills.table.skill"),e.jsx(Ue,{className:"ml-2 h-4 w-4"})]})}),e.jsx(re,{children:s("employees.dashboard.skills.table.type")}),e.jsx(re,{className:"cursor-pointer",onClick:()=>T("level"),children:e.jsxs("div",{className:"flex items-center",children:[s("employees.dashboard.skills.table.level"),e.jsx(Ue,{className:"ms-2 h-4 w-4"})]})}),e.jsx(re,{children:s("employees.dashboard.skills.table.experience")}),e.jsx(re,{className:"cursor-pointer",onClick:()=>T("employeeName"),children:e.jsxs("div",{className:"flex items-center",children:[s("employees.dashboard.skills.table.employee"),e.jsx(Ue,{className:"ms-2 h-4 w-4"})]})}),e.jsx(re,{children:s("employees.dashboard.skills.table.department")}),e.jsx(re,{children:s("employees.dashboard.skills.table.verification")}),e.jsx(re,{className:"text-end",children:s("employees.dashboard.skills.table.actions")})]})}),e.jsx(us,{children:m.length>0?m.map(l=>e.jsxs(Se,{children:[e.jsx(ae,{className:"font-medium",children:l.skillName}),e.jsx(ae,{children:J(l.skillType)}),e.jsx(ae,{children:e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"w-24 mr-2",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:l.level}),e.jsxs("span",{children:[U(l.level),"%"]})]}),e.jsx(Zs,{value:U(l.level),className:"h-2"})]})})}),e.jsxs(ae,{children:[l.experience," months"]}),e.jsx(ae,{children:l.employeeName}),e.jsx(ae,{children:l.department}),e.jsx(ae,{children:l.verified?e.jsxs(X,{variant:"default",className:"gap-1 bg-green-100 text-green-800 hover:bg-green-100",children:[e.jsx(Ys,{className:"h-3 w-3"}),s("employees.dashboard.skills.status.verified")]}):e.jsxs(X,{variant:"outline",className:"gap-1",children:[e.jsx(ns,{className:"h-3 w-3"}),s("employees.dashboard.skills.status.notVerified")]})}),e.jsx(ae,{className:"text-end",children:e.jsxs(x,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:s("common.view")}),e.jsx(Fe,{className:"h-4 w-4 rtl:rotate-180"})]})})]},l.id)):e.jsx(Se,{children:e.jsx(ae,{colSpan:8,className:"h-24 text-center",children:s("employees.dashboard.skills.table.noSkills")})})})]})})})]}),e.jsx(le,{value:"categories",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:L.map(l=>e.jsxs(W,{className:"h-full",children:[e.jsxs(Y,{children:[e.jsx(me,{className:"text-lg",children:l.name}),e.jsx(pe,{children:l.description})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:l.skills.length>0?l.skills.map(w=>e.jsx("div",{className:"border rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:w.skillName}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("div",{className:`h-2 w-2 rounded-full mr-2 ${w.level==="beginner"?"bg-blue-500":w.level==="intermediate"?"bg-green-500":w.level==="advanced"?"bg-yellow-500":"bg-purple-500"}`}),e.jsxs("span",{className:"text-xs text-muted-foreground capitalize",children:[w.level," • ",w.experience," months"]})]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:w.employeeName})]})},w.id)):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No skills in this category"})})})]},l.id))})}),e.jsx(le,{value:"employees",children:e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsx(me,{children:"Skills by Employee"}),e.jsx(pe,{children:"View skills organized by employee"})]}),e.jsx(_,{children:e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Employee skills view will be displayed here"})})]})}),e.jsx(le,{value:"gaps",children:e.jsxs(W,{children:[e.jsx(Y,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(me,{children:s("employees.dashboard.skills.gaps.title")}),e.jsx(pe,{children:s("employees.dashboard.skills.gaps.subtitle")})]}),e.jsxs(x,{variant:"outline",children:[e.jsx(xa,{className:"h-4 w-4 me-2"}),s("employees.dashboard.skills.gaps.viewCritical")]})]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(W,{children:[e.jsxs(Y,{className:"pb-2",children:[e.jsx(me,{className:"text-lg",children:s("employees.dashboard.skills.gaps.highDemand")}),e.jsx(pe,{children:s("employees.dashboard.skills.gaps.highDemandDesc")})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:["Machine Learning","Cloud Architecture","Cybersecurity","Data Science","DevOps"].map(l=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{children:l}),e.jsx(X,{variant:"destructive",children:"12 open roles"})]},l))})})]}),e.jsxs(W,{children:[e.jsxs(Y,{className:"pb-2",children:[e.jsx(me,{className:"text-lg",children:s("employees.dashboard.skills.gaps.skillGaps")}),e.jsx(pe,{children:s("employees.dashboard.skills.gaps.skillGapsDesc")})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:["AI/ML Engineering","Blockchain","Quantum Computing","Edge Computing","IoT Security"].map(l=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{children:l}),e.jsx(X,{variant:"outline",className:"text-amber-600 border-amber-200 bg-amber-50",children:"Emerging need"})]},l))})})]}),e.jsxs(W,{children:[e.jsxs(Y,{className:"pb-2",children:[e.jsx(me,{className:"text-lg",children:s("employees.dashboard.skills.gaps.training")}),e.jsx(pe,{children:s("employees.dashboard.skills.gaps.trainingDesc")})]}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:["Cloud Certifications","Agile Leadership","Data Visualization","UX/UI Design","Python for Data"].map(l=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{children:l}),e.jsx(x,{variant:"link",className:"h-8 p-0",children:"View courses"})]},l))})})]})]})})]})})]}),e.jsx(ie,{open:d,onOpenChange:j,children:e.jsxs(ne,{className:"max-w-md",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Add New Skill"}),e.jsx(oe,{children:"Add a new skill to the employee database."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Skill Name"}),e.jsx(H,{placeholder:"Enter skill name",value:p.skillName,onChange:l=>D({...p,skillName:l.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Skill Type"}),e.jsxs(ge,{value:p.skillType,onValueChange:l=>D({...p,skillType:l}),children:[e.jsx(fe,{children:e.jsx(ye,{})}),e.jsxs(Ne,{children:[e.jsx(G,{value:"technical",children:"Technical"}),e.jsx(G,{value:"soft",children:"Soft"}),e.jsx(G,{value:"language",children:"Language"}),e.jsx(G,{value:"certification",children:"Certification"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Skill Level"}),e.jsxs(ge,{value:p.level,onValueChange:l=>D({...p,level:l}),children:[e.jsx(fe,{children:e.jsx(ye,{})}),e.jsxs(Ne,{children:[e.jsx(G,{value:"beginner",children:"Beginner"}),e.jsx(G,{value:"intermediate",children:"Intermediate"}),e.jsx(G,{value:"advanced",children:"Advanced"}),e.jsx(G,{value:"expert",children:"Expert"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Experience (years)"}),e.jsx(H,{type:"number",placeholder:"Years of experience",value:p.experience,onChange:l=>D({...p,experience:parseInt(l.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Employee"}),e.jsx(qe,{value:p.employeeId,onValueChange:Z,placeholder:"Select an employee",employmentStatus:"Active",showSearch:!0,pageSize:10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Department"}),e.jsx(H,{placeholder:"Department (auto-filled)",value:p.department,readOnly:!0,className:"bg-muted"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Job Title"}),e.jsx(H,{placeholder:"Job title (auto-filled)",value:p.jobTitle,readOnly:!0,className:"bg-muted"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(x,{variant:"outline",onClick:z,children:"Cancel"}),e.jsx(x,{onClick:ve,disabled:!p.skillName,children:"Add Skill"})]})]})})]})}function Ia(){const[s,a]=n.useState([]),[o,v]=n.useState([]),[y,c]=n.useState([]),[u,g]=n.useState(!0),[d,j]=n.useState(null),[p,D]=n.useState(!1),[A,r]=n.useState(!1),[N,C]=n.useState(!1),[L,B]=n.useState(null),[m,T]=n.useState(null),[U,J]=n.useState(!1),[be,Z]=n.useState(!1),[ve,z]=n.useState(!1),[l,w]=n.useState(null),[F,h]=n.useState(null),[I,E]=n.useState(null),[se,K]=n.useState(!1),[Pe,xe]=n.useState(null),[Ve,Je]=n.useState(new Set),[Ae,Le]=n.useState(new Set),[i,$]=n.useState(new Set),[k,Q]=n.useState({WorkflowName:"",Description:"",WorkflowStatus:"NotStarted",Progress:0,StartDate:"",TargetDate:""}),[f,V]=n.useState({Title:"",Description:"",DueDate:"",AssignedTo:"",TaskStatus:"Pending"}),[De,Ke]=n.useState({Label:""});n.useEffect(()=>{(async()=>{try{g(!0);const[b,P,O]=await Promise.all([S.onboarding.listWorkflows({sort:"ASC",pageSize:140}),S.onboarding.listTasks({sort:"ASC",pageSize:140}),S.onboarding.listTaskChecklistItems({sort:"ASC",pageSize:140})]);a(b.data),v(P.data),c(O.data)}catch(b){j("Failed to fetch data"),console.error(b)}finally{g(!1)}})()},[]);const bs=t=>{Je(b=>{const P=new Set(b);return P.has(t)?P.delete(t):P.add(t),P})},vs=t=>{Le(b=>{const P=new Set(b);return P.has(t)?P.delete(t):P.add(t),P})},Ds=async()=>{try{const t={...k,Progress:0,WorkflowStatus:"NotStarted",CreatedDate:new Date().toISOString(),UpdatedDate:new Date().toISOString()},b=await S.onboarding.createWorkflow(t),P=await S.onboarding.listWorkflows({sort:"ASC",pageSize:140});a(P.data),D(!1),Q({WorkflowName:"",Description:"",WorkflowStatus:"NotStarted",Progress:0,StartDate:"",TargetDate:""}),M.success("Workflow created successfully")}catch(t){console.error("Error creating workflow:",t),M.error("Failed to create workflow")}},ws=t=>{B(t),Q({WorkflowName:t.WorkflowName,Description:t.Description,WorkflowStatus:t.WorkflowStatus,Progress:t.Progress,StartDate:t.StartDate,TargetDate:t.TargetDate}),r(!0)},ks=async()=>{if(L)try{const t={...k,UpdatedDate:new Date().toISOString()};await S.onboarding.updateWorkflow(L.WorkflowID,t);const b=await S.onboarding.listWorkflows({sort:"ASC",pageSize:140});a(b.data),r(!1),B(null),Q({WorkflowName:"",Description:"",WorkflowStatus:"NotStarted",Progress:0,StartDate:"",TargetDate:""}),M.success("Workflow updated successfully")}catch(t){console.error("Error updating workflow:",t),M.error("Failed to update workflow")}},Ss=t=>{T(t),C(!0)},Cs=async()=>{if(m)try{await S.onboarding.deleteWorkflow(m.WorkflowID);const t=await S.onboarding.listWorkflows({sort:"ASC",pageSize:140});a(t.data),C(!1),T(null),M.success("Workflow deleted successfully")}catch(t){console.error("Error deleting workflow:",t),M.error("Failed to delete workflow")}},Ts=t=>{var b;h(t),V({Title:t.Title,Description:t.Description,DueDate:t.DueDate,AssignedTo:((b=t.AssignedTo)==null?void 0:b.toString())||"",TaskStatus:t.TaskStatus}),Z(!0)},Es=async()=>{if(F)try{await S.onboarding.updateTask(F.TaskID,f);const t=await S.onboarding.listTasks({sort:"ASC",pageSize:140});v(t.data),Z(!1),h(null),V({Title:"",Description:"",DueDate:"",AssignedTo:"",TaskStatus:"Pending"}),M.success("Task updated successfully")}catch(t){console.error("Error updating task:",t),M.error("Failed to update task")}},Is=t=>{E(t),z(!0)},Ps=async()=>{if(I)try{await S.onboarding.deleteTask(I.TaskID);const[t,b]=await Promise.all([S.onboarding.listTasks({sort:"ASC",pageSize:140}),S.onboarding.listTaskChecklistItems({sort:"ASC",pageSize:140})]);v(t.data),c(b.data),z(!1),E(null),M.success("Task deleted successfully")}catch(t){console.error("Error deleting task:",t),M.error("Failed to delete task")}},As=t=>{switch(t){case"Completed":return e.jsxs(X,{variant:"default",className:"gap-1 bg-green-100 text-green-800 hover:bg-green-100",children:[e.jsx(pa,{className:"h-3 w-3"})," Completed"]});case"InProgress":return e.jsxs(X,{variant:"default",className:"gap-1",children:[e.jsx(Qs,{className:"h-3 w-3"})," In Progress"]});case"Overdue":return e.jsxs(X,{variant:"destructive",className:"gap-1",children:[e.jsx(Ks,{className:"h-3 w-3"})," Overdue"]});default:return e.jsx(X,{variant:"outline",className:"gap-1",children:"Pending"})}},Ls=t=>{switch(t){case"Completed":return e.jsx(X,{variant:"default",className:"bg-green-100 text-green-800 hover:bg-green-100",children:"Completed"});case"InProgress":return e.jsx(X,{variant:"default",children:"In Progress"});default:return e.jsx(X,{variant:"outline",children:"Not Started"})}},ke=t=>t?new Date(t).toLocaleDateString("en-US"):"N/A",Os=async()=>{if(l)try{const t={...f,WorkflowID:l,CreatedDate:new Date().toISOString(),UpdatedDate:new Date().toISOString()};await S.onboarding.createTask(t);const[b,P]=await Promise.all([S.onboarding.listTasks({sort:"ASC",pageSize:140}),S.onboarding.listWorkflows({sort:"ASC",pageSize:140})]);v(b.data),a(P.data),J(!1),V({Title:"",Description:"",DueDate:"",AssignedTo:"",TaskStatus:"Pending"}),w(null),M.success("Task created successfully")}catch(t){console.error("Error creating task:",t),M.error("Failed to create task")}},Fs=async()=>{if(Pe)try{const t={TaskID:Pe,Label:De.Label,Completed:!1,CreatedDate:new Date().toISOString(),UpdatedDate:new Date().toISOString()};await S.onboarding.createTaskChecklistItem(t);const b=await S.onboarding.listTaskChecklistItems({sort:"ASC",pageSize:140});c(b.data),K(!1),Ke({Label:""}),xe(null),M.success("Checklist item created successfully")}catch(t){console.error("Error creating checklist item:",t),M.error("Failed to create checklist item")}},Hs=async t=>{try{const b=t.TaskStatus==="Completed"?"Pending":"Completed";await S.onboarding.updateTask(t.TaskID,{...t,TaskStatus:b,UpdatedDate:new Date().toISOString()});const[P,O]=await Promise.all([S.onboarding.listTasks({sort:"ASC",pageSize:140}),S.onboarding.listWorkflows({sort:"ASC",pageSize:140})]);v(P.data),a(O.data),M.success(b==="Completed"?"Task marked as complete":"Task marked as pending")}catch(b){console.error("Error updating task status:",b),M.error("Failed to update task status")}},Ms=async t=>{try{$(b=>new Set(b).add(t.TaskChecklistID)),await S.onboarding.updateTaskChecklistItem(t.TaskChecklistID,{...t,Completed:!0,UpdatedDate:new Date().toISOString()}),c(b=>b.map(P=>P.TaskChecklistID===t.TaskChecklistID?{...P,Completed:!0,UpdatedDate:new Date().toISOString()}:P)),M.success(`Completed: ${t.Label}`)}catch(b){console.error("Error updating checklist item:",b),M.error("Failed to update checklist item")}finally{$(b=>{const P=new Set(b);return P.delete(t.TaskChecklistID),P})}};return u?e.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):d?e.jsx("div",{className:"flex justify-center p-8 text-red-500",children:d}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Onboarding Workflows"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage employee onboarding workflows and tasks"})]}),e.jsxs(x,{onClick:()=>D(!0),children:[e.jsx(Ce,{className:"me-2 h-4 w-4"})," Create Workflow"]})]}),e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsx(W,{children:e.jsx(_,{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No workflows found. Create your first workflow to get started."})})}):s.map(t=>{const b=o.filter(O=>O.WorkflowID===t.WorkflowID),P=Ve.has(t.WorkflowID);return e.jsxs(W,{children:[e.jsx(Y,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>bs(t.WorkflowID),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Fe,{className:`h-5 w-5 transition-transform ${P?"rotate-90":""}`}),e.jsx(me,{className:"text-lg",children:t.WorkflowName}),Ls(t.WorkflowStatus)]}),e.jsx(pe,{className:"mt-2",children:t.Description}),e.jsxs("div",{className:"flex gap-4 mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Start:"}),e.jsx("span",{className:"font-medium",children:ke(t.StartDate)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Target:"}),e.jsx("span",{className:"font-medium",children:ke(t.TargetDate)})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Progress"}),e.jsxs("div",{className:"text-lg font-bold",children:[t.Progress,"%"]})]}),e.jsxs("div",{className:"flex gap-1",onClick:O=>O.stopPropagation(),children:[e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>ws(t),children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>Ss(t),children:e.jsx(Te,{className:"h-4 w-4"})})]})]})]})}),P&&e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Start Date:"}),e.jsx("p",{className:"font-medium",children:ke(t.StartDate)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Target Date:"}),e.jsx("p",{className:"font-medium",children:ke(t.TargetDate)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tasks:"}),e.jsx("p",{className:"font-medium",children:b.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Completed Tasks:"}),e.jsx("p",{className:"font-medium",children:b.filter(O=>O.TaskStatus==="Completed").length})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(x,{size:"sm",onClick:O=>{O.stopPropagation(),w(t.WorkflowID),J(!0)},children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"})," Add Task"]})}),b.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No tasks in this workflow"}):e.jsx("div",{className:"space-y-2",children:b.map(O=>{const Qe=y.filter(q=>q.TaskID===O.TaskID),Xe=Ae.has(O.TaskID);return e.jsxs(W,{children:[e.jsx(Y,{className:"cursor-pointer hover:bg-muted/50 py-3",onClick:()=>vs(O.TaskID),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Fe,{className:`h-4 w-4 transition-transform ${Xe?"rotate-90":""}`}),e.jsx("input",{type:"checkbox",checked:O.TaskStatus==="Completed",onChange:q=>{q.stopPropagation(),Hs(O)},className:"h-4 w-4 rounded"}),e.jsx("span",{className:"font-medium",children:O.Title}),As(O.TaskStatus)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:ke(O.DueDate)}),e.jsxs("div",{className:"flex gap-1",onClick:q=>q.stopPropagation(),children:[e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>Ts(O),children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>Is(O),children:e.jsx(Te,{className:"h-4 w-4"})})]})]})]})}),Xe&&e.jsxs(_,{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:O.Description}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(x,{size:"sm",variant:"outline",onClick:q=>{q.stopPropagation(),xe(O.TaskID),K(!0)},children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"})," Add Checklist Item"]})}),Qe.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No checklist items"}):e.jsx("div",{className:"space-y-2",children:Qe.map(q=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:q.Completed,onChange:()=>Ms(q),disabled:i.has(q.TaskChecklistID),className:"h-4 w-4 rounded"}),e.jsx("span",{className:q.Completed?"line-through text-muted-foreground":"",children:q.Label})]}),i.has(q.TaskChecklistID)&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]},q.TaskChecklistID))})]})]},O.TaskID)})})]})]},t.WorkflowID)})}),e.jsx(ie,{open:U,onOpenChange:J,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Create New Task"}),e.jsx(oe,{children:"Add a new task to the workflow"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Task Title"}),e.jsx(H,{value:f.Title,onChange:t=>V({...f,Title:t.target.value}),placeholder:"e.g., Complete HR paperwork"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:f.Description,onChange:t=>V({...f,Description:t.target.value}),placeholder:"Describe the task..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Due Date"}),e.jsx(we,{date:f.DueDate?new Date(f.DueDate):void 0,onChange:t=>V({...f,DueDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Assigned To"}),e.jsx(qe,{value:f.AssignedTo,onValueChange:t=>V({...f,AssignedTo:t}),placeholder:"Select an employee"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>J(!1),children:"Cancel"}),e.jsx(x,{onClick:Os,disabled:!f.Title,children:"Create Task"})]})]})}),e.jsx(ie,{open:se,onOpenChange:K,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Create New Checklist Item"}),e.jsx(oe,{children:"Add a new checklist item to the task"})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Checklist Item Label"}),e.jsx(H,{value:De.Label,onChange:t=>Ke({...De,Label:t.target.value}),placeholder:"e.g., Sign employment contract"})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),e.jsx(x,{onClick:Fs,disabled:!De.Label,children:"Create Checklist Item"})]})]})}),e.jsx(ie,{open:p,onOpenChange:D,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Create New Workflow"}),e.jsx(oe,{children:"Create a new onboarding workflow for employees"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Workflow Name"}),e.jsx(H,{value:k.WorkflowName,onChange:t=>Q({...k,WorkflowName:t.target.value}),placeholder:"e.g., New Employee Onboarding"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:k.Description,onChange:t=>Q({...k,Description:t.target.value}),placeholder:"Describe the workflow..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(we,{date:k.StartDate?new Date(k.StartDate):void 0,onChange:t=>Q({...k,StartDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Target Date"}),e.jsx(we,{date:k.TargetDate?new Date(k.TargetDate):void 0,onChange:t=>Q({...k,TargetDate:t?format(t,"yyyy-MM-dd"):""})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx(x,{onClick:Ds,disabled:!k.WorkflowName,children:"Create Workflow"})]})]})}),e.jsx(ie,{open:A,onOpenChange:r,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Edit Workflow"}),e.jsx(oe,{children:"Update the workflow details"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Workflow Name"}),e.jsx(H,{value:k.WorkflowName,onChange:t=>Q({...k,WorkflowName:t.target.value}),placeholder:"e.g., New Employee Onboarding"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:k.Description,onChange:t=>Q({...k,Description:t.target.value}),placeholder:"Describe the workflow..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(we,{date:k.StartDate?new Date(k.StartDate):void 0,onChange:t=>Q({...k,StartDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Target Date"}),e.jsx(we,{date:k.TargetDate?new Date(k.TargetDate):void 0,onChange:t=>Q({...k,TargetDate:t?format(t,"yyyy-MM-dd"):""})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(x,{onClick:ks,disabled:!k.WorkflowName,children:"Update Workflow"})]})]})}),e.jsx(ie,{open:N,onOpenChange:C,children:e.jsxs(ne,{className:"max-w-md",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Delete Workflow"}),e.jsxs(oe,{children:['Are you sure you want to delete the workflow "',m==null?void 0:m.WorkflowName,'"? This action cannot be undone.']})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(x,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),e.jsx(x,{variant:"destructive",onClick:Cs,children:"Delete Workflow"})]})]})}),e.jsx(ie,{open:be,onOpenChange:Z,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Edit Task"}),e.jsx(oe,{children:"Update the task details"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Task Title"}),e.jsx(H,{value:f.Title,onChange:t=>V({...f,Title:t.target.value}),placeholder:"Enter task title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{className:"w-full min-h-[100px] px-3 py-2 border rounded-md",value:f.Description,onChange:t=>V({...f,Description:t.target.value}),placeholder:"Describe the task..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Due Date"}),e.jsx(we,{date:f.DueDate?new Date(f.DueDate):void 0,onChange:t=>V({...f,DueDate:t?format(t,"yyyy-MM-dd"):""})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs("select",{value:f.TaskStatus,onChange:t=>V({...f,TaskStatus:t.target.value}),className:"w-full px-3 py-2 border rounded-md",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"InProgress",children:"In Progress"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Overdue",children:"Overdue"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Assigned To"}),e.jsx(qe,{value:f.AssignedTo,onValueChange:t=>V({...f,AssignedTo:t}),placeholder:"Select an employee",employmentStatus:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(x,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),e.jsx(x,{onClick:Es,disabled:!f.Title,children:"Update Task"})]})]})}),e.jsx(ie,{open:ve,onOpenChange:z,children:e.jsxs(ne,{className:"max-w-md",children:[e.jsxs(de,{children:[e.jsx(ce,{children:"Delete Task"}),e.jsxs(oe,{children:['Are you sure you want to delete the task "',I==null?void 0:I.Title,'"? This action cannot be undone and will also delete all associated checklist items.']})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(x,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),e.jsx(x,{variant:"destructive",onClick:Ps,children:"Delete Task"})]})]})})]})}function Pa(){const{t:s}=ue(),[a,o]=n.useState(null),[v,y]=n.useState(!0),[c,u]=n.useState(null),{data:g,isLoading:d}=Ie({queryKey:["employees"],queryFn:async()=>{const r=await S.employees.list({select_fields:"EmployeeID,FirstName,LastName,JobID,ReportsTo,HrDepartmentID,job_JobName,departments_HrDepartmentName",sort:"asc",pageSize:1e3});return(r==null?void 0:r.data)||[]}}),{data:j}=Ie({queryKey:["departments"],queryFn:async()=>{const r=await S.departments.list({});return(r==null?void 0:r.data)||[]}});n.useEffect(()=>{if(!(d||!g||!j))try{const r=new Map,N=new Map;g.forEach(m=>{var T;r.set(m.EmployeeID,{...m,department:m.departments_HrDepartmentName||"No Department",title:m.job_JobName||"No Title",children:[],expanded:!0}),m.ReportsTo&&(N.has(m.ReportsTo)||N.set(m.ReportsTo,[]),(T=N.get(m.ReportsTo))==null||T.push(m.EmployeeID))});const C=m=>{var J;const T=r.get(m);if(!T)return null;const U=((J=N.get(m))==null?void 0:J.map(C).filter(Boolean))||[];return{id:T.EmployeeID,name:`${T.FirstName} ${T.LastName}`,title:T.title,department:T.department,children:U,expanded:!0,hasChildren:U.length>0}},L=Array.from(r.values()).filter(m=>!m.ReportsTo||!r.has(m.ReportsTo)).map(m=>m.EmployeeID);let B;L.length===1?B=C(L[0]):B={id:0,name:s("employees.dashboard.orgChart.virtualRoot"),title:"",department:"",children:L.map(C).filter(Boolean),expanded:!0,hasChildren:L.length>0},o(B)}catch(r){console.error("Error building org chart:",r),u("Failed to load organization chart")}finally{y(!1)}},[g,j,d]);const p=(r,N)=>r.id===N?{...r,expanded:!r.expanded}:r.children?{...r,children:r.children.map(C=>p(C,N))}:r,D=r=>{a&&o(p(a,r))},A=(r,N=0)=>{var B,m;if(!r)return null;const C=r.children&&r.children.length>0,L=r.expanded!==!1;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"relative flex flex-col items-center",children:e.jsxs("div",{className:`flex items-center ${N>0?"mt-4":""}`,children:[C&&e.jsx(x,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>D(r.id),children:L?e.jsx(Xs,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4 rtl:rotate-180"})}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"flex flex-col items-center p-3 border rounded-lg bg-card text-card-foreground shadow-sm",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center mb-2",children:e.jsx(hs,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("div",{className:"text-sm font-medium text-center",children:r.name}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:r.title}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:r.department})]})})]})}),C&&L&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("div",{className:"border-l-2 border-muted h-4"})}),C&&L&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${((B=r.children)==null?void 0:B.length)||1}, 1fr)`},children:(m=r.children)==null?void 0:m.map(T=>e.jsx("div",{className:"flex flex-col items-center",children:A(T,N+1)},T.id))})})]},r.id)};return v?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((r,N)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(he,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(he,{className:"h-4 w-[200px]"}),e.jsx(he,{className:"h-3 w-[150px]"})]})]},N))}):c?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:c}),e.jsx(x,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:s("common.retry")})]}):e.jsx("div",{className:"overflow-x-auto py-4",children:e.jsx("div",{className:"min-w-max",children:a?e.jsx("div",{className:"flex justify-center",children:A(a)}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s("employees.dashboard.orgChart.noData")})})})}function xt(){const{t:s}=ue(),a=os(),{tab:o}=qs(),[v,y]=n.useState(o||"dashboard"),c=Rs(),u=j=>{y(j),a(`/employees/${j}`)},g=Object.entries(c).filter(([j,p])=>p).map(([j])=>j),d=()=>{const j=g.length;return j===1?"grid-cols-1":j===2?"grid-cols-2":j===3?"grid-cols-3":j===4?"grid-cols-4":j===5?"grid-cols-5":"grid-cols-6"};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4"}),e.jsxs(Ge,{dir:s("common.dir",{defaultValue:"ltr"}),value:v,onValueChange:u,className:"space-y-4",children:[e.jsxs(Ye,{className:`grid w-full ${d()}`,children:[c.dashboard&&e.jsxs(te,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(oa,{className:"h-4 w-4"}),s("employees.dashboard.tabs.dashboard")]}),c["org-chart"]&&e.jsxs(te,{value:"org-chart",className:"flex items-center gap-2",children:[e.jsx(ga,{className:"h-4 w-4"}),s("employees.dashboard.tabs.orgChart")]}),c.onboarding&&e.jsxs(te,{value:"onboarding",className:"flex items-center gap-2",children:[e.jsx(ua,{className:"h-4 w-4"}),s("employees.dashboard.tabs.onboarding")]}),c.skills&&e.jsxs(te,{value:"skills",className:"flex items-center gap-2",children:[e.jsx(ja,{className:"h-4 w-4"}),s("employees.dashboard.tabs.skills")]}),c.directory&&e.jsxs(te,{value:"directory",className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),s("employees.dashboard.tabs.directory")]}),c.reports&&e.jsxs(te,{value:"reports",className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),s("employees.dashboard.tabs.reports")]})]}),c.dashboard&&e.jsx(le,{value:"dashboard",children:e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsx(me,{children:s("employees.dashboard.dashboard.title","Employee Dashboard")}),e.jsx(pe,{children:s("employees.dashboard.dashboard.subtitle","Key metrics and insights about your workforce")})]}),e.jsx(_,{children:e.jsx(Ca,{})})]})}),c["org-chart"]&&e.jsx(le,{value:"org-chart",children:e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsx(me,{children:s("employees.dashboard.orgChart.title")}),e.jsx(pe,{children:s("employees.dashboard.orgChart.subtitle")})]}),e.jsx(_,{children:e.jsx(Pa,{})})]})}),c.onboarding&&e.jsx(le,{value:"onboarding",children:e.jsx(Ia,{})}),c.skills&&e.jsx(le,{value:"skills",children:e.jsx(Ea,{})}),c.directory&&e.jsx(le,{value:"directory",children:e.jsx(Ta,{})}),c.reports&&e.jsx(le,{value:"reports",children:e.jsx(va,{})})]})]})}export{Ca as EmployeeDashboardTab,xt as EmployeeDashboardView};
