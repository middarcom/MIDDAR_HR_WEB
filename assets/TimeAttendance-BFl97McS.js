import{l as Ts,r as o,m as Es,aF as Cs,j as e,d as qe,C as R,g as q,u as St,B as v,e as te,f as se,h as Se,t as Ke,i as Ue,k as kt,U as ut,a9 as Is,K as xt,a0 as Os,Q as ft,n as U,S as Dt,R as ze,F as Fs,a5 as Ps,b as Bs,a as C}from"./index-wTZVkADF.js";import{R as _s}from"./ReportViewer-BAZw3NJg.js";import{T as At,a as Ls,b as Y,c as le}from"./tabs-BDkNEZw0.js";import{o as Ms,s as ne,n as We,f as V,u as Hs,t as $s}from"./types-CvUFFGtO.js";import{D as oe,a as ce,b as de,c as me,f as he}from"./dialog-BdVcBJ9D.js";import{I as P}from"./input-C6h3o8yc.js";import{L as k}from"./label-TUJUEAa3.js";import{S as pt}from"./switch-2-vTdeON.js";import{S as zs}from"./ScrollableTabs-BvmnPR7M.js";import{D as Ws,d as ie}from"./index-Coshpif9.js";import Vs from"./EmployeeCheckInOut-CV8ftzaR.js";import{S as ke}from"./skeleton-GFtEftaZ.js";import{A as Je,a as Qe,b as Xe}from"./alert-xuygOnPh.js";import{P as yt}from"./progress-CXwwRaMy.js";import{aO as Us,E as Ys,aP as Rs,u as qs,aQ as Ks,d as Js,aR as Qs,aS as Xs,aT as Gs,ad as Zs,ae as ea,aU as ta,ao as Tt,aV as sa,aW as jt,aK as aa,aM as ra,aN as la,C as na,aL as ia}from"./PieChart-CaVbDP8O.js";import{P as oa}from"./plus-Dn8-dsqn.js";import{P as Ge}from"./pencil-DLVVniBU.js";import{T as Ze}from"./trash-2-B6j_uSKY.js";import{P as ca,b as da,c as ma,C as ha,g as Et}from"./popover-ug8V-G8X.js";import{T as Ct,a as It,b as ue,c as O,d as Ot,e as I}from"./table-BozkyveP.js";import{M as ua}from"./map-pin-a_Q6jDwd.js";import{C as vt}from"./circle-check-big-Co0vDCJb.js";import{C as gt}from"./circle-x-ueIimkuu.js";import{D as Nt}from"./download-TroZ82K8.js";import{U as Ve}from"./upload-BvG2MJfL.js";import"./select-BQ_Ake6Z.js";import"./index-DHNwgL0F.js";import"./date-picker-D_fRaTfC.js";import"./loader-circle-QdenAcYj.js";import"./index-DcfIKM1A.js";import"./checkbox-C5Gi7q3a.js";import"./api-cs99vPjX.js";import"./EmployeeDropdown-RQAVMNBX.js";import"./getDaysInMonth-CyMVXXIZ.js";import"./chevron-left-iuQb-WJc.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=Ts("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);function Ye(){return Ye=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var l=arguments[r];for(var a in l)({}).hasOwnProperty.call(l,a)&&(s[a]=l[a])}return s},Ye.apply(null,arguments)}function bt(s,r){var l=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);r&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),l.push.apply(l,a)}return l}function fa(s){for(var r=1;r<arguments.length;r++){var l=arguments[r]!=null?arguments[r]:{};r%2?bt(Object(l),!0).forEach(function(a){et(s,a,l[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):bt(Object(l)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(l,a))})}return s}function et(s,r,l){return(r=pa(r))in s?Object.defineProperty(s,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[r]=l,s}function pa(s){var r=ya(s,"string");return typeof r=="symbol"?r:r+""}function ya(s,r){if(typeof s!="object"||!s)return s;var l=s[Symbol.toPrimitive];if(l!==void 0){var a=l.call(s,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}var H=32;class tt extends o.PureComponent{renderIcon(r,l){var{inactiveColor:a}=this.props,c=H/2,h=H/6,g=H/3,d=r.inactive?a:r.color,N=l??r.type;if(N==="none")return null;if(N==="plainline")return o.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:c,x2:H,y2:c,className:"recharts-legend-icon"});if(N==="line")return o.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(c,"h").concat(g,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*g,",").concat(c,`
            H`).concat(H,"M").concat(2*g,",").concat(c,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(g,",").concat(c),className:"recharts-legend-icon"});if(N==="rect")return o.createElement("path",{stroke:"none",fill:d,d:"M0,".concat(H/8,"h").concat(H,"v").concat(H*3/4,"h").concat(-H,"z"),className:"recharts-legend-icon"});if(o.isValidElement(r.legendIcon)){var y=fa({},r);return delete y.legendIcon,o.cloneElement(r.legendIcon,y)}return o.createElement(Us,{fill:d,cx:c,cy:c,size:H,sizeType:"diameter",type:N})}renderItems(){var{payload:r,iconSize:l,layout:a,formatter:c,inactiveColor:h,iconType:g}=this.props,d={x:0,y:0,width:H,height:H},N={display:a==="horizontal"?"inline-block":"block",marginRight:10},y={display:"inline-block",verticalAlign:"middle",marginRight:4};return r.map((f,S)=>{var m=f.formatter||c,p=Es({"recharts-legend-item":!0,["legend-item-".concat(S)]:!0,inactive:f.inactive});if(f.type==="none")return null;var z=f.inactive?h:f.color,B=m?m(f.value,f,S):f.value;return o.createElement("li",Ye({className:p,style:N,key:"legend-item-".concat(S)},Ys(this.props,f,S)),o.createElement(Rs,{width:l,height:l,viewBox:d,style:y,"aria-label":"".concat(B," legend icon")},this.renderIcon(f,g)),o.createElement("span",{className:"recharts-legend-item-text",style:{color:z}},B))})}render(){var{payload:r,layout:l,align:a}=this.props;if(!r||!r.length)return null;var c={padding:0,margin:0,textAlign:l==="horizontal"?a:"left"};return o.createElement("ul",{className:"recharts-default-legend",style:c},this.renderItems())}}et(tt,"displayName","Legend");et(tt,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});function ja(){return qs(Ks)}var va=["contextPayload"];function Re(){return Re=Object.assign?Object.assign.bind():function(s){for(var r=1;r<arguments.length;r++){var l=arguments[r];for(var a in l)({}).hasOwnProperty.call(l,a)&&(s[a]=l[a])}return s},Re.apply(null,arguments)}function wt(s,r){var l=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);r&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),l.push.apply(l,a)}return l}function ae(s){for(var r=1;r<arguments.length;r++){var l=arguments[r]!=null?arguments[r]:{};r%2?wt(Object(l),!0).forEach(function(a){st(s,a,l[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):wt(Object(l)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(l,a))})}return s}function st(s,r,l){return(r=ga(r))in s?Object.defineProperty(s,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):s[r]=l,s}function ga(s){var r=Na(s,"string");return typeof r=="symbol"?r:r+""}function Na(s,r){if(typeof s!="object"||!s)return s;var l=s[Symbol.toPrimitive];if(l!==void 0){var a=l.call(s,r||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(s)}function ba(s,r){if(s==null)return{};var l,a,c=wa(s,r);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(s);for(a=0;a<h.length;a++)l=h[a],r.indexOf(l)===-1&&{}.propertyIsEnumerable.call(s,l)&&(c[l]=s[l])}return c}function wa(s,r){if(s==null)return{};var l={};for(var a in s)if({}.hasOwnProperty.call(s,a)){if(r.indexOf(a)!==-1)continue;l[a]=s[a]}return l}function Sa(s){return s.value}function ka(s){var{contextPayload:r}=s,l=ba(s,va),a=ta(r,s.payloadUniqBy,Sa),c=ae(ae({},l),{},{payload:a});return o.isValidElement(s.content)?o.cloneElement(s.content,c):typeof s.content=="function"?o.createElement(s.content,c):o.createElement(tt,c)}function Da(s,r,l,a,c,h){var{layout:g,align:d,verticalAlign:N}=r,y,f;return(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))&&(d==="center"&&g==="vertical"?y={left:((a||0)-h.width)/2}:y=d==="right"?{right:l&&l.right||0}:{left:l&&l.left||0}),(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))&&(N==="middle"?f={top:((c||0)-h.height)/2}:f=N==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0}),ae(ae({},y),f)}function Aa(s){var r=Tt();return o.useEffect(()=>{r(sa(s))},[r,s]),null}function Ta(s){var r=Tt();return o.useEffect(()=>(r(jt(s)),()=>{r(jt({width:0,height:0}))}),[r,s]),null}function Ea(s){var r=ja(),l=Qs(),a=Xs(),{width:c,height:h,wrapperStyle:g,portal:d}=s,[N,y]=Gs([r]),f=Zs(),S=ea();if(f==null||S==null)return null;var m=f-(a.left||0)-(a.right||0),p=De.getWidthOrHeight(s.layout,h,c,m),z=d?g:ae(ae({position:"absolute",width:(p==null?void 0:p.width)||c||"auto",height:(p==null?void 0:p.height)||h||"auto"},Da(g,s,a,f,S,N)),g),B=d??l;if(B==null)return null;var _=o.createElement("div",{className:"recharts-legend-wrapper",style:z,ref:y},o.createElement(Aa,{layout:s.layout,align:s.align,verticalAlign:s.verticalAlign,itemSorter:s.itemSorter}),o.createElement(Ta,{width:N.width,height:N.height}),o.createElement(ka,Re({},s,p,{margin:a,chartWidth:f,chartHeight:S,contextPayload:r})));return Cs.createPortal(_,B)}class De extends o.PureComponent{static getWidthOrHeight(r,l,a,c){return r==="vertical"&&Js(l)?{height:l}:r==="horizontal"?{width:a||c}:null}render(){return o.createElement(Ea,this.props)}}st(De,"displayName","Legend");st(De,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});const Ca=()=>{const[s,r]=o.useState("daily_attendance"),l=[{key:"start_date",label:"Start Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]},{key:"end_date",label:"End Date",type:"date",defaultValue:new Date().toISOString().split("T")[0]},{key:"employee_id",label:"Employee ID",type:"text"}],c={daily_attendance:{type:"time_attendance_daily",title:"Daily Attendance Report",description:"Detailed view of employee check-in/out times for a specific date range.",columns:[{key:"EmployeeID",label:"ID"},{key:"EmployeeName",label:"Name"},{key:"AttendanceDate",label:"Date",format:h=>h?new Date(h).toLocaleDateString():"-"},{key:"CheckInTime",label:"Check In"},{key:"CheckOutTime",label:"Check Out"},{key:"TotalHoursWorked",label:"Hours",format:h=>h?Number(h).toFixed(2):"-"},{key:"Status",label:"Status",format:h=>e.jsx(qe,{variant:h==="Present"?"default":h==="Absent"?"destructive":"secondary",children:h})}],filters:[...l]},monthly_summary:{type:"time_attendance_monthly_summary",title:"Monthly Attendance Summary",description:"Aggregated attendance data per employee for the month.",columns:[{key:"EmployeeName",label:"Name"},{key:"TotalPresent",label:"Days Present"},{key:"TotalAbsent",label:"Days Absent"},{key:"TotalLate",label:"Days Late"},{key:"TotalOvertimeHours",label:"Overtime (Hrs)",format:h=>Number(h).toFixed(2)}],filters:[{key:"month",label:"Month",type:"date",defaultValue:new Date().toISOString().slice(0,7)}]},shift_adherence:{type:"shift_adherence_report",title:"Shift Adherence Report",description:"Comparison of scheduled shift hours vs actual worked hours.",columns:[{key:"EmployeeName",label:"Name"},{key:"ShiftName",label:"Shift"},{key:"PlannedHours",label:"Planned"},{key:"ActualHours",label:"Actual"},{key:"Variance",label:"Variance",format:h=>e.jsx("span",{className:Number(h)<0?"text-red-500":"text-green-500",children:h?Number(h).toFixed(2):"-"})}],filters:[...l]}}[s];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{children:e.jsx(q,{className:"p-4",children:e.jsx(At,{value:s,onValueChange:r,className:"w-full",children:e.jsxs(Ls,{className:"grid w-full grid-cols-3",children:[e.jsx(Y,{value:"daily_attendance",children:"Daily Attendance"}),e.jsx(Y,{value:"monthly_summary",children:"Monthly Summary"}),e.jsx(Y,{value:"shift_adherence",children:"Shift Adherence"})]})})})}),e.jsx(_s,{reportType:c.type,title:c.title,description:c.description,columns:c.columns,filterFields:c.filters,disableAutoFetch:!0})]})},Ia=Ms({name:ne().min(1,"Name is required"),description:ne().optional(),startTime:ne().min(1,"Start time is required"),endTime:ne().min(1,"End time is required"),breakMinutes:We().min(0).default(60),delayTimeAllowed:We().min(0).default(15),overtimeAllow:V().default(!1),overtimeHours:We().min(0).default(0),isActive:V().default(!0),monday:V().default(!1),tuesday:V().default(!1),wednesday:V().default(!1),thursday:V().default(!1),friday:V().default(!1),saturday:V().default(!1),sunday:V().default(!1),notes:ne().optional()});function Oa({open:s,onOpenChange:r,onSubmit:l,initialData:a,loading:c=!1}){const[h,g]=o.useState(!1);St();const d=Hs({resolver:$s(Ia),defaultValues:{name:"",description:"",startTime:"09:00",endTime:"17:00",breakMinutes:60,delayTimeAllowed:15,overtimeAllow:!1,overtimeHours:0,isActive:!0,sunday:!0,monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!1,saturday:!0}});o.useEffect(()=>{if(a){const y=f=>f?f.includes(":")?f.substring(0,5):f:"09:00";d.reset({name:a.name||a.ShiftName||"",description:a.description||a.Description||"",startTime:y(a.startTime||a.CheckInTime),endTime:y(a.endTime||a.CheckOutTime),breakMinutes:a.breakMinutes||a.BreakMinutes||a.breakDuration||60,delayTimeAllowed:a.delayTimeAllowed||a.DelayTimeAllowed||15,overtimeAllow:!!(a.overtimeAllow||a.OvertimeAllow===1||a.OvertimeAllow===!0),overtimeHours:parseFloat(a.overtimeHours||a.OvertimeHours||0),isActive:a.isActive!==void 0?a.isActive:a.Status==="Active"||a.status==="Active"||!0,monday:!!(a.monday||a.Monday),tuesday:!!(a.tuesday||a.Tuesday),wednesday:!!(a.wednesday||a.Wednesday),thursday:!!(a.thursday||a.Thursday),friday:!!(a.friday||a.Friday),saturday:!!(a.saturday||a.Saturday),sunday:!!(a.sunday||a.Sunday),notes:a.notes||a.Notes||""})}else s&&d.reset({name:"",description:"",startTime:"09:00",endTime:"17:00",breakMinutes:60,delayTimeAllowed:15,overtimeAllow:!1,overtimeHours:0,isActive:!0,sunday:!0,monday:!0,tuesday:!0,wednesday:!0,thursday:!0,friday:!1,saturday:!0,notes:""})},[a,s,d]);const N=async y=>{try{g(!0);const f=m=>m?m.split(":").length===2?`${m}:00`:m:"00:00:00",S={...y,startTime:f(y.startTime),endTime:f(y.endTime)};await l(S),r(!1)}catch(f){console.error("Error submitting shift:",f)}finally{g(!1)}};return e.jsx(oe,{open:s,onOpenChange:r,children:e.jsxs(ce,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsx(me,{className:"text-xl font-bold",children:a?"Edit Shift":"Create New Shift"})}),e.jsxs("form",{onSubmit:d.handleSubmit(N),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Shift Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"name",children:"Shift Name *"}),e.jsx(P,{id:"name",placeholder:"Enter shift name",...d.register("name")}),d.formState.errors.name&&e.jsx("p",{className:"text-sm text-red-500",children:d.formState.errors.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"description",children:"Description"}),e.jsx(P,{id:"description",placeholder:"Enter shift description",...d.register("description")})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Shift Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"startTime",children:"Start Time *"}),e.jsx(P,{id:"startTime",type:"time",...d.register("startTime")}),d.formState.errors.startTime&&e.jsx("p",{className:"text-sm text-red-500",children:d.formState.errors.startTime.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"endTime",children:"End Time *"}),e.jsx(P,{id:"endTime",type:"time",...d.register("endTime")}),d.formState.errors.endTime&&e.jsx("p",{className:"text-sm text-red-500",children:d.formState.errors.endTime.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"breakMinutes",children:"Break Duration (minutes)"}),e.jsx(P,{id:"breakMinutes",type:"text",placeholder:"60",...d.register("breakMinutes",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"delayTimeAllowed",children:"Delay Allowed (minutes)"}),e.jsx(P,{id:"delayTimeAllowed",type:"number",min:"0",...d.register("delayTimeAllowed",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Overtime Settings"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(pt,{id:"overtimeAllow",checked:d.watch("overtimeAllow"),onCheckedChange:y=>d.setValue("overtimeAllow",y)}),e.jsx(k,{htmlFor:"overtimeAllow",children:"Allow Overtime"})]}),d.watch("overtimeAllow")&&e.jsx("div",{className:"mt-2",children:e.jsx(P,{id:"overtimeHours",type:"number",min:"0",step:"0.5",placeholder:"Max overtime hours",...d.register("overtimeHours",{valueAsNumber:!0})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(pt,{id:"isActive",checked:d.watch("isActive"),onCheckedChange:y=>d.setValue("isActive",y)}),e.jsx(k,{htmlFor:"isActive",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Shift Schedule"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{id:"sunday",label:"Sunday"},{id:"monday",label:"Monday"},{id:"tuesday",label:"Tuesday"},{id:"wednesday",label:"Wednesday"},{id:"thursday",label:"Thursday"},{id:"friday",label:"Friday"},{id:"saturday",label:"Saturday"}].map(y=>e.jsxs("div",{className:"flex items-center space-x-2 border p-3 rounded-md",children:[e.jsx("input",{type:"checkbox",id:y.id,...d.register(y.id),className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx(k,{htmlFor:y.id,className:"font-medium cursor-pointer",children:y.label})]},y.id))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"notes",children:"Notes"}),e.jsx(P,{id:"notes",placeholder:"Additional notes",...d.register("notes")})]})]}),e.jsxs(he,{children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>r(!1),disabled:h||c,children:"Cancel"}),e.jsx(v,{type:"submit",disabled:h||c,children:h||c?"Saving...":"Save"})]})]})]})})}const we=({title:s,value:r,subtitle:l="",icon:a,className:c=""})=>e.jsx(R,{className:c,children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:s}),e.jsx("h3",{className:"text-2xl font-bold",children:r}),l&&e.jsx("p",{className:"text-xs text-muted-foreground",children:l})]})})});function Fa({dashboardMetrics:s,loading:r,error:l}){return e.jsxs(R,{children:[e.jsxs(te,{children:[e.jsx(se,{children:"Attendance Overview"}),e.jsx(Se,{children:"Today's attendance statistics and metrics"})]}),e.jsx(q,{children:r.dashboard?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((a,c)=>e.jsx(ke,{className:"h-32 w-full"},c))}):l.dashboard?e.jsxs(Je,{variant:"destructive",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx(Qe,{children:"Error"}),e.jsx(Xe,{children:l.dashboard})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(we,{title:"Total Employees",value:s.totalEmployees,className:"border"}),e.jsx(we,{title:"Present Today",value:s.presentToday,subtitle:`${s.onTimeToday} on time, ${s.lateToday} late`,className:"border"}),e.jsx(we,{title:"Absent Today",value:s.absentToday,className:"border"}),e.jsx(we,{title:"Active Shifts",value:s.activeShifts,subtitle:`${s.totalShifts} total`,className:"border"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{children:[e.jsx(te,{children:e.jsx(se,{children:"Attendance Status"})}),e.jsx(q,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(aa,{width:"100%",height:"100%",children:e.jsxs(ra,{children:[e.jsx(la,{data:[{name:"Present",value:s.presentToday,color:"#10B981"},{name:"Absent",value:s.absentToday,color:"#EF4444"},{name:"Late",value:s.lateToday,color:"#F59E0B"}],cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:a,percent:c})=>`${a}: ${(c*100).toFixed(0)}%`,children:[{name:"Present",color:"#10B981"},{name:"Absent",color:"#EF4444"},{name:"Late",color:"#F59E0B"}].map((a,c)=>e.jsx(na,{fill:a.color},`cell-${c}`))}),e.jsx(ia,{formatter:(a,c)=>[a,c]}),e.jsx(De,{})]})})})})]}),e.jsxs(R,{children:[e.jsx(te,{children:e.jsx(se,{children:"Work Hours"})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Average Hours Worked"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.averageHours.toFixed(1),"h"]})]}),e.jsx(yt,{value:s.averageHours/8*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:"Overtime Today"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.overtimeToday.toFixed(1),"h"]})]}),e.jsx(yt,{value:Math.min(s.overtimeToday*10,100),className:"h-2"})]})]})})]})]})]})})]})}function Pa({shiftsData:s,shiftAssignments:r,totalShifts:l,loading:a,error:c,shiftsPage:h,setShiftsPage:g,pageSize:d,expandedShift:N,setExpandedShift:y,setShowCreateShift:f,handleEditShift:S,handleAssignEmployee:m,handleUnassignEmployee:p,handleDeleteShift:z}){const B=u=>r.filter(b=>b.ShiftID===u&&b.IsActive),_=u=>u?u.substring(0,5):"--:--",re=u=>{const b=[];return u.Sunday&&b.push("Sun"),u.Monday&&b.push("Mon"),u.Tuesday&&b.push("Tue"),u.Wednesday&&b.push("Wed"),u.Thursday&&b.push("Thu"),u.Friday&&b.push("Fri"),u.Saturday&&b.push("Sat"),b.length>0?b.join(", "):"No days"};return e.jsx("div",{className:"space-y-4",children:e.jsxs(R,{children:[e.jsx(te,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(se,{children:"Shift Management"}),e.jsx(Se,{children:"View shifts, assign employees, and manage schedules"})]}),e.jsxs(v,{onClick:()=>f(!0),children:[e.jsx(oa,{className:"h-4 w-4 mr-2"}),"Add Shift"]})]})}),e.jsx(q,{children:a.shifts?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((u,b)=>e.jsx(ke,{className:"h-12 w-full"},b))}):c.shifts?e.jsxs(Je,{variant:"destructive",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx(Qe,{children:"Error"}),e.jsx(Xe,{children:c.shifts})]}):s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No shifts found. Create your first shift to get started."}):e.jsxs("div",{className:"space-y-4",children:[s.map(u=>{const b=B(u.ShiftID),K=N===u.ShiftID;return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 cursor-pointer bg-white",onClick:()=>y(K?null:u.ShiftID),children:[e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Shift Name"}),e.jsx("p",{className:"font-semibold text-base",children:u.ShiftName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Working Hours"}),e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[e.jsx(Ue,{className:"h-4 w-4"}),u.CheckInTime&&u.CheckOutTime?`${_(u.CheckInTime)} - ${_(u.CheckOutTime)}`:"Not set"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Working Days"}),e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[e.jsx(kt,{className:"h-4 w-4"}),re(u)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Assigned Employees"}),e.jsxs("p",{className:"font-medium flex items-center gap-1",children:[e.jsx(ut,{className:"h-4 w-4"}),b.length," employee",b.length!==1?"s":""]})]})]}),e.jsx(Is,{className:`h-5 w-5 ml-4 transition-transform ${K?"rotate-180":""}`})]}),K&&e.jsx("div",{className:"border-t bg-gray-50",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-In Time"}),e.jsx("p",{className:"font-medium",children:_(u.CheckInTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Check-Out Time"}),e.jsx("p",{className:"font-medium",children:_(u.CheckOutTime)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Break Duration"}),e.jsxs("p",{className:"font-medium",children:[u.BreakDuration||0," min"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Delay Allowed"}),e.jsxs("p",{className:"font-medium",children:[u.DelayTimeAllowed||0," min"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overtime Allow"}),e.jsx("p",{className:"font-medium",children:u.OvertimeAllow?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overtime Hours"}),e.jsxs("p",{className:"font-medium",children:[u.OvertimeHours||0," hrs"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(qe,{variant:u.IsActive?"default":"secondary",children:u.IsActive?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Created"}),e.jsx("p",{className:"font-medium text-sm",children:u.CreatedDate?new Date(u.CreatedDate).toLocaleDateString():"N/A"})]})]}),u.Description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Description"}),e.jsx("p",{className:"font-medium text-sm",children:u.Description})]}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(ut,{className:"h-4 w-4"}),"Assigned Employees (",b.length,")"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:D=>{D.stopPropagation(),m(u)},className:"gap-2",children:[e.jsx(xt,{className:"h-4 w-4"}),"Assign Employee"]})]}),b.length===0?e.jsx("div",{className:"text-center py-4 text-muted-foreground text-sm bg-white rounded border",children:"No employees assigned to this shift yet"}):e.jsx("div",{className:"space-y-2",children:b.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(xt,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:D.EmployeeName||`Employee #${D.EmployeeID}`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:D.EmployeeCode||`ID: ${D.EmployeeID}`})]})]}),e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>p(u.ShiftID,D.EmployeeID),className:"text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(Os,{className:"h-4 w-4"})})]},D.ShiftEmployeesID))})]}),e.jsxs("div",{className:"flex space-x-2 pt-4 border-t",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:D=>{D.stopPropagation(),S(u)},children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Edit Shift"]}),e.jsxs(v,{variant:"outline",size:"sm",className:"text-red-500 hover:text-red-600 hover:bg-red-50",onClick:D=>{D.stopPropagation(),z(u.ShiftID.toString())},children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Delete Shift"]})]})]})})]},u.ShiftID)}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min((h-1)*d+1,s.length)})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(h*d,s.length)})," ","of ",e.jsx("span",{className:"font-medium",children:s.length})," shifts"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>g(u=>Math.max(1,u-1)),disabled:h===1||a.shifts,children:"Previous"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>g(u=>u+1),disabled:h*d>=s.length||a.shifts,children:"Next"})]})]})]})})]})})}function Ba({className:s,date:r,onDateChange:l,placeholder:a="Pick a date"}){return e.jsx("div",{className:ft("grid gap-2",s),children:e.jsxs(ca,{children:[e.jsx(da,{asChild:!0,children:e.jsxs(v,{id:"date",variant:"outline",className:ft("w-[300px] justify-start text-left font-normal",!r&&"text-muted-foreground"),children:[e.jsx(kt,{className:"mr-2 h-4 w-4"}),r!=null&&r.from?r.to?e.jsxs(e.Fragment,{children:[U(r.from,"LLL dd, y")," -"," ",U(r.to,"LLL dd, y")]}):U(r.from,"LLL dd, y"):e.jsx("span",{children:a})]})}),e.jsx(ma,{className:"w-auto p-0",align:"start",children:e.jsx(ha,{initialFocus:!0,mode:"range",defaultMonth:r==null?void 0:r.from,selected:r,onSelect:l,numberOfMonths:2})})]})})}function _a({attendanceData:s,loading:r,error:l,dateRange:a,setDateRange:c,searchText:h,setSearchText:g,currentPage:d,setCurrentPage:N,pageSize:y,totalRows:f,handleEditAttendance:S,handleDeleteAttendance:m}){return e.jsxs(R,{children:[e.jsxs(te,{children:[e.jsx(se,{children:"Attendance Tracking"}),e.jsx(Se,{children:"Daily attendance records and management"})]}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"search",children:"Search Employees"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(Dt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(P,{id:"search",placeholder:"Search by name or employee ID...",value:h,onChange:p=>g(p.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(k,{children:"Date Range"}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-2",children:[e.jsx(Ba,{date:a,onDateChange:c,placeholder:"Select date range"}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>c({from:new Date,to:new Date}),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Today"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>c({from:Et(new Date,7),to:new Date}),children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Last 7 Days"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{const p=new Date;c({from:new Date(p.getFullYear(),p.getMonth(),1),to:p})},children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"This Month"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ua,{className:"h-4 w-4 mr-2"}),"Geofencing"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(xa,{className:"h-4 w-4 mr-2"}),"Biometric"]})]})]})]}),r.attendance?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((p,z)=>e.jsx(ke,{className:"h-12 w-full"},z))}):l.attendance?e.jsxs(Je,{variant:"destructive",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx(Qe,{children:"Error"}),e.jsx(Xe,{children:l.attendance})]}):s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No attendance records found."}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Ct,{children:[e.jsx(It,{children:e.jsxs(ue,{children:[e.jsx(O,{children:"Employee ID"}),e.jsx(O,{children:"Employee Name"}),e.jsx(O,{className:"w-[200px]",children:"Attendance Date"}),e.jsx(O,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(Ot,{children:s.map(p=>e.jsxs(ue,{className:"h-12",children:[e.jsx(I,{className:"font-medium",children:p.EmployeeID}),e.jsx(I,{children:p.EmployeeName||`${p.employees_FirstName} ${p.employees_LastName}`}),e.jsx(I,{children:p.AttendanceDate?U(new Date(p.AttendanceDate),"MMM d, yyyy h:mm a"):"-"}),e.jsx(I,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>S(p),className:"h-8 w-8 p-0",children:e.jsx(Ge,{className:"h-4 w-4"})}),e.jsx(v,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600",onClick:()=>m(p.AttendanceID.toString()),children:e.jsx(Ze,{className:"h-4 w-4"})})]})})]},p.AttendanceID))})]}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min((d-1)*y+1,f)})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(d*y,f)})," ","of ",e.jsx("span",{className:"font-medium",children:f})," records"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>N(p=>Math.max(1,p-1)),disabled:d===1||r.attendance,children:"Previous"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>N(p=>p+1),disabled:d*y>=f||r.attendance,children:"Next"})]})]})]})})]})})]})}function La({shiftBookData:s,totalShiftBookRecords:r,loading:l,error:a,searchText:c,setSearchText:h,shiftBookPage:g,setShiftBookPage:d,pageSize:N,handleEditShiftBook:y,handleDeleteShiftBook:f,getStatusVariant:S}){return e.jsxs(R,{children:[e.jsxs(te,{children:[e.jsx(se,{children:"Shift Records"}),e.jsx(Se,{children:"Detailed shift booking and attendance records"})]}),e.jsxs(q,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(k,{htmlFor:"search",children:"Search Records"}),e.jsxs("div",{className:"relative",children:[e.jsx(Dt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(P,{id:"search",placeholder:"Search by employee name or shift...",value:c,onChange:m=>h(m.target.value),className:"pl-10"})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs(v,{variant:"outline",children:[e.jsx(Fs,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),l.shiftBook?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((m,p)=>e.jsx(ke,{className:"h-12 w-full"},p))}):e.jsxs(Ct,{children:[e.jsx(It,{children:e.jsxs(ue,{children:[e.jsx(O,{children:"Employee ID"}),e.jsx(O,{children:"Shift ID"}),e.jsx(O,{children:"Date"}),e.jsx(O,{children:"Check-In"}),e.jsx(O,{children:"Check-Out"}),e.jsx(O,{children:"Total Hours"}),e.jsx(O,{children:"Overtime"}),e.jsx(O,{children:"Absent"}),e.jsx(O,{children:"Delay"}),e.jsx(O,{children:"Leave"}),e.jsx(O,{children:"Status"}),e.jsx(O,{children:"Notes"}),e.jsx(O,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(Ot,{children:s.length>0?s.map(m=>e.jsxs(ue,{children:[e.jsx(I,{children:m.EmployeeID}),e.jsx(I,{children:m.ShiftBookID}),e.jsx(I,{children:m.ShiftBookDate}),e.jsx(I,{children:m.CheckInTime||"-"}),e.jsx(I,{children:m.CheckOutTime||"-"}),e.jsx(I,{children:m.TotalHoursWorked||"-"}),e.jsx(I,{children:m.OvertimeHours||"-"}),e.jsx(I,{children:m.Absent?e.jsx(vt,{className:"h-4 w-4 text-red-500"}):e.jsx(gt,{className:"h-4 w-4 text-gray-300"})}),e.jsx(I,{children:m.DelayHours||"-"}),e.jsx(I,{children:m.Leave?e.jsx(vt,{className:"h-4 w-4 text-green-500"}):e.jsx(gt,{className:"h-4 w-4 text-gray-300"})}),e.jsx(I,{children:e.jsx(qe,{variant:S(m.Status||""),children:m.Status})}),e.jsx(I,{className:"max-w-[200px] truncate",children:m.Notes||"-"}),e.jsx(I,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>y(m),className:"h-8 w-8 p-0",children:e.jsx(Ge,{className:"h-4 w-4"})}),e.jsx(v,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600",onClick:()=>{var p;return f(m.key||((p=m.ShiftBookID)==null?void 0:p.toString())||`${m.EmployeeID}-${m.ShiftBookDate}`)},children:e.jsx(Ze,{className:"h-4 w-4"})})]})})]},m.key||m.ShiftBookID||`${m.EmployeeID}-${m.ShiftBookDate}`)):e.jsx(ue,{children:e.jsx(I,{colSpan:13,className:"h-24 text-center",children:l.shiftBook?"Loading shift book data...":"No shift book records found"})})})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:s.length>0?e.jsxs(e.Fragment,{children:["Showing ",e.jsx("span",{className:"font-medium",children:(g-1)*N+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(g*N,r)})," ","of ",e.jsx("span",{className:"font-medium",children:r})," records"]}):"No records found"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>d(m=>Math.max(1,m-1)),disabled:g===1||l.shiftBook,children:"Previous"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>d(m=>m+1),disabled:g*N>=r||l.shiftBook,children:"Next"})]})]})]})]})}const gr=()=>{o.useRef(null);const{tab:s}=Ps(),r=Bs(),l=s||"dashboard",{toast:a}=St(),[c,h]=o.useState(!1),[g,d]=o.useState(null),[N,y]=o.useState(!1),[f,S]=o.useState(null),[m,p]=o.useState(""),[z,B]=o.useState(""),[_,re]=o.useState([]),[u,b]=o.useState(!1),[K,D]=o.useState(""),[Ft,xe]=o.useState(0),[Ae,Te]=o.useState(!0),[Ee,at]=o.useState(!1),[Pt,fe]=o.useState(!1),[Ma,Bt]=o.useState(!1),[_t,Ce]=o.useState(!1),[Lt,pe]=o.useState(!1),[rt,Ie]=o.useState(null),[lt,nt]=o.useState(!1),[J,Oe]=o.useState([]),[Mt,Fe]=o.useState(!1),[W,it]=o.useState(""),[T,Ht]=o.useState({from:Et(new Date,7),to:new Date}),[ye,$t]=o.useState(1),[Pe,zt]=o.useState(1),[Be,Wt]=o.useState(1),[G]=o.useState(10),[Vt,Ut]=o.useState(0),[je,A]=o.useState({attendance:!1,shifts:!1,shiftBook:!1,dashboard:!1}),[ve,L]=o.useState({attendance:null,shifts:null,shiftBook:null,dashboard:null}),[Yt,Rt]=o.useState({totalEmployees:0,presentToday:0,absentToday:0,lateToday:0,onTimeToday:0,overtimeToday:0,averageHours:0,totalShifts:0,activeShifts:0}),[qt,Kt]=o.useState([]),[Jt,Qt]=o.useState(0),[Xt,Gt]=o.useState(null),[_e,Zt]=o.useState([]),[es,ts]=o.useState([]),[E,Z]=o.useState(null),[ss,ot]=o.useState([]),[as,ct]=o.useState(0),dt=async()=>{A(t=>({...t,dashboard:!0})),L(t=>({...t,dashboard:null}));try{const t=ie().format("YYYY-MM-DD"),[i,n,x]=await Promise.all([C.timeattendance.list({startDate:t,endDate:t,page:0,pageSize:1e3}),C.employees.list({select_fields:"EmployeeID,employees_FirstName,employees_LastName",filters:JSON.stringify({EmploymentStatus:"Active"})}),C.shifts.list({})]),w=(Array.isArray(n==null?void 0:n.data)?n.data:[]).length,M=Array.isArray(i==null?void 0:i.data)?i.data:[],Q=new Set(M.filter(F=>F&&(F.Status==="Present"||F.Status==="Late")&&F.EmployeeID).map(F=>F.EmployeeID)).size,X=Math.max(0,w-Q),be=M.filter(F=>F&&F.Status==="Late").length,$=Math.max(0,Q-be),{totalOvertime:He,totalHoursWorked:ks}=M.reduce((F,$e)=>$e?{totalOvertime:F.totalOvertime+(Number($e.OvertimeMinutes)||0)/60,totalHoursWorked:F.totalHoursWorked+(Number($e.TotalMinutesWorked)||0)/60}:F,{totalOvertime:0,totalHoursWorked:0}),Ds=Q>0?ks/Q:0,ht=Array.isArray(x==null?void 0:x.data)?x.data:[],As=ht.filter(F=>F&&F.Status==="Active").length;Rt({totalEmployees:w,presentToday:Q,absentToday:X,lateToday:be,onTimeToday:$,overtimeToday:parseFloat(He.toFixed(2)),averageHours:parseFloat(Ds.toFixed(2)),totalShifts:ht.length,activeShifts:As})}catch(t){console.error("Error fetching dashboard metrics:",t),L(i=>({...i,dashboard:t instanceof Error?t.message:"Failed to fetch dashboard metrics."}))}finally{A(t=>({...t,dashboard:!1}))}},ge=async()=>{if(l==="shifts"){A(t=>({...t,shifts:!0})),L(t=>({...t,shifts:null}));try{const t=await C.shifts.list({page:Pe-1,pageSize:G,field:"ShiftName",sort:"ASC"}),i=(t.data||[]).map(n=>{const x=[];n.monday&&x.push("Mon"),n.tuesday&&x.push("Tue"),n.wednesday&&x.push("Wed"),n.thursday&&x.push("Thu"),n.friday&&x.push("Fri"),n.saturday&&x.push("Sat"),n.sunday&&x.push("Sun");const j=w=>w?ie(w,"HH:mm:ss").format("h:mm A"):"--";return{...n,workingDays:x.length>0?x.join(", "):"--",formattedTime:n.startTime&&n.endTime?`${j(n.startTime)} - ${j(n.endTime)}`:"--",delayTime:n.delayTimeAllowed?`${n.delayTimeAllowed} min`:"--",ShiftID:n.id,ShiftName:n.name,CheckInTime:n.startTime,CheckOutTime:n.endTime,BreakDuration:n.breakMinutes,DelayTimeAllowed:n.delayTimeAllowed,OvertimeAllow:n.overtimeAllow,OvertimeHours:n.overtimeHours,Status:n.isActive?"Active":"Inactive",CreatedDate:n.createdAt,Description:n.description,IsActive:n.isActive,Sunday:n.sunday,Monday:n.monday,Tuesday:n.tuesday,Wednesday:n.wednesday,Thursday:n.thursday,Friday:n.friday,Saturday:n.saturday}});Kt(i),Qt(t.total||0),await Le()}catch(t){L(i=>({...i,shifts:t instanceof Error?t.message:"Failed to fetch shifts"}))}finally{A(t=>({...t,shifts:!1}))}}},Le=async()=>{try{const i=((await C.shiftEmployees.list({pageSize:1e3})).data||[]).map(n=>({...n,ShiftEmployeesID:n.ShiftEmployeesID,ShiftID:n.ShiftID,EmployeeID:n.EmployeeID,EmployeeName:n.employees_FirstName&&n.employees_LastName?`${n.employees_FirstName} ${n.employees_LastName}`:void 0,EmployeeCode:n.employees_EmployeeCode,IsActive:n.IsActive!==!1,Notes:n.Notes}));Zt(i)}catch(t){console.error("Error fetching shift assignments:",t)}},ee=async()=>{if(l==="attendance"){A(t=>({...t,attendance:!0})),L(t=>({...t,attendance:null}));try{const t={page:ye-1,pageSize:G,field:"AttendanceDate",sort:"ASC",select_fields:"AttendanceID,EmployeeID,AttendanceDate,employees_FirstName,employees_LastName"};if(W){const j=parseInt(W,10);isNaN(j)?(t.search=W,t.searchFields="EmployeeID,employees_FirstName,employees_LastName"):t.exact_filters=JSON.stringify({EmployeeID:j})}if(T!=null&&T.from&&(T!=null&&T.to)){const j=new Date(T.to);j.setHours(23,59,59,999),t.advanced_filters=JSON.stringify([{column:"AttendanceDate",filter_type:"greater_equals",value:U(T.from,"yyyy-MM-dd")},{column:"AttendanceDate",filter_type:"less_equals",value:U(j,"yyyy-MM-dd HH:mm:ss.SSS")}])}const i=await C.timeattendance.list(t),x=((i==null?void 0:i.data)||[]).map(j=>({...j,EmployeeName:`${j.employees_FirstName||""} ${j.employees_LastName||""}`.trim(),AttendanceDate:ie(j.AttendanceDate).isValid()?ie(j.AttendanceDate).format("MMM D, YYYY h:mm A"):"N/A"}));ts(x),Ut((i==null?void 0:i.total)||0)}catch(t){L(i=>({...i,attendance:t instanceof Error?t.message:"Failed to fetch attendance data"}))}finally{A(t=>({...t,attendance:!1}))}}},Me=async()=>{A(t=>({...t,shiftBook:!0})),L(t=>({...t,shiftBook:null}));try{const t=T!=null&&T.from?U(T.from,"yyyy-MM-dd"):void 0,i=T!=null&&T.to?U(T.to,"yyyy-MM-dd"):void 0,n={page:Be-1,pageSize:G,field:"ShiftBookDate",sort:"ASC",select_fields:"ShiftBookID,EmployeeID,ShiftID,ShiftBookDate,CheckInTime,CheckOutTime,TotalHoursWorked,OvertimeHours,AbsentHours,DelayHours,LeaveHours,Status,Notes,employees_FirstName,employees_LastName"};if(t&&i&&(n.advanced_filters=JSON.stringify([{column:"ShiftBookDate",filter_type:"greater_equals",value:t},{column:"ShiftBookDate",filter_type:"less_equals",value:i}])),W){const j=parseInt(W,10);isNaN(j)?(n.search=W,n.searchFields="EmployeeID,employees_FirstName,employees_LastName"):n.exact_filters=JSON.stringify({EmployeeID:j})}const x=await C.shiftBook.list(n);if(x&&Array.isArray(x.data)){const j=x.data.map(w=>{var M;return{...w,key:((M=w.ShiftBookID)==null?void 0:M.toString())||`${w.EmployeeID}-${w.ShiftBookDate}`,EmployeeName:w.employees_FirstName?`${w.employees_FirstName} ${w.employees_LastName||""}`.trim():`Employee ${w.EmployeeID}`}});ot(j),ct(x.total!==void 0?x.total:x.data.length)}else ot([]),ct(0)}catch{L(i=>({...i,shiftBook:"Failed to load shift book records."}))}finally{A(t=>({...t,shiftBook:!1}))}},rs=async t=>{try{A(n=>({...n,shifts:!0}));const i=await C.shifts.create(t);return await ge(),a({title:"Success",description:"Shift created successfully"}),i}catch(i){throw a({title:"Error",description:"Failed to create shift",variant:"destructive"}),i}finally{A(i=>({...i,shifts:!1}))}},ls=async(t,i)=>{try{A(x=>({...x,shifts:!0}));const n=await C.shifts.update(t,i);return await ge(),a({title:"Success",description:"Shift updated successfully"}),n}catch(n){throw a({title:"Error",description:"Failed to update shift",variant:"destructive"}),n}finally{A(n=>({...n,shifts:!1}))}},ns=async t=>{try{g?await ls(g.ShiftID,t):await rs(t),h(!1),d(null)}catch(i){console.error("Error submitting shift:",i)}},is=t=>{d(t),h(!0)},os=async t=>{var n,x;const i=_e.filter(j=>j.ShiftID===parseInt(t)&&j.IsActive);if(i.length>0){a({title:"Cannot Delete Shift",description:`This shift has ${i.length} employee${i.length>1?"s":""} assigned. Please unassign all employees first.`,variant:"destructive"});return}if(window.confirm("Are you sure you want to delete this shift?"))try{A(j=>({...j,shifts:!0})),await C.shifts.delete(t),a({title:"Success",description:"Shift deleted successfully"}),await ge()}catch(j){const w=((x=(n=j==null?void 0:j.response)==null?void 0:n.data)==null?void 0:x.detail)||(j==null?void 0:j.message)||"Failed to delete shift";a({title:"Error",description:w,variant:"destructive"})}finally{A(j=>({...j,shifts:!1}))}},Ne=async(t=0,i="",n=!1)=>{try{t===0||n?b(!0):at(!0);const x={page:t,pageSize:10,select_fields:"EmployeeID,FirstName,LastName,EmployeeCode,Email",sort:"FirstName",sortOrder:"asc"};i&&(x.search=i,x.searchFields="FirstName,LastName,EmployeeCode,Email");const w=(await C.employees.list(x)).data||[];n||t===0?(re(w),xe(0)):re(M=>[...M,...w]),Te(w.length===10)}catch{a({title:"Error",description:"Failed to load employees for assignment",variant:"destructive"})}finally{b(!1),at(!1)}},cs=t=>{S(t),y(!0),p(""),B(""),D(""),xe(0),Te(!0),Ne(0,"",!0)},ds=async()=>{if(!(!m||!f))try{await C.shiftEmployees.create({EmployeeID:parseInt(m),ShiftID:f.ShiftID,Notes:null}),a({title:"Success",description:"Employee assigned to shift successfully"}),y(!1),S(null),p(""),B(""),D(""),await Le()}catch{a({title:"Error",description:"Failed to assign employee to shift",variant:"destructive"})}},ms=async(t,i)=>{if(window.confirm("Are you sure you want to unassign this employee from the shift?"))try{const n=_e.find(x=>x.ShiftID===t&&x.EmployeeID===i);n&&(await C.shiftEmployees.delete(n.ShiftEmployeesID),a({title:"Success",description:"Employee unassigned from shift successfully"}),await Le())}catch{a({title:"Error",description:"Failed to unassign employee from shift",variant:"destructive"})}},hs=()=>{if(!Ee&&Ae){const t=Ft+1;xe(t),Ne(t,K,!1)}},us=t=>{D(t),xe(0),Te(!0),Ne(0,t,!0)},xs=t=>{var n;const i=(n=t.target.files)==null?void 0:n[0];i&&(Ie(i),fs(i))},fs=t=>{const i=new FileReader;i.onload=n=>{var x,j;try{const M=((x=n.target)==null?void 0:x.result).split(`
`).filter(X=>X.trim()),Q=((j=M[0])!=null&&j.includes("EmployeeID")?M.slice(1):M).map((X,be)=>{const $=X.split(",").map(He=>He.trim());return{id:be+1,EmployeeID:$[0]||"",AttendanceDate:$[1]||"",CheckInTime:$[2]||"",CheckOutTime:$[3]||"",Status:$[4]||"Present",Notes:$[5]||"",valid:$[0]&&$[1]}}).filter(X=>X.valid);Oe(Q.slice(0,10)),Fe(!0)}catch{a({title:"Parse Error",description:"Failed to parse the uploaded file",variant:"destructive"})}},i.readAsText(t)},ps=async()=>{if(J.length===0){a({title:"No Data",description:"No valid records to import",variant:"destructive"});return}nt(!0);try{const t=J.map(i=>({EmployeeID:i.EmployeeID,AttendanceDate:i.AttendanceDate,CheckInTime:i.CheckInTime,CheckOutTime:i.CheckOutTime,Status:i.Status,Notes:i.Notes}));await C.directBulkAdd.timeAttendanceBook(t),a({title:"Import Successful",description:`Successfully imported ${t.length} attendance records`}),pe(!1),Ie(null),Oe([]),Fe(!1),l==="attendance"?await ee():l==="shiftbook"&&await Me()}catch{a({title:"Import Failed",description:"Failed to import attendance records",variant:"destructive"})}finally{nt(!1)}},mt=()=>{const t=`EmployeeID,AttendanceDate,CheckInTime,CheckOutTime,Status,Notes
123,2024-01-15,09:00,17:00,Present,
456,2024-01-15,08:30,16:45,Present,
789,2024-01-15,09:15,17:30,Late,`,i=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(i),x=document.createElement("a");x.href=n,x.download="attendance_import_template.csv",document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(n)},ys=t=>{const i=t.target,{scrollTop:n,scrollHeight:x,clientHeight:j}=i;x-n<=j+100&&Ae&&!Ee&&hs()},js=async t=>{try{const i=await C.timeattendance.list({rowID:t.AttendanceID,pageSize:1});if(i.data&&i.data.length>0){const n=i.data[0];Z({AttendanceID:n.AttendanceID,EmployeeID:n.EmployeeID,EmployeeName:n.employees_FirstName+" "+n.employees_LastName,AttendanceDate:n.AttendanceDate,originalDate:n.AttendanceDate}),fe(!0)}}catch{L(n=>({...n,attendance:"Failed to load attendance record for editing."}))}},vs=async t=>{try{A(i=>({...i,attendance:!0})),E&&E.AttendanceID&&await C.timeattendance.update(E.AttendanceID,{AttendanceDate:t.AttendanceDate}),await ee(),fe(!1),Z(null)}catch{L(n=>({...n,attendance:"Failed to update attendance date."}))}finally{A(i=>({...i,attendance:!1}))}},gs=async t=>{if(window.confirm("Are you sure you want to delete this attendance record?"))try{A(i=>({...i,attendance:!0})),await C.timeattendance.delete(t),await ee()}catch{L(n=>({...n,attendance:"Failed to delete attendance record."}))}finally{A(i=>({...i,attendance:!1}))}},Ns=async t=>{Z(t),Bt(!0)},bs=async t=>{if(window.confirm("Are you sure you want to delete this shift book record?"))try{A(i=>({...i,shiftBook:!0})),await C.shiftBook.delete(t),await Me()}catch{L(n=>({...n,shiftBook:"Failed to delete shift book record."}))}finally{A(i=>({...i,shiftBook:!1}))}},ws=t=>{switch(t==null?void 0:t.toLowerCase()){case"present":return"default";case"absent":return"destructive";case"late":return"secondary";case"on leave":return"outline";default:return"outline"}};return o.useEffect(()=>{(async()=>{switch(l){case"dashboard":await dt();break;case"shifts":await ge();break;case"attendance":await ee();break;case"shiftBook":await Me();break}})()},[l,ye,Pe,Be,T]),o.useEffect(()=>{l==="dashboard"?dt():l==="attendance"&&ee()},[]),o.useEffect(()=>{const t=setTimeout(()=>{l==="attendance"&&ee()},500);return()=>clearTimeout(t)},[W,ye]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"container mx-auto max-w-7xl px-4 space-y-6",children:[e.jsxs(At,{value:l,onValueChange:t=>r(`/time_attendance/${t}`),className:"space-y-4",children:[e.jsxs(zs,{className:"md:grid md:grid-cols-5",children:[e.jsx(Y,{value:"dashboard",children:"Dashboard"}),e.jsx(Y,{value:"attendance",children:"TimeAttendance"}),e.jsx(Y,{value:"shiftBook",children:"ShiftBook"}),e.jsx(Y,{value:"shifts",children:"Shifts"}),e.jsx(Y,{value:"reports",children:"Reports"})]}),e.jsx(le,{value:"dashboard",className:"space-y-4",children:e.jsx(Fa,{dashboardMetrics:Yt,loading:je,error:ve})}),e.jsx(le,{value:"shifts",className:"space-y-4",children:e.jsx(Pa,{shiftsData:qt,shiftAssignments:_e,totalShifts:Jt,loading:je,error:ve,shiftsPage:Pe,setShiftsPage:zt,pageSize:G,expandedShift:Xt,setExpandedShift:Gt,setShowCreateShift:h,handleEditShift:is,handleAssignEmployee:cs,handleUnassignEmployee:ms,handleDeleteShift:os})}),e.jsxs(le,{value:"attendance",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Time Attendance Records"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{onClick:()=>Ce(!0),size:"sm",className:"gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Check In/Out"]}),e.jsxs(v,{onClick:mt,variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Nt,{className:"h-4 w-4"}),"Download Template"]}),e.jsxs(v,{onClick:()=>pe(!0),size:"sm",className:"gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Bulk Import"]})]})]}),e.jsx(_a,{attendanceData:es,loading:je,error:ve,dateRange:T,setDateRange:Ht,searchText:W,setSearchText:it,currentPage:ye,setCurrentPage:$t,pageSize:G,totalRows:Vt,handleEditAttendance:js,handleDeleteAttendance:gs})]}),e.jsx(le,{value:"shiftBook",className:"space-y-4",children:e.jsx(La,{shiftBookData:ss,totalShiftBookRecords:as,loading:je,error:ve,searchText:W,setSearchText:it,shiftBookPage:Be,setShiftBookPage:Wt,pageSize:G,handleEditShiftBook:Ns,handleDeleteShiftBook:bs,getStatusVariant:ws})}),e.jsx(le,{value:"reports",className:"space-y-4",children:e.jsx(Ca,{})})]}),e.jsx(oe,{open:Pt,onOpenChange:t=>{fe(t),t||Z(null)},children:e.jsxs(ce,{className:"sm:max-w-[500px]",children:[e.jsx(de,{children:e.jsx(me,{children:"Edit Attendance Date"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"employee",children:"Employee"}),e.jsx(P,{id:"employee",value:(E==null?void 0:E.EmployeeName)||"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"currentDate",children:"Current Date"}),e.jsx(P,{id:"currentDate",value:E!=null&&E.originalDate?U(new Date(E.originalDate),"MMM d, yyyy h:mm a"):"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"attendanceDate",children:"New Attendance Date & Time *"}),e.jsx(Ws,{value:E!=null&&E.AttendanceDate?ie(E.AttendanceDate):null,onChange:t=>Z(i=>({...i,AttendanceDate:t?t.format("YYYY-MM-DD HH:mm:ss"):null})),showTime:!0,placeholder:"Select new date and time",className:"w-full"})]})]}),e.jsxs(he,{children:[e.jsx(v,{variant:"outline",onClick:()=>{fe(!1),Z(null)},children:"Cancel"}),e.jsx(v,{onClick:()=>vs(E),disabled:!(E!=null&&E.AttendanceDate),children:"Update Date"})]})]})}),e.jsx(Oa,{open:c,onOpenChange:t=>{h(t),t||d(null)},onSubmit:ns,initialData:g}),e.jsx(oe,{open:N,onOpenChange:t=>{y(t),t||(S(null),p(""),B(""),D(""))},children:e.jsxs(ce,{className:"sm:max-w-[500px]",children:[e.jsx(de,{children:e.jsx(me,{children:"Assign Employee to Shift"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"shiftInfo",children:"Shift"}),e.jsx(P,{id:"shiftInfo",value:f?`${f.ShiftName} (${f.CheckInTime} - ${f.CheckOutTime})`:"",disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"employee",children:"Select Employee *"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{id:"employee",placeholder:"Search employees...",value:m?z:K,onChange:t=>us(t.target.value),onFocus:()=>{m&&(p(""),B(""),D(""),Ne(0,"",!0))},className:"mb-2"}),_.length>0&&K&&e.jsx("div",{className:"absolute z-50 w-full bg-white border rounded-md shadow-lg max-h-[300px] overflow-y-auto",onScroll:ys,children:u&&_.length===0?e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading employees..."}):_.length===0?e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No employees found"}):e.jsxs(e.Fragment,{children:[_.map(t=>e.jsxs("div",{onClick:()=>{p(t.EmployeeID.toString()),B(`${t.FirstName} ${t.LastName||""}`.trim()),D(""),re([])},className:`p-3 cursor-pointer hover:bg-muted transition-colors ${m===t.EmployeeID.toString()?"bg-muted":""}`,children:[e.jsx("div",{className:"font-medium text-sm",children:`${t.FirstName} ${t.LastName||""}`.trim()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.EmployeeCode})]},t.EmployeeID)),Ee&&e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Loading more employees..."}),!Ae&&_.length>0&&e.jsx("div",{className:"p-4 text-center text-muted-foreground text-sm",children:"All employees loaded"})]})})]})]})]}),e.jsxs(he,{children:[e.jsx(v,{variant:"outline",onClick:()=>{y(!1),S(null),p(""),D("")},children:"Cancel"}),e.jsx(v,{onClick:ds,disabled:!m||u,children:"Add Employee"})]})]})}),e.jsx(oe,{open:Lt,onOpenChange:t=>{pe(t),t||(Ie(null),Oe([]),Fe(!1))},children:e.jsxs(ce,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5"}),"Bulk Import Attendance Records"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Step 1: Download Template"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Download the CSV template file and fill it with your attendance data."}),e.jsxs(v,{onClick:mt,variant:"outline",className:"w-full gap-2",children:[e.jsx(Nt,{className:"h-4 w-4"}),"Download CSV Template"]})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Step 2: Upload File"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(k,{htmlFor:"file-upload",className:"text-sm font-medium",children:"Upload CSV File"}),e.jsx(P,{id:"file-upload",type:"file",accept:".csv",onChange:xs,className:"cursor-pointer"})]}),rt&&e.jsxs("p",{className:"text-sm text-green-600",children:["Selected: ",rt.name]})]})]}),Mt&&J.length>0&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Step 3: Preview Data"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first ",J.length," records"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border rounded-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Row"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"EmployeeID"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Date"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Check In"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Check Out"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Status"}),e.jsx("th",{className:"border p-2 text-left text-xs font-medium",children:"Notes"})]})}),e.jsx("tbody",{children:J.map((t,i)=>e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-2 text-sm",children:t.id}),e.jsx("td",{className:"border p-2 text-sm",children:t.EmployeeID}),e.jsx("td",{className:"border p-2 text-sm",children:t.AttendanceDate}),e.jsx("td",{className:"border p-2 text-sm",children:t.CheckInTime}),e.jsx("td",{className:"border p-2 text-sm",children:t.CheckOutTime}),e.jsx("td",{className:"border p-2 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.Status==="Present"?"bg-green-100 text-green-800":t.Status==="Late"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.Status})}),e.jsx("td",{className:"border p-2 text-sm",children:t.Notes})]},t.id))})]})})]})]}),e.jsxs(he,{className:"flex justify-between",children:[e.jsx(v,{variant:"outline",onClick:()=>pe(!1),children:"Cancel"}),e.jsx(v,{onClick:ps,disabled:lt||J.length===0,className:"gap-2",children:lt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-r-2 border-t-2 border-gray-300 border-t-transparent"}),"Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4"}),"Import ",J.length," Records"]})})]})]})}),e.jsx(oe,{open:_t,onOpenChange:Ce,children:e.jsxs(ce,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsxs(me,{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-5 w-5"}),"Check In / Check Out"]})}),e.jsx("div",{className:"py-4",children:e.jsx(Vs,{})}),e.jsx(he,{children:e.jsx(v,{variant:"outline",onClick:()=>Ce(!1),children:"Close"})})]})})]})})};export{gr as default};
